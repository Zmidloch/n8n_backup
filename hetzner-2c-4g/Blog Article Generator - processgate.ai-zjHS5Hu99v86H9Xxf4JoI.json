{
  "active": true,
  "activeVersion": {
    "updatedAt": "2026-01-19T10:27:12.098Z",
    "createdAt": "2026-01-19T10:27:09.449Z",
    "versionId": "0d1076e8-92c8-48ec-81da-06ce30427426",
    "workflowId": "zjHS5Hu99v86H9Xxf4JoI",
    "nodes": [
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          7536,
          4928
        ],
        "id": "108f1495-a0d7-426f-9858-df11dbafe282",
        "name": "Gemini Blog Fallback5",
        "credentials": {
          "googlePalmApi": {
            "id": "O18dqBggPBVuy0CJ",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          6992,
          4912
        ],
        "id": "f0aba60c-e0bd-4139-8e4f-d1695190d3ca",
        "name": "Gemini Blog Fallback4",
        "credentials": {
          "googlePalmApi": {
            "id": "O18dqBggPBVuy0CJ",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          6448,
          4912
        ],
        "id": "92c43091-f14d-483a-a1bd-59d463e89d65",
        "name": "Gemini Blog Fallback3",
        "credentials": {
          "googlePalmApi": {
            "id": "O18dqBggPBVuy0CJ",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "resource": "draft",
          "subject": "={{ $json.subject }}",
          "emailType": "html",
          "message": "=<h2>{{ $json.postTitle }}</h2><p><strong>Perex:</strong> {{ $json.postExcerpt }}</p><hr><p><a href=\"{{ $json.adminUrl }}\">Otevřít článek</a></p>",
          "options": {
            "sendTo": "jirka@processgate.ai"
          }
        },
        "type": "n8n-nodes-base.gmail",
        "typeVersion": 2.1,
        "position": [
          6560,
          5504
        ],
        "id": "55eb412f-a9d4-4482-b8db-604b7e626e93",
        "name": "Send Email Notification1",
        "webhookId": "fee5264b-bf20-4929-b199-5aa023beda88",
        "credentials": {
          "gmailOAuth2": {
            "id": "qNSaYVEcaWOf5U3k",
            "name": "Gmail zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const postData = $('Create WordPress Post1').item.json;\nconst finalData = $('Prepare Final Data1').item.json;\nconst adminUrl = `https://processgate.ai/wp-admin/post.php?post=${postData.id}&action=edit`;\n\nreturn {\n  json: {\n    subject: `${finalData.verified ? '✅' : '⚠️'} Nový článek k review: ${finalData.title}`,\n    postTitle: finalData.title,\n    postExcerpt: finalData.excerpt,\n    adminUrl: adminUrl,\n    categories: finalData.categories.join(', '),\n    tags: finalData.tags.join(', '),\n    source: finalData.source === 'automatic' ? 'Automaticky vygenerováno' : 'Manuálně zadáno',\n    actualLength: finalData.content.length,\n    verified: finalData.verified,\n    verificationNotes: finalData.verificationNotes\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          6352,
          5504
        ],
        "id": "ffd1c5e1-372a-47e9-8a8c-49cc5be9ac88",
        "name": "Prepare Email Data1"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "=https://processgate.ai/wp-json/wp/v2/posts/{{ $('Process Image Response1').item.json.postId }}",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={ \"featured_media\": {{ $json.id }} }",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          6352,
          5664
        ],
        "id": "aa82d198-0e52-4638-b16e-e10ae7cbe575",
        "name": "Set Featured Image1",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://processgate.ai/wp-json/wp/v2/media",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Disposition",
                "value": "=attachment; filename=\"{{ $json.filename }}\""
              },
              {
                "name": "Content-Type",
                "value": "image/png"
              }
            ]
          },
          "sendBody": true,
          "contentType": "raw",
          "body": "={{ Buffer.from($json.imageBase64, 'base64') }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          6160,
          5664
        ],
        "id": "f938e70e-0639-44e6-90f2-b4724fcd01d2",
        "name": "Upload to WordPress Media1",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const response = $input.item.json;\nlet imageBase64 = '';\nif (response.predictions && response.predictions[0]) {\n  imageBase64 = response.predictions[0].bytesBase64Encoded;\n}\n\nreturn {\n  json: {\n    postId: $('Create WordPress Post1').item.json.id,\n    imageBase64: imageBase64,\n    filename: `${$('Prepare Final Data1').item.json.slug}-featured.png`\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          5952,
          5664
        ],
        "id": "30596116-5408-442f-ba9b-2a50142f0a0b",
        "name": "Process Image Response1"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googlePalmApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"instances\": [\n    { \"prompt\": \"{{ $('Prepare Final Data1').item.json.imageQuery }}, professional, modern tech style, no text, 16:9\" }\n  ],\n  \"parameters\": { \"sampleCount\": 1, \"aspectRatio\": \"16:9\" }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          5760,
          5664
        ],
        "id": "1d2659fb-1fdd-4883-bd04-ff1ccacbd859",
        "name": "Generate Image (Imagen)1",
        "credentials": {
          "googlePalmApi": {
            "id": "O18dqBggPBVuy0CJ",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "=https://processgate.ai/wp-json/wp/v2/posts/{{ $json.postId }}",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"categories\": {{ JSON.stringify($json.categoryIds) }},\n  \"tags\": {{ JSON.stringify($json.tagIds) }}\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          6160,
          5344
        ],
        "id": "87f45cf3-798c-445f-827b-96f05eed1934",
        "name": "Assign Categories & Tags1",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Get all items from HTTP Request nodes (they return arrays)\nconst wpCategoriesData = $('Get WP Categories1').all();\nconst wpTagsData = $('Get WP Tags1').all();\nconst aiCategories = $('Prepare Final Data1').item.json.categories || [];\nconst aiTags = $('Prepare Final Data1').item.json.tags || [];\nconst postId = $('Create WordPress Post1').item.json.id;\n\n// Flatten the arrays - each item.json is one category/tag object\nconst wpCategories = wpCategoriesData.map(item => item.json);\nconst wpTags = wpTagsData.map(item => item.json);\n\n// Map AI categories to WordPress IDs\nconst categoryIds = [];\nfor (const aiCat of aiCategories) {\n  if (!aiCat) continue;\n  const match = wpCategories.find(wpCat =>\n    wpCat.name && (\n      wpCat.name.toLowerCase() === aiCat.toLowerCase() ||\n      wpCat.name.toLowerCase().includes(aiCat.toLowerCase()) ||\n      aiCat.toLowerCase().includes(wpCat.name.toLowerCase())\n    )\n  );\n  if (match) {\n    categoryIds.push(match.id);\n  }\n}\n\n// Default category if no match found\nif (categoryIds.length === 0) {\n  categoryIds.push(176); // Umělá inteligence as default\n}\n\n// Map AI tags to WordPress IDs\nconst tagIds = [];\nfor (const aiTag of aiTags) {\n  if (!aiTag) continue;\n  const match = wpTags.find(wpTag =>\n    wpTag.name && (\n      wpTag.name.toLowerCase() === aiTag.toLowerCase() ||\n      wpTag.name.toLowerCase().includes(aiTag.toLowerCase()) ||\n      aiTag.toLowerCase().includes(wpTag.name.toLowerCase())\n    )\n  );\n  if (match) {\n    tagIds.push(match.id);\n  }\n}\n\nreturn {\n  json: {\n    postId: postId,\n    categoryIds: categoryIds,\n    tagIds: tagIds\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          5952,
          5344
        ],
        "id": "e41a9513-cc6b-47b4-8b52-319ac198d273",
        "name": "Map Categories1"
      },
      {
        "parameters": {
          "url": "https://processgate.ai/wp-json/wp/v2/categories",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "per_page",
                "value": "100"
              },
              {
                "name": "lang",
                "value": "cs"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          5760,
          5344
        ],
        "id": "8f05b806-d153-462d-9a78-894ae94984f1",
        "name": "Get WP Categories1",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "title": "={{ $json.title }}",
          "additionalFields": {
            "content": "={{ $json.content }}",
            "slug": "={{ $json.slug }}",
            "status": "draft"
          }
        },
        "type": "n8n-nodes-base.wordpress",
        "typeVersion": 1,
        "position": [
          5584,
          5504
        ],
        "id": "c881c58e-e4b8-4843-b86a-420826cd19c5",
        "name": "Create WordPress Post1",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const blogData = $('BlogDraft1').item.json.output;\nconst verifyData = $json.output;\nconst keywordData = $('KeywordStrategy1').item.json.output;\nconst mergeData = $('Aggregate Research Data1').item.json;\n\nconst finalContent = verifyData.correctedContent || blogData.content;\n\nreturn {\n  json: {\n    title: blogData.title,\n    content: finalContent,\n    excerpt: blogData.excerpt,\n    slug: blogData.slug,\n    imageQuery: blogData.imageQuery,\n    categories: keywordData.categories,\n    tags: keywordData.tags,\n    keywords: keywordData.keywords,\n    source: mergeData.source,\n    targetLength: mergeData.targetLength,\n    verified: verifyData.verified,\n    verificationIssues: verifyData.issues,\n    verificationNotes: verifyData.verificationNotes\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          5392,
          5504
        ],
        "id": "62de503d-2685-46f7-85d3-5ea405afac34",
        "name": "Prepare Final Data1"
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"verified\", \"issues\", \"correctedContent\"],\n  \"properties\": {\n    \"verified\": { \"type\": \"boolean\", \"description\": \"True pokud článek prošel verifikací\" },\n    \"issues\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"Seznam nalezených problémů\" },\n    \"correctedContent\": { \"type\": \"string\", \"description\": \"Opravený HTML obsah článku\" },\n    \"verificationNotes\": { \"type\": \"string\", \"description\": \"Poznámky k verifikaci\" }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          7680,
          4928
        ],
        "id": "b2377856-6fa9-4819-bf61-c8d83aa32147",
        "name": "Verify Parser1"
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          7392,
          4928
        ],
        "id": "f322e814-7a2e-424b-aa75-4e694fe7a922",
        "name": "OpenRouter (Verify)1",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=# VERIFIKACE ČLÁNKU\n\nZkontroluj následující článek a jeho faktická tvrzení.\n\n## ČLÁNEK:\n**Název:** {{ $json.output.title }}\n\n**Obsah:**\n{{ $json.output.content }}\n\n## FAKTICKÁ TVRZENÍ K OVĚŘENÍ:\n{{ $json.output.factualClaims.map((c, i) => `${i+1}. ${c}`).join('\\n') }}\n\n## DOSTUPNÉ ZDROJE PRO OVĚŘENÍ:\n\n### Tavily Research:\n{{ $('Aggregate Research Data1').item.json.tavilyResearch.map(r => `- ${r.title}: ${r.content}`).join('\\n') }}\n\n### Wikipedia Data:\n{{ $('Aggregate Research Data1').item.json.wikipediaData.map(w => `- ${w.title}: ${w.summary}`).join('\\n') }}\n\n## ÚKOL:\n\n1. Zkontroluj každé faktické tvrzení proti dostupným zdrojům\n2. Označ problematická tvrzení, která nelze ověřit\n3. Navrhni konkrétní opravy pro neověřitelná tvrzení\n\nVrať JSON s výsledkem verifikace.",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "Jsi přísný fact-checker pro technologický blog. Tvým úkolem je identifikovat potenciální halucinace AI a neověřitelná tvrzení."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          7488,
          4640
        ],
        "id": "9a0fbe0b-6474-43bd-946a-29184d282006",
        "name": "Verification Agent1"
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"title\", \"content\", \"excerpt\", \"slug\", \"imageQuery\", \"factualClaims\"],\n  \"properties\": {\n    \"title\": { \"type\": \"string\", \"description\": \"Název článku\" },\n    \"content\": { \"type\": \"string\", \"description\": \"HTML obsah článku\" },\n    \"excerpt\": { \"type\": \"string\", \"description\": \"Krátký perex pro SEO\" },\n    \"slug\": { \"type\": \"string\", \"description\": \"URL slug\" },\n    \"imageQuery\": { \"type\": \"string\", \"description\": \"Popis pro generování obrázku\" },\n    \"factualClaims\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"Klíčová faktická tvrzení k verifikaci\" }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          7136,
          4912
        ],
        "id": "6ecfd286-6bda-4fe1-89be-bf2052f9d9e6",
        "name": "Blog Parser1"
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          6832,
          4928
        ],
        "id": "cfdeb185-6826-4399-92d2-2fd737c1aa48",
        "name": "OpenRouter (Blog)1",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=# ZADÁNÍ ČLÁNKU (DATA)\n\nTéma (název článku): {{ $('Aggregate Research Data1').item.json.topic }}\nÚhel pohledu: {{ $('Aggregate Research Data1').item.json.angle }}\nCílová délka: {{ $('Aggregate Research Data1').item.json.targetLength }} znaků\nSEO klíčová slova: {{ $json.output.keywords.join(', ') }}\n\n# RESEARCH DATA (Tavily)\nPoužívej pouze informace z níže uvedených zdrojů.\n\n{{ $('Aggregate Research Data1').item.json.tavilyResearch.map(r => `SOURCE_TITLE: ${r.title}\\nSOURCE_URL: ${r.url}\\nSOURCE_CONTENT:\\n${r.content}\\nEND_SOURCE`).join('\\n\\n') }}\n\n# OVĚŘENÉ FAKTY (Wikipedia)\nNíže uvedené informace jsou ověřené a můžeš je použít jako základ pro faktická tvrzení.\n\n{{ $('Aggregate Research Data1').item.json.wikipediaData.map(w => `WIKI_TITLE: ${w.title}\\nWIKI_URL: ${w.url}\\nWIKI_SUMMARY:\\n${w.summary}\\nEND_WIKI`).join('\\n\\n') }}\n\n# INSTRUKCE PRO ČLÁNEK\n\nNapiš blogový článek v češtině pro processgate.ai (AI + automatizace pro malé a střední firmy).\nPiš prakticky, srozumitelně, bez přehnaných slibů.\n\n## Faktická správnost (kritické)\n- Používej POUZE informace z poskytnutých zdrojů (Tavily + Wikipedia výše).\n- Jakékoli číslo / statistika / konkrétní tvrzení musí být opřené o uvedené zdroje.\n- Pokud nemáš pro tvrzení oporu ve zdrojích, VŮBEC ho neuváděj.\n- Nezmiňuj „Tavily“, „Wikipedia API“ ani interní nástroje. Zdroje cituj přirozeně jako odkazy v textu.\n\n## Struktura a styl\n- Délka: snaž se držet přibližně cílové délky, ale priorita je kvalita a faktická správnost.\n- Obsah vrať jako HTML a používej pouze tyto tagy: <p>, <h2>, <ul>, <li>, <strong>, <a>.\n- Přidej 3–5 sekcí <h2>, ideálně s praktickými doporučeními (checklisty / kroky).\n- U odkazů použij <a href=\"URL\">krátký popis</a> a ber URL výhradně z poskytnutých zdrojů (SOURCE_URL, WIKI_URL).\n\n## Slug a excerpt\n- excerpt: 1–2 věty, max 160 znaků, bez uvozovek, bez HTML.\n- slug: pouze malá písmena a pomlčky, bez diakritiky, bez speciálních znaků.\n\n## Featured image prompt\n- imageQuery: anglicky, modern tech/AI styl, bez textu v obrázku, bez log, bez značek.\n\n# VÝSTUP (KRITICKÉ – MUSÍŠ DODRŽET)\n\nVrať POUZE jeden validní JSON objekt.\n- ŽÁDNÝ markdown\n- ŽÁDNÉ ```json\n- ŽÁDNÉ vysvětlení\n- ŽÁDNÝ text před nebo po JSON\n- Výstup musí začínat znakem { a končit znakem }\n\nJSON musí mít přesně tato pole a typy:\n{\n  \"title\": \"string\",\n  \"content\": \"string\",\n  \"excerpt\": \"string\",\n  \"slug\": \"string\",\n  \"imageQuery\": \"string\",\n  \"factualClaims\": [\"string\", \"string\"]\n}\n\nPravidla pro factualClaims:\n- Uveď 5–10 krátkých faktických tvrzení, která jsou v článku.\n- Každé tvrzení musí být ověřitelné z poskytnutých zdrojů.\n- Pokud nelze najít 5 ověřitelných tvrzení, vrať méně (klidně i prázdné pole []).\n",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "Jsi zkušený český technologický novinář a copywriter specializující se na AI, automatizaci a digitální transformaci pro malé a střední firmy."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          6944,
          4640
        ],
        "id": "53bd53d9-0328-4ce7-b9f0-ea04629beacc",
        "name": "BlogDraft1"
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"keywords\", \"categories\", \"tags\"],\n  \"properties\": {\n    \"keywords\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"SEO klíčová slova v češtině\" },\n    \"categories\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"WordPress kategorie\" },\n    \"tags\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"WordPress tagy\" }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          6576,
          4912
        ],
        "id": "a04cd35d-2e5d-409a-9eaa-8ea7e7201166",
        "name": "Keywords Parser1"
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          6272,
          4912
        ],
        "id": "e73ec6ee-7b7c-4fe5-b3e4-11b2470c2c89",
        "name": "OpenRouter (Keywords)1",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "Jsi SEO specialista pro české tech blogy. Tvůj úkol je vrátit přesně strukturovaný JSON.\n\nVSTUP:\nTéma článku: {{ $json.topic }}\nÚhel pohledu: {{ $json.angle }}\nVstupní klíčová slova: {{ $json.keywords.join(', ') }}\n\nTAVILY (souhrn):\n{{ $json.tavilyResearch.map(r => `SOURCE_TITLE: ${r.title}\\nSOURCE_SNIPPET: ${r.content}`).join('\\n\\n') }}\n\nWIKIPEDIA (ověřené fakty):\n{{ $json.wikipediaData.map(w => `WIKI_TITLE: ${w.title}\\nWIKI_SUMMARY: ${w.summary}`).join('\\n\\n') }}\n\nÚKOL:\n1) Vytvoř 5–8 SEO klíčových slov v češtině (relevantní pro téma). Každé jako samostatný string.\n2) Vyber 1–3 kategorie POUZE z tohoto seznamu (přesně):\n   - Automatizace\n   - Média\n   - n8n\n   - Produktivita\n   - Umělá inteligence\n3) Vyber 3–5 tagů POUZE z tohoto seznamu (přesně, bez úprav):\n   - Adobe\n   - AI\n   - Airtable\n   - Anthropic\n   - Apify\n   - automatizace\n   - avatar\n   - Baserow\n   - ChatGPT\n   - Claude\n   - Elestio\n   - Fal.ai\n   - Gemini\n   - Google\n   - GPT Image\n   - Grok\n   - HeyGen\n   - Kling\n   - Leonardo\n   - MAKE\n   - media\n   - Midjourney\n   - n8n\n   - Nano Banana\n   - NotebookLM\n   - Perplexity\n   - Polylang\n   - Sora\n   - Supabase\n   - Tabidoo\n   - Veo\n   - video\n   - Wordpress\n\nPRAVIDLA (KRITICKÉ):\n- NIKDY nevymýšlej nové kategorie ani tagy. Použij pouze položky ze seznamu výše.\n- categories musí být pole stringů, tags musí být pole stringů, keywords musí být pole stringů.\n- Vrať vždy všechna 3 pole: keywords, categories, tags (i kdyby některé bylo prázdné pole []).\n- ŽÁDNÝ markdown, ŽÁDNÉ vysvětlení, ŽÁDNÝ text navíc.\n- Výstup musí začínat znakem { a končit znakem }.\n\nVÝSTUP: Vrať POUZE validní JSON objekt přesně ve tvaru:\n{\"keywords\":[\"...\"],\"categories\":[\"...\"],\"tags\":[\"...\"]}\n",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "Jsi SEO specialista pro české tech blogy. Vytváříš klíčová slova a taxonomie v češtině. NIKDY nevymýšlej nové kategorie nebo tagy - použij POUZE ty ze zadaného seznamu. Odpovídej POUZE validním JSON objektem."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          6384,
          4656
        ],
        "id": "4501b438-23bb-4f3d-81af-0c15a0a331ef",
        "name": "KeywordStrategy1"
      },
      {
        "parameters": {
          "jsCode": "// Agregace Wikipedia dat\nconst allItems = $input.all();\nconst firstItem = $('Prepare Wiki Terms1').first();\nconst mergeData = firstItem.json.mergeData;\nconst tavilyResults = firstItem.json.tavilyResults;\n\nconst wikiData = allItems\n  .filter(item => item.json.extract)\n  .map(item => ({\n    title: item.json.title,\n    summary: item.json.extract,\n    url: item.json.content_urls?.desktop?.page || ''\n  }));\n\nreturn {\n  json: {\n    ...mergeData,\n    tavilyResearch: tavilyResults,\n    wikipediaData: wikiData\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          6128,
          4656
        ],
        "id": "48ecd0ac-4ec3-4312-a0d6-d3b60ec708ed",
        "name": "Aggregate Research Data1"
      },
      {
        "parameters": {
          "url": "=https://en.wikipedia.org/api/rest_v1/page/summary/{{ encodeURIComponent($json.term) }}",
          "options": {
            "response": {
              "response": {
                "neverError": true
              }
            }
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          6032,
          4928
        ],
        "id": "fd9c4702-866b-49df-850c-9492f5b8d06e",
        "name": "Wikipedia Lookup1"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          5824,
          4752
        ],
        "id": "f31b6186-2a48-404d-b76b-4de81bd04c5c",
        "name": "Split Wikipedia Terms1"
      },
      {
        "parameters": {
          "jsCode": "// 1. Zjistíme, která větev běžela, abychom věděli, odkud brát wikipediaTerms\nlet mergeData;\n\ntry {\n  // Zkusíme vzít data z automatické větve\n  mergeData = $('Prepare for Merge (A)').item.json;\n} catch (e) {\n  try {\n    // Pokud větev A neběžela, zkusíme manuální větev B\n    mergeData = $('Prepare for Merge (B)').item.json;\n  } catch (e2) {\n    // Fallback, pokud by náhodou neběžela ani jedna (např. při špatném testování)\n    mergeData = { wikipediaTerms: [] };\n  }\n}\n\n// 2. Výsledky z Tavily (přímý vstup tohoto uzlu)\nconst tavilyData = $input.item.json;\n\n// 3. Vytáhneme termíny\nconst terms = mergeData.wikipediaTerms || [];\n\n// 4. Pokud nejsou žádné termíny, vytvoříme jednu položku s tématem, aby se research nezastavil\nif (terms.length === 0) {\n  return [{\n    json: {\n      term: mergeData.topic || \"AI Automation\",\n      mergeData: mergeData,\n      tavilyResults: tavilyData.results || []\n    }\n  }];\n}\n\n// 5. Rozmnožíme pro uzel \"Split In Batches\"\nreturn terms.map(term => ({\n  json: {\n    term: term,\n    mergeData: mergeData,\n    tavilyResults: tavilyData.results || []\n  }\n}));"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          5600,
          4752
        ],
        "id": "fb1a1275-1851-46ea-b3d2-7e587e1f5c3f",
        "name": "Prepare Wiki Terms1"
      },
      {
        "parameters": {
          "query": "={{ $json.searchQuery || $json.topic }}",
          "options": {
            "max_results": 5,
            "include_raw_content": true
          }
        },
        "type": "@tavily/n8n-nodes-tavily.tavily",
        "typeVersion": 1,
        "position": [
          5440,
          4752
        ],
        "id": "5d90bc68-6766-4d7b-9233-99e4a0bdea6b",
        "name": "Deep Research (Tavily)1",
        "credentials": {
          "tavilyApi": {
            "id": "KmiWEKpArgJSNmSk",
            "name": "Tavily account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Připravit data pro merge z manuální větve\nconst processedData = $('Process Form Data1').item.json;\nconst researchData = $input.item.json;\n\nreturn {\n  json: {\n    ...processedData,\n    initialResearch: researchData.results\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4352,
          5216
        ],
        "id": "64bc3f12-5be0-4b91-a06a-ce0d8af695fc",
        "name": "Prepare for Merge (B)1"
      },
      {
        "parameters": {
          "query": "={{ $json.topic }}",
          "options": {
            "max_results": 5,
            "time_range": "month",
            "include_raw_content": true
          }
        },
        "type": "@tavily/n8n-nodes-tavily.tavily",
        "typeVersion": 1,
        "position": [
          4144,
          5216
        ],
        "id": "be227125-9e3d-4388-a07a-dc17b41d6496",
        "name": "Research Manual Topic1",
        "credentials": {
          "tavilyApi": {
            "id": "KmiWEKpArgJSNmSk",
            "name": "Tavily account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Extrakce dat z formuláře a příprava pro research\nconst formData = $input.item.json;\n\n// Extrakce klíčových slov pro Wikipedia lookup\nconst keywords = formData['Klíčová slova'].split(',').map(k => k.trim());\n\n// Vytvoření Wikipedia termínů z klíčových slov (anglické verze)\nconst translations = {\n  'automatizace': 'automation',\n  'umělá inteligence': 'artificial intelligence',\n  'AI': 'artificial intelligence',\n  'produktivita': 'productivity',\n  'workflow': 'workflow',\n  'n8n': 'n8n',\n  'integrace': 'system integration',\n  'API': 'API',\n  'onboarding': 'onboarding',\n  'HR': 'human resources'\n};\n\nconst wikipediaTerms = keywords.slice(0, 3).map(k => {\n  return translations[k.toLowerCase()] || k;\n});\n\nreturn {\n  json: {\n    source: 'manual',\n    topic: formData['Název článku'],\n    angle: 'Zadáno uživatelem přes formulář',\n    searchQuery: formData['Název článku'],\n    wikipediaTerms: wikipediaTerms,\n    keywords: keywords,\n    targetLength: formData['Délka článku (znaky)'] || 4500\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3952,
          5216
        ],
        "id": "b4d2b01f-b70c-4b9e-9469-df250dc7575e",
        "name": "Process Form Data1"
      },
      {
        "parameters": {
          "formTitle": "Nový blogový článek",
          "formDescription": "Zadejte informace pro vygenerování článku na processgate.ai",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Název článku",
                "placeholder": "např. Využití n8n a Airtable při onboardingu zaměstnanců",
                "requiredField": true
              },
              {
                "fieldLabel": "Klíčová slova",
                "placeholder": "n8n, Airtable, onboarding, HR automatizace",
                "requiredField": true
              },
              {
                "fieldLabel": "Délka článku (znaky)",
                "fieldType": "number",
                "placeholder": "4500"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.formTrigger",
        "typeVersion": 2.2,
        "position": [
          3744,
          5216
        ],
        "id": "d01055e3-90c1-4d77-af26-7dc18d01ac2b",
        "name": "Formulář pro nový článek1",
        "webhookId": "2ac1416a-10ce-41de-9d47-2e38ffe569bd"
      },
      {
        "parameters": {
          "jsCode": "// Připravit data pro merge z automatické větve\nconst topicData = $('TopicIdeation1').item.json.output;\nconst originalData = $('Set Topics & Keywords1').item.json;\n\nreturn {\n  json: {\n    source: 'automatic',\n    topic: topicData.title,\n    angle: topicData.angle,\n    searchQuery: topicData.searchQuery,\n    wikipediaTerms: topicData.wikipediaTerms || [],\n    keywords: (originalData.keywords || \"\").split(', '),\n    targetLength: originalData.targetLength\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4688,
          4656
        ],
        "id": "ec5a3758-faf9-4ba0-8233-d497d0f0c72a",
        "name": "Prepare for Merge (A)1"
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"title\", \"angle\", \"searchQuery\", \"wikipediaTerms\"],\n  \"properties\": {\n    \"title\": { \"type\": \"string\", \"description\": \"Český název článku\" },\n    \"angle\": { \"type\": \"string\", \"description\": \"Úhel pohledu článku\" },\n    \"searchQuery\": { \"type\": \"string\", \"description\": \"Anglický vyhledávací dotaz\" },\n    \"wikipediaTerms\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"Termíny pro Wikipedia lookup\" }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          4544,
          4864
        ],
        "id": "22d3f67c-f098-4e98-bc5c-352eede5ed11",
        "name": "Topic Parser1"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          4320,
          4864
        ],
        "id": "8449c0bf-98c3-4bca-abd2-13b060bf41b0",
        "name": "Gemini Fallback1",
        "credentials": {
          "googlePalmApi": {
            "id": "O18dqBggPBVuy0CJ",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          4192,
          4864
        ],
        "id": "7053e957-d629-4f5f-a614-ac748898cc75",
        "name": "OpenRouter (Claude)1",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Zde jsou aktuální novinky z oblasti AI a automatizace:\n\n{{ $json.results.map((r, i) => `${i+1}. ${r.title}\\n   ${r.content}\\n   Zdroj: ${r.url}`).join('\\n\\n') }}\n\nNa základě těchto novinek vyber JEDNO téma, které bude nejzajímavější pro české publikum zaměřené na malé a střední firmy. Téma by mělo být praktické a aktuální.\n\nVrať JSON s těmito poli:\n- title: český název článku (jasný, konkrétní, bez clickbaitu)\n- angle: úhel pohledu / hlavní myšlenka článku\n- searchQuery: anglický vyhledávací dotaz pro další research\n- wikipediaTerms: pole 2-3 anglických termínů pro vyhledání na Wikipedii (pro ověření faktů)",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "Jsi expert na obsahovou strategii pro tech blogy. Vybíráš témata, která jsou relevantní pro české podnikatele a manažery zajímající se o AI a automatizaci. Odpovídej POUZE validním JSON objektem."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          4352,
          4656
        ],
        "id": "d1e0e7c7-fdf5-444e-8e26-68c1908a80a1",
        "name": "TopicIdeation1"
      },
      {
        "parameters": {
          "query": "={{ $json.topics.split(', ').map(t => t + ' 2025').join(' OR ') }}",
          "options": {
            "topic": "news",
            "max_results": 5,
            "time_range": "week"
          }
        },
        "type": "@tavily/n8n-nodes-tavily.tavily",
        "typeVersion": 1,
        "position": [
          4144,
          4656
        ],
        "id": "a06736ab-9f39-4b23-a25d-2057bd954846",
        "name": "Fetch AI Headlines1",
        "credentials": {
          "tavilyApi": {
            "id": "KmiWEKpArgJSNmSk",
            "name": "Tavily account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          3952,
          4656
        ],
        "id": "f11740d8-a5cc-4b6b-b1ff-30e7660bcb45",
        "name": "Set Topics & Keywords1"
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks",
                "triggerAtDay": [
                  1,
                  4
                ],
                "triggerAtHour": 8
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          3744,
          4656
        ],
        "id": "5a5ad594-91e7-442f-ac33-5e8f11c9b365",
        "name": "Schedule Trigger (2x týdně)1"
      },
      {
        "parameters": {
          "content": "## Společná část\nMerge → Research (Tavily + Wikipedia) → Keywords → Blog Draft → VERIFIKACE → WordPress → Image → Email",
          "height": 640,
          "width": 2736,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          5232,
          4496
        ],
        "typeVersion": 1,
        "id": "56c70e5f-b9c2-45a3-b52d-21487d5b2972",
        "name": "Common Part Note1"
      },
      {
        "parameters": {
          "content": "## VĚTEV B: Manuální\nWebový formulář → zadání názvu článku, klíčových slov a délky → research",
          "height": 480,
          "width": 1072,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3664,
          5056
        ],
        "typeVersion": 1,
        "id": "1df7decd-7e45-4946-81a0-1b1b3cd6f5da",
        "name": "Branch B Note1"
      },
      {
        "parameters": {
          "content": "## VĚTEV A: Automatická\nSchedule trigger → Tavily research → AI vybere téma",
          "height": 480,
          "width": 1184,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3664,
          4496
        ],
        "typeVersion": 1,
        "id": "10a3a62d-6f00-4c48-9a92-12a38f98df92",
        "name": "Branch A Note1"
      },
      {
        "parameters": {
          "content": "# Blog Article Generator pro processgate.ai\n\n**Dvě startovní větve:**\n- **VĚTEV A (Automatická)**: Schedule 2x týdně → AI vybere téma z aktuálních trendů\n- **VĚTEV B (Manuální)**: Webový formulář → zadáš název článku, klíčová slova, délku\n\n**Nové funkce:**\n- Wikipedia tool pro fact-checking\n- Verifikační agent proti halucinacím\n\n**Společná část:**\nResearch (Tavily + Wikipedia) → Keywords/Categories → Blog Draft → Verifikace → WordPress (draft) → Imagen obrázek → Gmail notifikace",
          "height": 280,
          "width": 600,
          "color": 6
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3664,
          4096
        ],
        "typeVersion": 1,
        "id": "2950b727-b567-4be9-97c4-ccb57e15ea3a",
        "name": "Info1"
      },
      {
        "parameters": {
          "url": "https://processgate.ai/wp-json/wp/v2/tags",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "per_page",
                "value": "100"
              },
              {
                "name": "lang",
                "value": "cs"
              }
            ]
          },
          "options": {}
        },
        "id": "get-wp-tags-1",
        "name": "Get WP Tags1",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          5760,
          5184
        ],
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      }
    ],
    "connections": {
      "Prepare Email Data1": {
        "main": [
          [
            {
              "node": "Send Email Notification1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload to WordPress Media1": {
        "main": [
          [
            {
              "node": "Set Featured Image1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Process Image Response1": {
        "main": [
          [
            {
              "node": "Upload to WordPress Media1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Image (Imagen)1": {
        "main": [
          [
            {
              "node": "Process Image Response1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Assign Categories & Tags1": {
        "main": [
          [
            {
              "node": "Prepare Email Data1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Map Categories1": {
        "main": [
          [
            {
              "node": "Assign Categories & Tags1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get WP Categories1": {
        "main": [
          [
            {
              "node": "Map Categories1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create WordPress Post1": {
        "main": [
          [
            {
              "node": "Generate Image (Imagen)1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Get WP Categories1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Get WP Tags1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Final Data1": {
        "main": [
          [
            {
              "node": "Create WordPress Post1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Blog Fallback5": {
        "ai_languageModel": [
          [
            {
              "node": "Verification Agent1",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Verify Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "Verification Agent1",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter (Verify)1": {
        "ai_languageModel": [
          [
            {
              "node": "Verification Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Verification Agent1": {
        "main": [
          [
            {
              "node": "Prepare Final Data1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Blog Fallback4": {
        "ai_languageModel": [
          [
            {
              "node": "BlogDraft1",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Blog Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "BlogDraft1",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter (Blog)1": {
        "ai_languageModel": [
          [
            {
              "node": "BlogDraft1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "BlogDraft1": {
        "main": [
          [
            {
              "node": "Verification Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Blog Fallback3": {
        "ai_languageModel": [
          [
            {
              "node": "KeywordStrategy1",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Keywords Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "KeywordStrategy1",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter (Keywords)1": {
        "ai_languageModel": [
          [
            {
              "node": "KeywordStrategy1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "KeywordStrategy1": {
        "main": [
          [
            {
              "node": "BlogDraft1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate Research Data1": {
        "main": [
          [
            {
              "node": "KeywordStrategy1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wikipedia Lookup1": {
        "main": [
          [
            {
              "node": "Split Wikipedia Terms1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Wikipedia Terms1": {
        "main": [
          [
            {
              "node": "Wikipedia Lookup1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Aggregate Research Data1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Wiki Terms1": {
        "main": [
          [
            {
              "node": "Split Wikipedia Terms1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Deep Research (Tavily)1": {
        "main": [
          [
            {
              "node": "Prepare Wiki Terms1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare for Merge (B)1": {
        "main": [
          [
            {
              "node": "Deep Research (Tavily)1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Research Manual Topic1": {
        "main": [
          [
            {
              "node": "Prepare for Merge (B)1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Process Form Data1": {
        "main": [
          [
            {
              "node": "Research Manual Topic1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Formulář pro nový článek1": {
        "main": [
          [
            {
              "node": "Process Form Data1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare for Merge (A)1": {
        "main": [
          [
            {
              "node": "Deep Research (Tavily)1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Fallback1": {
        "ai_languageModel": [
          [
            {
              "node": "TopicIdeation1",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Topic Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "TopicIdeation1",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter (Claude)1": {
        "ai_languageModel": [
          [
            {
              "node": "TopicIdeation1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "TopicIdeation1": {
        "main": [
          [
            {
              "node": "Prepare for Merge (A)1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch AI Headlines1": {
        "main": [
          [
            {
              "node": "TopicIdeation1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Topics & Keywords1": {
        "main": [
          [
            {
              "node": "Fetch AI Headlines1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger (2x týdně)1": {
        "main": [
          [
            {
              "node": "Set Topics & Keywords1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get WP Tags1": {
        "main": [
          [
            {
              "node": "Map Categories1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Jiri Zmidloch",
    "name": "Version 0d1076e8",
    "description": "",
    "autosaved": false
  },
  "activeVersionId": "0d1076e8-92c8-48ec-81da-06ce30427426",
  "connections": {
    "Prepare Email Data1": {
      "main": [
        [
          {
            "node": "Send Email Notification1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload to WordPress Media1": {
      "main": [
        [
          {
            "node": "Set Featured Image1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Image Response1": {
      "main": [
        [
          {
            "node": "Upload to WordPress Media1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Image (Imagen)1": {
      "main": [
        [
          {
            "node": "Process Image Response1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Assign Categories & Tags1": {
      "main": [
        [
          {
            "node": "Prepare Email Data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Map Categories1": {
      "main": [
        [
          {
            "node": "Assign Categories & Tags1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get WP Categories1": {
      "main": [
        [
          {
            "node": "Map Categories1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create WordPress Post1": {
      "main": [
        [
          {
            "node": "Generate Image (Imagen)1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get WP Categories1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get WP Tags1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Final Data1": {
      "main": [
        [
          {
            "node": "Create WordPress Post1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini Blog Fallback5": {
      "ai_languageModel": [
        [
          {
            "node": "Verification Agent1",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Verify Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "Verification Agent1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter (Verify)1": {
      "ai_languageModel": [
        [
          {
            "node": "Verification Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Verification Agent1": {
      "main": [
        [
          {
            "node": "Prepare Final Data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini Blog Fallback4": {
      "ai_languageModel": [
        [
          {
            "node": "BlogDraft1",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Blog Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "BlogDraft1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter (Blog)1": {
      "ai_languageModel": [
        [
          {
            "node": "BlogDraft1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "BlogDraft1": {
      "main": [
        [
          {
            "node": "Verification Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini Blog Fallback3": {
      "ai_languageModel": [
        [
          {
            "node": "KeywordStrategy1",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Keywords Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "KeywordStrategy1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter (Keywords)1": {
      "ai_languageModel": [
        [
          {
            "node": "KeywordStrategy1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "KeywordStrategy1": {
      "main": [
        [
          {
            "node": "BlogDraft1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate Research Data1": {
      "main": [
        [
          {
            "node": "KeywordStrategy1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wikipedia Lookup1": {
      "main": [
        [
          {
            "node": "Split Wikipedia Terms1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Wikipedia Terms1": {
      "main": [
        [
          {
            "node": "Wikipedia Lookup1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Aggregate Research Data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Wiki Terms1": {
      "main": [
        [
          {
            "node": "Split Wikipedia Terms1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Deep Research (Tavily)1": {
      "main": [
        [
          {
            "node": "Prepare Wiki Terms1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare for Merge (B)1": {
      "main": [
        [
          {
            "node": "Deep Research (Tavily)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Research Manual Topic1": {
      "main": [
        [
          {
            "node": "Prepare for Merge (B)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Form Data1": {
      "main": [
        [
          {
            "node": "Research Manual Topic1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Formulář pro nový článek1": {
      "main": [
        [
          {
            "node": "Process Form Data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare for Merge (A)1": {
      "main": [
        [
          {
            "node": "Deep Research (Tavily)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini Fallback1": {
      "ai_languageModel": [
        [
          {
            "node": "TopicIdeation1",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Topic Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "TopicIdeation1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter (Claude)1": {
      "ai_languageModel": [
        [
          {
            "node": "TopicIdeation1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "TopicIdeation1": {
      "main": [
        [
          {
            "node": "Prepare for Merge (A)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch AI Headlines1": {
      "main": [
        [
          {
            "node": "TopicIdeation1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Topics & Keywords1": {
      "main": [
        [
          {
            "node": "Fetch AI Headlines1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger (2x týdně)1": {
      "main": [
        [
          {
            "node": "Set Topics & Keywords1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get WP Tags1": {
      "main": [
        [
          {
            "node": "Map Categories1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-18T20:21:36.707Z",
  "id": "zjHS5Hu99v86H9Xxf4JoI",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Blog Article Generator - processgate.ai",
  "nodes": [
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        7536,
        4928
      ],
      "id": "108f1495-a0d7-426f-9858-df11dbafe282",
      "name": "Gemini Blog Fallback5",
      "credentials": {
        "googlePalmApi": {
          "id": "O18dqBggPBVuy0CJ",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        6992,
        4912
      ],
      "id": "f0aba60c-e0bd-4139-8e4f-d1695190d3ca",
      "name": "Gemini Blog Fallback4",
      "credentials": {
        "googlePalmApi": {
          "id": "O18dqBggPBVuy0CJ",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        6448,
        4912
      ],
      "id": "92c43091-f14d-483a-a1bd-59d463e89d65",
      "name": "Gemini Blog Fallback3",
      "credentials": {
        "googlePalmApi": {
          "id": "O18dqBggPBVuy0CJ",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "resource": "draft",
        "subject": "={{ $json.subject }}",
        "emailType": "html",
        "message": "=<h2>{{ $json.postTitle }}</h2><p><strong>Perex:</strong> {{ $json.postExcerpt }}</p><hr><p><a href=\"{{ $json.adminUrl }}\">Otevřít článek</a></p>",
        "options": {
          "sendTo": "jirka@processgate.ai"
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        6560,
        5504
      ],
      "id": "55eb412f-a9d4-4482-b8db-604b7e626e93",
      "name": "Send Email Notification1",
      "webhookId": "fee5264b-bf20-4929-b199-5aa023beda88",
      "credentials": {
        "gmailOAuth2": {
          "id": "qNSaYVEcaWOf5U3k",
          "name": "Gmail zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const postData = $('Create WordPress Post1').item.json;\nconst finalData = $('Prepare Final Data1').item.json;\nconst adminUrl = `https://processgate.ai/wp-admin/post.php?post=${postData.id}&action=edit`;\n\nreturn {\n  json: {\n    subject: `${finalData.verified ? '✅' : '⚠️'} Nový článek k review: ${finalData.title}`,\n    postTitle: finalData.title,\n    postExcerpt: finalData.excerpt,\n    adminUrl: adminUrl,\n    categories: finalData.categories.join(', '),\n    tags: finalData.tags.join(', '),\n    source: finalData.source === 'automatic' ? 'Automaticky vygenerováno' : 'Manuálně zadáno',\n    actualLength: finalData.content.length,\n    verified: finalData.verified,\n    verificationNotes: finalData.verificationNotes\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        6352,
        5504
      ],
      "id": "ffd1c5e1-372a-47e9-8a8c-49cc5be9ac88",
      "name": "Prepare Email Data1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://processgate.ai/wp-json/wp/v2/posts/{{ $('Process Image Response1').item.json.postId }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={ \"featured_media\": {{ $json.id }} }",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        6352,
        5664
      ],
      "id": "aa82d198-0e52-4638-b16e-e10ae7cbe575",
      "name": "Set Featured Image1",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://processgate.ai/wp-json/wp/v2/media",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Disposition",
              "value": "=attachment; filename=\"{{ $json.filename }}\""
            },
            {
              "name": "Content-Type",
              "value": "image/png"
            }
          ]
        },
        "sendBody": true,
        "contentType": "raw",
        "body": "={{ Buffer.from($json.imageBase64, 'base64') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        6160,
        5664
      ],
      "id": "f938e70e-0639-44e6-90f2-b4724fcd01d2",
      "name": "Upload to WordPress Media1",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const response = $input.item.json;\nlet imageBase64 = '';\nif (response.predictions && response.predictions[0]) {\n  imageBase64 = response.predictions[0].bytesBase64Encoded;\n}\n\nreturn {\n  json: {\n    postId: $('Create WordPress Post1').item.json.id,\n    imageBase64: imageBase64,\n    filename: `${$('Prepare Final Data1').item.json.slug}-featured.png`\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5952,
        5664
      ],
      "id": "30596116-5408-442f-ba9b-2a50142f0a0b",
      "name": "Process Image Response1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googlePalmApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"instances\": [\n    { \"prompt\": \"{{ $('Prepare Final Data1').item.json.imageQuery }}, professional, modern tech style, no text, 16:9\" }\n  ],\n  \"parameters\": { \"sampleCount\": 1, \"aspectRatio\": \"16:9\" }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        5760,
        5664
      ],
      "id": "1d2659fb-1fdd-4883-bd04-ff1ccacbd859",
      "name": "Generate Image (Imagen)1",
      "credentials": {
        "googlePalmApi": {
          "id": "O18dqBggPBVuy0CJ",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://processgate.ai/wp-json/wp/v2/posts/{{ $json.postId }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"categories\": {{ JSON.stringify($json.categoryIds) }},\n  \"tags\": {{ JSON.stringify($json.tagIds) }}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        6160,
        5344
      ],
      "id": "87f45cf3-798c-445f-827b-96f05eed1934",
      "name": "Assign Categories & Tags1",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Get all items from HTTP Request nodes (they return arrays)\nconst wpCategoriesData = $('Get WP Categories1').all();\nconst wpTagsData = $('Get WP Tags1').all();\nconst aiCategories = $('Prepare Final Data1').item.json.categories || [];\nconst aiTags = $('Prepare Final Data1').item.json.tags || [];\nconst postId = $('Create WordPress Post1').item.json.id;\n\n// Flatten the arrays - each item.json is one category/tag object\nconst wpCategories = wpCategoriesData.map(item => item.json);\nconst wpTags = wpTagsData.map(item => item.json);\n\n// Map AI categories to WordPress IDs\nconst categoryIds = [];\nfor (const aiCat of aiCategories) {\n  if (!aiCat) continue;\n  const match = wpCategories.find(wpCat =>\n    wpCat.name && (\n      wpCat.name.toLowerCase() === aiCat.toLowerCase() ||\n      wpCat.name.toLowerCase().includes(aiCat.toLowerCase()) ||\n      aiCat.toLowerCase().includes(wpCat.name.toLowerCase())\n    )\n  );\n  if (match) {\n    categoryIds.push(match.id);\n  }\n}\n\n// Default category if no match found\nif (categoryIds.length === 0) {\n  categoryIds.push(176); // Umělá inteligence as default\n}\n\n// Map AI tags to WordPress IDs\nconst tagIds = [];\nfor (const aiTag of aiTags) {\n  if (!aiTag) continue;\n  const match = wpTags.find(wpTag =>\n    wpTag.name && (\n      wpTag.name.toLowerCase() === aiTag.toLowerCase() ||\n      wpTag.name.toLowerCase().includes(aiTag.toLowerCase()) ||\n      aiTag.toLowerCase().includes(wpTag.name.toLowerCase())\n    )\n  );\n  if (match) {\n    tagIds.push(match.id);\n  }\n}\n\nreturn {\n  json: {\n    postId: postId,\n    categoryIds: categoryIds,\n    tagIds: tagIds\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5952,
        5344
      ],
      "id": "e41a9513-cc6b-47b4-8b52-319ac198d273",
      "name": "Map Categories1"
    },
    {
      "parameters": {
        "url": "https://processgate.ai/wp-json/wp/v2/categories",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "per_page",
              "value": "100"
            },
            {
              "name": "lang",
              "value": "cs"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        5760,
        5344
      ],
      "id": "8f05b806-d153-462d-9a78-894ae94984f1",
      "name": "Get WP Categories1",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "title": "={{ $json.title }}",
        "additionalFields": {
          "content": "={{ $json.content }}",
          "slug": "={{ $json.slug }}",
          "status": "draft"
        }
      },
      "type": "n8n-nodes-base.wordpress",
      "typeVersion": 1,
      "position": [
        5584,
        5504
      ],
      "id": "c881c58e-e4b8-4843-b86a-420826cd19c5",
      "name": "Create WordPress Post1",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const blogData = $('BlogDraft1').item.json.output;\nconst verifyData = $json.output;\nconst keywordData = $('KeywordStrategy1').item.json.output;\nconst mergeData = $('Aggregate Research Data1').item.json;\n\nconst finalContent = verifyData.correctedContent || blogData.content;\n\nreturn {\n  json: {\n    title: blogData.title,\n    content: finalContent,\n    excerpt: blogData.excerpt,\n    slug: blogData.slug,\n    imageQuery: blogData.imageQuery,\n    categories: keywordData.categories,\n    tags: keywordData.tags,\n    keywords: keywordData.keywords,\n    source: mergeData.source,\n    targetLength: mergeData.targetLength,\n    verified: verifyData.verified,\n    verificationIssues: verifyData.issues,\n    verificationNotes: verifyData.verificationNotes\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5392,
        5504
      ],
      "id": "62de503d-2685-46f7-85d3-5ea405afac34",
      "name": "Prepare Final Data1"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"verified\", \"issues\", \"correctedContent\"],\n  \"properties\": {\n    \"verified\": { \"type\": \"boolean\", \"description\": \"True pokud článek prošel verifikací\" },\n    \"issues\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"Seznam nalezených problémů\" },\n    \"correctedContent\": { \"type\": \"string\", \"description\": \"Opravený HTML obsah článku\" },\n    \"verificationNotes\": { \"type\": \"string\", \"description\": \"Poznámky k verifikaci\" }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        7680,
        4928
      ],
      "id": "b2377856-6fa9-4819-bf61-c8d83aa32147",
      "name": "Verify Parser1"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        7392,
        4928
      ],
      "id": "f322e814-7a2e-424b-aa75-4e694fe7a922",
      "name": "OpenRouter (Verify)1",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# VERIFIKACE ČLÁNKU\n\nZkontroluj následující článek a jeho faktická tvrzení.\n\n## ČLÁNEK:\n**Název:** {{ $json.output.title }}\n\n**Obsah:**\n{{ $json.output.content }}\n\n## FAKTICKÁ TVRZENÍ K OVĚŘENÍ:\n{{ $json.output.factualClaims.map((c, i) => `${i+1}. ${c}`).join('\\n') }}\n\n## DOSTUPNÉ ZDROJE PRO OVĚŘENÍ:\n\n### Tavily Research:\n{{ $('Aggregate Research Data1').item.json.tavilyResearch.map(r => `- ${r.title}: ${r.content}`).join('\\n') }}\n\n### Wikipedia Data:\n{{ $('Aggregate Research Data1').item.json.wikipediaData.map(w => `- ${w.title}: ${w.summary}`).join('\\n') }}\n\n## ÚKOL:\n\n1. Zkontroluj každé faktické tvrzení proti dostupným zdrojům\n2. Označ problematická tvrzení, která nelze ověřit\n3. Navrhni konkrétní opravy pro neověřitelná tvrzení\n\nVrať JSON s výsledkem verifikace.",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "Jsi přísný fact-checker pro technologický blog. Tvým úkolem je identifikovat potenciální halucinace AI a neověřitelná tvrzení."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        7488,
        4640
      ],
      "id": "9a0fbe0b-6474-43bd-946a-29184d282006",
      "name": "Verification Agent1"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"title\", \"content\", \"excerpt\", \"slug\", \"imageQuery\", \"factualClaims\"],\n  \"properties\": {\n    \"title\": { \"type\": \"string\", \"description\": \"Název článku\" },\n    \"content\": { \"type\": \"string\", \"description\": \"HTML obsah článku\" },\n    \"excerpt\": { \"type\": \"string\", \"description\": \"Krátký perex pro SEO\" },\n    \"slug\": { \"type\": \"string\", \"description\": \"URL slug\" },\n    \"imageQuery\": { \"type\": \"string\", \"description\": \"Popis pro generování obrázku\" },\n    \"factualClaims\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"Klíčová faktická tvrzení k verifikaci\" }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        7136,
        4912
      ],
      "id": "6ecfd286-6bda-4fe1-89be-bf2052f9d9e6",
      "name": "Blog Parser1"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        6832,
        4928
      ],
      "id": "cfdeb185-6826-4399-92d2-2fd737c1aa48",
      "name": "OpenRouter (Blog)1",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# ZADÁNÍ ČLÁNKU (DATA)\n\nTéma (název článku): {{ $('Aggregate Research Data1').item.json.topic }}\nÚhel pohledu: {{ $('Aggregate Research Data1').item.json.angle }}\nCílová délka: {{ $('Aggregate Research Data1').item.json.targetLength }} znaků\nSEO klíčová slova: {{ $json.output.keywords.join(', ') }}\n\n# RESEARCH DATA (Tavily)\nPoužívej pouze informace z níže uvedených zdrojů.\n\n{{ $('Aggregate Research Data1').item.json.tavilyResearch.map(r => `SOURCE_TITLE: ${r.title}\\nSOURCE_URL: ${r.url}\\nSOURCE_CONTENT:\\n${r.content}\\nEND_SOURCE`).join('\\n\\n') }}\n\n# OVĚŘENÉ FAKTY (Wikipedia)\nNíže uvedené informace jsou ověřené a můžeš je použít jako základ pro faktická tvrzení.\n\n{{ $('Aggregate Research Data1').item.json.wikipediaData.map(w => `WIKI_TITLE: ${w.title}\\nWIKI_URL: ${w.url}\\nWIKI_SUMMARY:\\n${w.summary}\\nEND_WIKI`).join('\\n\\n') }}\n\n# INSTRUKCE PRO ČLÁNEK\n\nNapiš blogový článek v češtině pro processgate.ai (AI + automatizace pro malé a střední firmy).\nPiš prakticky, srozumitelně, bez přehnaných slibů.\n\n## Faktická správnost (kritické)\n- Používej POUZE informace z poskytnutých zdrojů (Tavily + Wikipedia výše).\n- Jakékoli číslo / statistika / konkrétní tvrzení musí být opřené o uvedené zdroje.\n- Pokud nemáš pro tvrzení oporu ve zdrojích, VŮBEC ho neuváděj.\n- Nezmiňuj „Tavily“, „Wikipedia API“ ani interní nástroje. Zdroje cituj přirozeně jako odkazy v textu.\n\n## Struktura a styl\n- Délka: snaž se držet přibližně cílové délky, ale priorita je kvalita a faktická správnost.\n- Obsah vrať jako HTML a používej pouze tyto tagy: <p>, <h2>, <ul>, <li>, <strong>, <a>.\n- Přidej 3–5 sekcí <h2>, ideálně s praktickými doporučeními (checklisty / kroky).\n- U odkazů použij <a href=\"URL\">krátký popis</a> a ber URL výhradně z poskytnutých zdrojů (SOURCE_URL, WIKI_URL).\n\n## Slug a excerpt\n- excerpt: 1–2 věty, max 160 znaků, bez uvozovek, bez HTML.\n- slug: pouze malá písmena a pomlčky, bez diakritiky, bez speciálních znaků.\n\n## Featured image prompt\n- imageQuery: anglicky, modern tech/AI styl, bez textu v obrázku, bez log, bez značek.\n\n# VÝSTUP (KRITICKÉ – MUSÍŠ DODRŽET)\n\nVrať POUZE jeden validní JSON objekt.\n- ŽÁDNÝ markdown\n- ŽÁDNÉ ```json\n- ŽÁDNÉ vysvětlení\n- ŽÁDNÝ text před nebo po JSON\n- Výstup musí začínat znakem { a končit znakem }\n\nJSON musí mít přesně tato pole a typy:\n{\n  \"title\": \"string\",\n  \"content\": \"string\",\n  \"excerpt\": \"string\",\n  \"slug\": \"string\",\n  \"imageQuery\": \"string\",\n  \"factualClaims\": [\"string\", \"string\"]\n}\n\nPravidla pro factualClaims:\n- Uveď 5–10 krátkých faktických tvrzení, která jsou v článku.\n- Každé tvrzení musí být ověřitelné z poskytnutých zdrojů.\n- Pokud nelze najít 5 ověřitelných tvrzení, vrať méně (klidně i prázdné pole []).\n",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "Jsi zkušený český technologický novinář a copywriter specializující se na AI, automatizaci a digitální transformaci pro malé a střední firmy."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        6944,
        4640
      ],
      "id": "53bd53d9-0328-4ce7-b9f0-ea04629beacc",
      "name": "BlogDraft1"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"keywords\", \"categories\", \"tags\"],\n  \"properties\": {\n    \"keywords\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"SEO klíčová slova v češtině\" },\n    \"categories\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"WordPress kategorie\" },\n    \"tags\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"WordPress tagy\" }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        6576,
        4912
      ],
      "id": "a04cd35d-2e5d-409a-9eaa-8ea7e7201166",
      "name": "Keywords Parser1"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        6272,
        4912
      ],
      "id": "e73ec6ee-7b7c-4fe5-b3e4-11b2470c2c89",
      "name": "OpenRouter (Keywords)1",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "Jsi SEO specialista pro české tech blogy. Tvůj úkol je vrátit přesně strukturovaný JSON.\n\nVSTUP:\nTéma článku: {{ $json.topic }}\nÚhel pohledu: {{ $json.angle }}\nVstupní klíčová slova: {{ $json.keywords.join(', ') }}\n\nTAVILY (souhrn):\n{{ $json.tavilyResearch.map(r => `SOURCE_TITLE: ${r.title}\\nSOURCE_SNIPPET: ${r.content}`).join('\\n\\n') }}\n\nWIKIPEDIA (ověřené fakty):\n{{ $json.wikipediaData.map(w => `WIKI_TITLE: ${w.title}\\nWIKI_SUMMARY: ${w.summary}`).join('\\n\\n') }}\n\nÚKOL:\n1) Vytvoř 5–8 SEO klíčových slov v češtině (relevantní pro téma). Každé jako samostatný string.\n2) Vyber 1–3 kategorie POUZE z tohoto seznamu (přesně):\n   - Automatizace\n   - Média\n   - n8n\n   - Produktivita\n   - Umělá inteligence\n3) Vyber 3–5 tagů POUZE z tohoto seznamu (přesně, bez úprav):\n   - Adobe\n   - AI\n   - Airtable\n   - Anthropic\n   - Apify\n   - automatizace\n   - avatar\n   - Baserow\n   - ChatGPT\n   - Claude\n   - Elestio\n   - Fal.ai\n   - Gemini\n   - Google\n   - GPT Image\n   - Grok\n   - HeyGen\n   - Kling\n   - Leonardo\n   - MAKE\n   - media\n   - Midjourney\n   - n8n\n   - Nano Banana\n   - NotebookLM\n   - Perplexity\n   - Polylang\n   - Sora\n   - Supabase\n   - Tabidoo\n   - Veo\n   - video\n   - Wordpress\n\nPRAVIDLA (KRITICKÉ):\n- NIKDY nevymýšlej nové kategorie ani tagy. Použij pouze položky ze seznamu výše.\n- categories musí být pole stringů, tags musí být pole stringů, keywords musí být pole stringů.\n- Vrať vždy všechna 3 pole: keywords, categories, tags (i kdyby některé bylo prázdné pole []).\n- ŽÁDNÝ markdown, ŽÁDNÉ vysvětlení, ŽÁDNÝ text navíc.\n- Výstup musí začínat znakem { a končit znakem }.\n\nVÝSTUP: Vrať POUZE validní JSON objekt přesně ve tvaru:\n{\"keywords\":[\"...\"],\"categories\":[\"...\"],\"tags\":[\"...\"]}\n",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "Jsi SEO specialista pro české tech blogy. Vytváříš klíčová slova a taxonomie v češtině. NIKDY nevymýšlej nové kategorie nebo tagy - použij POUZE ty ze zadaného seznamu. Odpovídej POUZE validním JSON objektem."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        6384,
        4656
      ],
      "id": "4501b438-23bb-4f3d-81af-0c15a0a331ef",
      "name": "KeywordStrategy1"
    },
    {
      "parameters": {
        "jsCode": "// Agregace Wikipedia dat\nconst allItems = $input.all();\nconst firstItem = $('Prepare Wiki Terms1').first();\nconst mergeData = firstItem.json.mergeData;\nconst tavilyResults = firstItem.json.tavilyResults;\n\nconst wikiData = allItems\n  .filter(item => item.json.extract)\n  .map(item => ({\n    title: item.json.title,\n    summary: item.json.extract,\n    url: item.json.content_urls?.desktop?.page || ''\n  }));\n\nreturn {\n  json: {\n    ...mergeData,\n    tavilyResearch: tavilyResults,\n    wikipediaData: wikiData\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        6128,
        4656
      ],
      "id": "48ecd0ac-4ec3-4312-a0d6-d3b60ec708ed",
      "name": "Aggregate Research Data1"
    },
    {
      "parameters": {
        "url": "=https://en.wikipedia.org/api/rest_v1/page/summary/{{ encodeURIComponent($json.term) }}",
        "options": {
          "response": {
            "response": {
              "neverError": true
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        6032,
        4928
      ],
      "id": "fd9c4702-866b-49df-850c-9492f5b8d06e",
      "name": "Wikipedia Lookup1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        5824,
        4752
      ],
      "id": "f31b6186-2a48-404d-b76b-4de81bd04c5c",
      "name": "Split Wikipedia Terms1"
    },
    {
      "parameters": {
        "jsCode": "// 1. Zjistíme, která větev běžela, abychom věděli, odkud brát wikipediaTerms\nlet mergeData;\n\ntry {\n  // Zkusíme vzít data z automatické větve\n  mergeData = $('Prepare for Merge (A)').item.json;\n} catch (e) {\n  try {\n    // Pokud větev A neběžela, zkusíme manuální větev B\n    mergeData = $('Prepare for Merge (B)').item.json;\n  } catch (e2) {\n    // Fallback, pokud by náhodou neběžela ani jedna (např. při špatném testování)\n    mergeData = { wikipediaTerms: [] };\n  }\n}\n\n// 2. Výsledky z Tavily (přímý vstup tohoto uzlu)\nconst tavilyData = $input.item.json;\n\n// 3. Vytáhneme termíny\nconst terms = mergeData.wikipediaTerms || [];\n\n// 4. Pokud nejsou žádné termíny, vytvoříme jednu položku s tématem, aby se research nezastavil\nif (terms.length === 0) {\n  return [{\n    json: {\n      term: mergeData.topic || \"AI Automation\",\n      mergeData: mergeData,\n      tavilyResults: tavilyData.results || []\n    }\n  }];\n}\n\n// 5. Rozmnožíme pro uzel \"Split In Batches\"\nreturn terms.map(term => ({\n  json: {\n    term: term,\n    mergeData: mergeData,\n    tavilyResults: tavilyData.results || []\n  }\n}));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5600,
        4752
      ],
      "id": "fb1a1275-1851-46ea-b3d2-7e587e1f5c3f",
      "name": "Prepare Wiki Terms1"
    },
    {
      "parameters": {
        "query": "={{ $json.searchQuery || $json.topic }}",
        "options": {
          "max_results": 5,
          "include_raw_content": true
        }
      },
      "type": "@tavily/n8n-nodes-tavily.tavily",
      "typeVersion": 1,
      "position": [
        5440,
        4752
      ],
      "id": "5d90bc68-6766-4d7b-9233-99e4a0bdea6b",
      "name": "Deep Research (Tavily)1",
      "credentials": {
        "tavilyApi": {
          "id": "KmiWEKpArgJSNmSk",
          "name": "Tavily account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Připravit data pro merge z manuální větve\nconst processedData = $('Process Form Data1').item.json;\nconst researchData = $input.item.json;\n\nreturn {\n  json: {\n    ...processedData,\n    initialResearch: researchData.results\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4352,
        5216
      ],
      "id": "64bc3f12-5be0-4b91-a06a-ce0d8af695fc",
      "name": "Prepare for Merge (B)1"
    },
    {
      "parameters": {
        "query": "={{ $json.topic }}",
        "options": {
          "max_results": 5,
          "time_range": "month",
          "include_raw_content": true
        }
      },
      "type": "@tavily/n8n-nodes-tavily.tavily",
      "typeVersion": 1,
      "position": [
        4144,
        5216
      ],
      "id": "be227125-9e3d-4388-a07a-dc17b41d6496",
      "name": "Research Manual Topic1",
      "credentials": {
        "tavilyApi": {
          "id": "KmiWEKpArgJSNmSk",
          "name": "Tavily account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Extrakce dat z formuláře a příprava pro research\nconst formData = $input.item.json;\n\n// Extrakce klíčových slov pro Wikipedia lookup\nconst keywords = formData['Klíčová slova'].split(',').map(k => k.trim());\n\n// Vytvoření Wikipedia termínů z klíčových slov (anglické verze)\nconst translations = {\n  'automatizace': 'automation',\n  'umělá inteligence': 'artificial intelligence',\n  'AI': 'artificial intelligence',\n  'produktivita': 'productivity',\n  'workflow': 'workflow',\n  'n8n': 'n8n',\n  'integrace': 'system integration',\n  'API': 'API',\n  'onboarding': 'onboarding',\n  'HR': 'human resources'\n};\n\nconst wikipediaTerms = keywords.slice(0, 3).map(k => {\n  return translations[k.toLowerCase()] || k;\n});\n\nreturn {\n  json: {\n    source: 'manual',\n    topic: formData['Název článku'],\n    angle: 'Zadáno uživatelem přes formulář',\n    searchQuery: formData['Název článku'],\n    wikipediaTerms: wikipediaTerms,\n    keywords: keywords,\n    targetLength: formData['Délka článku (znaky)'] || 4500\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3952,
        5216
      ],
      "id": "b4d2b01f-b70c-4b9e-9469-df250dc7575e",
      "name": "Process Form Data1"
    },
    {
      "parameters": {
        "formTitle": "Nový blogový článek",
        "formDescription": "Zadejte informace pro vygenerování článku na processgate.ai",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Název článku",
              "placeholder": "např. Využití n8n a Airtable při onboardingu zaměstnanců",
              "requiredField": true
            },
            {
              "fieldLabel": "Klíčová slova",
              "placeholder": "n8n, Airtable, onboarding, HR automatizace",
              "requiredField": true
            },
            {
              "fieldLabel": "Délka článku (znaky)",
              "fieldType": "number",
              "placeholder": "4500"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.2,
      "position": [
        3744,
        5216
      ],
      "id": "d01055e3-90c1-4d77-af26-7dc18d01ac2b",
      "name": "Formulář pro nový článek1",
      "webhookId": "2ac1416a-10ce-41de-9d47-2e38ffe569bd"
    },
    {
      "parameters": {
        "jsCode": "// Připravit data pro merge z automatické větve\nconst topicData = $('TopicIdeation1').item.json.output;\nconst originalData = $('Set Topics & Keywords1').item.json;\n\nreturn {\n  json: {\n    source: 'automatic',\n    topic: topicData.title,\n    angle: topicData.angle,\n    searchQuery: topicData.searchQuery,\n    wikipediaTerms: topicData.wikipediaTerms || [],\n    keywords: (originalData.keywords || \"\").split(', '),\n    targetLength: originalData.targetLength\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4688,
        4656
      ],
      "id": "ec5a3758-faf9-4ba0-8233-d497d0f0c72a",
      "name": "Prepare for Merge (A)1"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"title\", \"angle\", \"searchQuery\", \"wikipediaTerms\"],\n  \"properties\": {\n    \"title\": { \"type\": \"string\", \"description\": \"Český název článku\" },\n    \"angle\": { \"type\": \"string\", \"description\": \"Úhel pohledu článku\" },\n    \"searchQuery\": { \"type\": \"string\", \"description\": \"Anglický vyhledávací dotaz\" },\n    \"wikipediaTerms\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"description\": \"Termíny pro Wikipedia lookup\" }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        4544,
        4864
      ],
      "id": "22d3f67c-f098-4e98-bc5c-352eede5ed11",
      "name": "Topic Parser1"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        4320,
        4864
      ],
      "id": "8449c0bf-98c3-4bca-abd2-13b060bf41b0",
      "name": "Gemini Fallback1",
      "credentials": {
        "googlePalmApi": {
          "id": "O18dqBggPBVuy0CJ",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        4192,
        4864
      ],
      "id": "7053e957-d629-4f5f-a614-ac748898cc75",
      "name": "OpenRouter (Claude)1",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Zde jsou aktuální novinky z oblasti AI a automatizace:\n\n{{ $json.results.map((r, i) => `${i+1}. ${r.title}\\n   ${r.content}\\n   Zdroj: ${r.url}`).join('\\n\\n') }}\n\nNa základě těchto novinek vyber JEDNO téma, které bude nejzajímavější pro české publikum zaměřené na malé a střední firmy. Téma by mělo být praktické a aktuální.\n\nVrať JSON s těmito poli:\n- title: český název článku (jasný, konkrétní, bez clickbaitu)\n- angle: úhel pohledu / hlavní myšlenka článku\n- searchQuery: anglický vyhledávací dotaz pro další research\n- wikipediaTerms: pole 2-3 anglických termínů pro vyhledání na Wikipedii (pro ověření faktů)",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "Jsi expert na obsahovou strategii pro tech blogy. Vybíráš témata, která jsou relevantní pro české podnikatele a manažery zajímající se o AI a automatizaci. Odpovídej POUZE validním JSON objektem."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        4352,
        4656
      ],
      "id": "d1e0e7c7-fdf5-444e-8e26-68c1908a80a1",
      "name": "TopicIdeation1"
    },
    {
      "parameters": {
        "query": "={{ $json.topics.split(', ').map(t => t + ' 2025').join(' OR ') }}",
        "options": {
          "topic": "news",
          "max_results": 5,
          "time_range": "week"
        }
      },
      "type": "@tavily/n8n-nodes-tavily.tavily",
      "typeVersion": 1,
      "position": [
        4144,
        4656
      ],
      "id": "a06736ab-9f39-4b23-a25d-2057bd954846",
      "name": "Fetch AI Headlines1",
      "credentials": {
        "tavilyApi": {
          "id": "KmiWEKpArgJSNmSk",
          "name": "Tavily account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3952,
        4656
      ],
      "id": "f11740d8-a5cc-4b6b-b1ff-30e7660bcb45",
      "name": "Set Topics & Keywords1"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1,
                4
              ],
              "triggerAtHour": 8
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        3744,
        4656
      ],
      "id": "5a5ad594-91e7-442f-ac33-5e8f11c9b365",
      "name": "Schedule Trigger (2x týdně)1"
    },
    {
      "parameters": {
        "content": "## Společná část\nMerge → Research (Tavily + Wikipedia) → Keywords → Blog Draft → VERIFIKACE → WordPress → Image → Email",
        "height": 640,
        "width": 2736,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        5232,
        4496
      ],
      "typeVersion": 1,
      "id": "56c70e5f-b9c2-45a3-b52d-21487d5b2972",
      "name": "Common Part Note1"
    },
    {
      "parameters": {
        "content": "## VĚTEV B: Manuální\nWebový formulář → zadání názvu článku, klíčových slov a délky → research",
        "height": 480,
        "width": 1072,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        3664,
        5056
      ],
      "typeVersion": 1,
      "id": "1df7decd-7e45-4946-81a0-1b1b3cd6f5da",
      "name": "Branch B Note1"
    },
    {
      "parameters": {
        "content": "## VĚTEV A: Automatická\nSchedule trigger → Tavily research → AI vybere téma",
        "height": 480,
        "width": 1184,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        3664,
        4496
      ],
      "typeVersion": 1,
      "id": "10a3a62d-6f00-4c48-9a92-12a38f98df92",
      "name": "Branch A Note1"
    },
    {
      "parameters": {
        "content": "# Blog Article Generator pro processgate.ai\n\n**Dvě startovní větve:**\n- **VĚTEV A (Automatická)**: Schedule 2x týdně → AI vybere téma z aktuálních trendů\n- **VĚTEV B (Manuální)**: Webový formulář → zadáš název článku, klíčová slova, délku\n\n**Nové funkce:**\n- Wikipedia tool pro fact-checking\n- Verifikační agent proti halucinacím\n\n**Společná část:**\nResearch (Tavily + Wikipedia) → Keywords/Categories → Blog Draft → Verifikace → WordPress (draft) → Imagen obrázek → Gmail notifikace",
        "height": 280,
        "width": 600,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        3664,
        4096
      ],
      "typeVersion": 1,
      "id": "2950b727-b567-4be9-97c4-ccb57e15ea3a",
      "name": "Info1"
    },
    {
      "parameters": {
        "url": "https://processgate.ai/wp-json/wp/v2/tags",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "per_page",
              "value": "100"
            },
            {
              "name": "lang",
              "value": "cs"
            }
          ]
        },
        "options": {}
      },
      "id": "get-wp-tags-1",
      "name": "Get WP Tags1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        5760,
        5184
      ],
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    }
  ],
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false,
    "timeSavedMode": "fixed",
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "zVAjJgKV17IWzFP7"
  },
  "shared": [
    {
      "updatedAt": "2026-01-18T20:21:36.707Z",
      "createdAt": "2026-01-18T20:21:36.707Z",
      "role": "workflow:owner",
      "workflowId": "zjHS5Hu99v86H9Xxf4JoI",
      "projectId": "XqkS7oX8lMj4YbIK"
    }
  ],
  "staticData": null,
  "tags": [
    {
      "updatedAt": "2025-11-25T10:02:49.590Z",
      "createdAt": "2025-11-25T10:02:49.590Z",
      "id": "iu8EkneS24SJyD0c",
      "name": "AI"
    }
  ],
  "triggerCount": 2,
  "updatedAt": "2026-01-19T10:27:09.446Z",
  "versionId": "0d1076e8-92c8-48ec-81da-06ce30427426"
}