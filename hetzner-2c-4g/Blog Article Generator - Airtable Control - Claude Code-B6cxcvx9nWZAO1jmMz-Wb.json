{
  "active": true,
  "activeVersion": {
    "updatedAt": "2026-01-22T00:10:51.941Z",
    "createdAt": "2026-01-22T00:10:39.125Z",
    "versionId": "dd39f393-5cd5-4ac9-89f2-14a8ea1090c9",
    "workflowId": "B6cxcvx9nWZAO1jmMz-Wb",
    "nodes": [
      {
        "parameters": {
          "content": "# Blog Article Generator with Airtable Control\n\n**Workflow Overview:**\n- Airtable webhook triggers on status change\n- Routes to appropriate processing branch based on status\n- Research → Content Generation → Humanization → Publishing\n\n**Statuses:**\n- New → Researching → Writing → Humanizing → Review → Approved → Publishing → Published\n\n**Services Used:**\n- OpenRouter (Claude 4.5 Opus + Gemini 3.0 Flash fallback)\n- Tavily (web research)\n- Perplexity (deep research)\n- Wikipedia (fact verification)\n- Nano Banana Pro / Imagen 3.0 (image generation)\n- WordPress (publishing to processgate.ai)\n- Gmail (notifications)",
          "height": 528,
          "width": 452,
          "color": 6
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -736,
          -144
        ],
        "id": "2ee82656-9fb7-4022-9561-29780b74d64e",
        "name": "Workflow Info"
      },
      {
        "parameters": {
          "content": "## BRANCH 1: Research Pipeline\n\nTriggers when Status = 'New'\n\n1. Update status to 'Researching'\n2. Tavily search for topic\n3. Perplexity deep research\n4. Wikipedia lookup for key terms\n5. AI synthesis of research data\n6. Save to Airtable\n7. Update status to 'Writing'",
          "height": 296,
          "width": 496,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          272,
          -400
        ],
        "id": "5dc30c60-0106-47fc-a6f7-ac5dd02e5449",
        "name": "Research Branch Note"
      },
      {
        "parameters": {
          "content": "## BRANCH 2: Content Generation\n\nTriggers when Status = 'Writing'\n\n1. Keyword Strategy Agent\n2. Title Refinement Agent\n3. Key Takeaways Agent\n4. Outline Agent\n5. Content Writer Agent (Czech)\n6. Word count check\n7. Save draft to Airtable\n8. Update status to 'Humanizing'",
          "height": 344,
          "width": 736,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          416,
          288
        ],
        "id": "01cde18e-ee06-4378-9d5c-a07738b44cc4",
        "name": "Content Branch Note"
      },
      {
        "parameters": {
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "authentication": "airtableTokenApi",
          "baseId": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "tableId": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "triggerField": "Status",
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.airtableTrigger",
        "typeVersion": 1,
        "position": [
          -224,
          144
        ],
        "id": "1e0dc062-13e6-4f3b-be4c-867ceebd12f5",
        "name": "Airtable Status Change",
        "webhookId": "blog-article-status-trigger",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "dataType": "string",
          "value1": "={{ $json.fields.Status }}",
          "rules": {
            "rules": [
              {
                "value2": "New",
                "outputKey": "Researching"
              },
              {
                "value2": "Writing",
                "outputKey": "Writing"
              },
              {
                "value2": "Humanizing",
                "outputKey": "Humanizing"
              },
              {
                "value2": "Approved",
                "outputKey": "Publishing"
              }
            ]
          }
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 2,
        "position": [
          -16,
          112
        ],
        "id": "d187b84b-94d8-4ec2-8d0c-5b02d40e40bf",
        "name": "Route by Status"
      },
      {
        "parameters": {
          "operation": "update",
          "base": {
            "__rl": true,
            "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "table": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "id": "={{ $json.id }}",
              "Status": "Researching"
            },
            "matchingColumns": [
              "id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "readOnly": true,
                "removed": false
              },
              {
                "id": "Title",
                "displayName": "Title",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Slug",
                "displayName": "Slug",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Status",
                "displayName": "Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "New",
                    "value": "New"
                  },
                  {
                    "name": "Researching",
                    "value": "Researching"
                  },
                  {
                    "name": "Writing",
                    "value": "Writing"
                  },
                  {
                    "name": "Humanizing",
                    "value": "Humanizing"
                  },
                  {
                    "name": "Review",
                    "value": "Review"
                  },
                  {
                    "name": "Approved",
                    "value": "Approved"
                  },
                  {
                    "name": "Publishing",
                    "value": "Publishing"
                  },
                  {
                    "name": "Published",
                    "value": "Published"
                  },
                  {
                    "name": "Failed",
                    "value": "Failed"
                  }
                ],
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Priority",
                "displayName": "Priority",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Target Length",
                "displayName": "Target Length",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Primary Keywords",
                "displayName": "Primary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Secondary Keywords",
                "displayName": "Secondary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Categories",
                "displayName": "Categories",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Tags",
                "displayName": "Tags",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "array",
                "options": [
                  {
                    "name": "AI",
                    "value": "AI"
                  },
                  {
                    "name": "SMB",
                    "value": "SMB"
                  },
                  {
                    "name": "transformace",
                    "value": "transformace"
                  },
                  {
                    "name": "marketing",
                    "value": "marketing"
                  },
                  {
                    "name": "nástroje",
                    "value": "nástroje"
                  },
                  {
                    "name": "automatizace",
                    "value": "automatizace"
                  },
                  {
                    "name": "case study",
                    "value": "case study"
                  },
                  {
                    "name": "výroba",
                    "value": "výroba"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Research Data",
                "displayName": "Research Data",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Content",
                "displayName": "Content",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Excerpt",
                "displayName": "Excerpt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Image Prompt",
                "displayName": "Image Prompt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Featured Image URL",
                "displayName": "Featured Image URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress Post ID",
                "displayName": "WordPress Post ID",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress URL",
                "displayName": "WordPress URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Status",
                "displayName": "Verification Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "Pending",
                    "value": "Pending"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Notes",
                "displayName": "Verification Notes",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Error Log",
                "displayName": "Error Log",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.airtable",
        "typeVersion": 2,
        "position": [
          288,
          -32
        ],
        "id": "0c1de2b9-06e2-43cb-8582-55e279c2947f",
        "name": "Set Status: Researching",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "query": "={{ $('Airtable Status Change').item.json.fields.Title }} {{ $('Airtable Status Change').item.json.fields['Primary Keywords'] || '' }} {{ $('Airtable Status Change').item.json.fields['Secondary Keywords'] || '' }}",
          "options": {
            "topic": "general",
            "max_results": 10,
            "include_raw_content": true
          }
        },
        "type": "@tavily/n8n-nodes-tavily.tavily",
        "typeVersion": 1,
        "position": [
          544,
          -32
        ],
        "id": "7bf1d52a-606c-447d-9df0-c8d1985f8d8c",
        "name": "Tavily Research",
        "credentials": {
          "tavilyApi": {
            "id": "KmiWEKpArgJSNmSk",
            "name": "Tavily account"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.perplexity.ai/chat/completions",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpBearerAuth",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"sonar-pro\",\n  \"web_search_options\": {\n    \"max_search_results\": 10\n  },\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are a professional blog content strategist and SEO copywriter. Research topics deeply, analyze search intent, identify content gaps, and generate high-performing blog post frameworks.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"Research and analyze the following blog topic for a Czech tech blog: '{{ $('Airtable Status Change').item.json.fields.Title }}'\\n\\nProvide:\\n1. Search Intent Analysis\\n2. Content Gap identification\\n3. Key Subtopics & Questions\\n4. Primary & Secondary Keywords (Czech and English)\\n5. Competitor Analysis\\n6. Data & Statistics to include\\n7. Target Audience Insights\"\n    }\n  ]\n}",
          "options": {
            "timeout": 60000
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          784,
          -32
        ],
        "id": "42562a2d-3a01-41f5-8d7f-7cc1289ecd49",
        "name": "Perplexity Deep Research",
        "credentials": {
          "httpBearerAuth": {
            "id": "zBYPTqhJcRJXe4RQ",
            "name": "Perplexity 2"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Prepare Wikipedia lookup terms from research\nconst tavilyResults = $('Tavily Research').first().json.results || [];\nconst articleJson = $('Airtable Status Change').first().json;\n// Airtable Trigger v1 returns {id, fields: {...}}\nconst articleTitle = articleJson.fields?.Title || articleJson.Title || '';\nconst keywords = articleJson.fields?.['Primary Keywords'] || articleJson['Primary Keywords'] || '';\n\n// Extract key terms for Wikipedia lookup\nconst keyTerms = new Set();\n\n// Add main keywords\nkeywords.split(',').forEach(kw => {\n  const term = kw.trim();\n  if (term.length > 2) keyTerms.add(term);\n});\n\n// Extract important terms from Tavily results\ntavilyResults.slice(0, 5).forEach(result => {\n  if (result.title) {\n    const words = result.title.split(/s+/);\n    words.forEach(word => {\n      if (word.length > 4 && /^[A-Z]/.test(word)) {\n        keyTerms.add(word);\n      }\n    });\n  }\n});\n\n// Limit to 5 terms max\nconst termsArray = Array.from(keyTerms).slice(0, 5);\n\n// Handle empty case\nif (termsArray.length === 0) {\n  return [{ json: { term: articleTitle.split(' ')[0] || 'AI', articleId: articleJson.id, articleTitle: articleTitle } }];\n}\n\nreturn termsArray.map(term => ({\n  json: {\n    term: term,\n    articleId: articleJson.id,\n    articleTitle: articleTitle\n  }\n}));"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1024,
          -32
        ],
        "id": "663230fd-ecad-4b38-9677-30d6b920c126",
        "name": "Prepare Wikipedia Terms"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          1264,
          -32
        ],
        "id": "0aeaead4-6bdf-44fd-9e81-7886357e2939",
        "name": "Loop Wiki Terms"
      },
      {
        "parameters": {
          "url": "=https://en.wikipedia.org/api/rest_v1/page/summary/{{ encodeURIComponent($json.term) }}",
          "options": {
            "response": {
              "response": {
                "neverError": true
              }
            },
            "timeout": 10000
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          1504,
          48
        ],
        "id": "c315023b-2ad2-40b0-b7aa-f945c24e1543",
        "name": "Wikipedia Lookup"
      },
      {
        "parameters": {
          "jsCode": "// Aggregate all research data\nconst allWikiItems = $input.all();\nconst tavilyData = $('Tavily Research').first().json;\nconst perplexityData = $('Perplexity Deep Research').first().json;\nconst articleData = $('Airtable Status Change').first().json;\n\n// Collect successful Wikipedia results\nconst wikiData = allWikiItems\n  .filter(item => item.json.extract && !item.json.type?.includes('not_found'))\n  .map(item => ({\n    title: item.json.title || '',\n    summary: item.json.extract || '',\n    url: item.json.content_urls?.desktop?.page || ''\n  }));\n\n// Clean Perplexity content with citations\nlet perplexityContent = '';\nif (perplexityData.choices && perplexityData.choices[0]) {\n  perplexityContent = perplexityData.choices[0].message.content;\n  const citations = perplexityData.citations || [];\n  for (let i = 0; i < 10; i++) {\n    perplexityContent = perplexityContent.replaceAll(\n      `[${i + 1}]`,\n      citations[i] ? ` (source: ${citations[i]})` : ''\n    );\n  }\n}\n\n// Compile research data\nconst researchData = {\n  tavily: {\n    query: tavilyData.query || '',\n    results: (tavilyData.results || []).slice(0, 8).map(r => ({\n      title: r.title,\n      content: r.content,\n      url: r.url,\n      rawContent: r.raw_content?.substring(0, 2000) || ''\n    }))\n  },\n  perplexity: perplexityContent,\n  wikipedia: wikiData,\n  articleId: articleData.id,\n  articleTitle: (articleData.fields?.Title || articleData.Title || ''),\n  primaryKeywords: (articleData.fields?.['Primary Keywords'] || articleData['Primary Keywords']) || '',\n  targetLength: (articleData.fields?.['Target Length'] || articleData['Target Length']) || 2000\n};\n\nreturn { json: researchData };"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1696,
          -48
        ],
        "id": "e400b0c5-ccda-4e16-9bd3-05ca5230005c",
        "name": "Aggregate Research Data"
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"search_intent\", \"writing_style\", \"writing_tone\", \"target_audience\", \"article_goal\"],\n  \"properties\": {\n    \"search_intent\": { \"type\": \"string\" },\n    \"writing_style\": { \"type\": \"string\" },\n    \"writing_tone\": { \"type\": \"string\" },\n    \"target_audience\": { \"type\": \"string\" },\n    \"article_goal\": { \"type\": \"string\" },\n    \"hidden_insights\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n    \"semantic_analysis\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"common_subtopics\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n        \"related_questions\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n      }\n    },\n    \"keywords\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"primary\": { \"type\": \"string\" },\n        \"secondary\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n        \"semantic\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n        \"long_tail\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n      }\n    },\n    \"key_facts\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          2160,
          160
        ],
        "id": "252af9e2-5e2b-4e9f-ab59-623bee85cb99",
        "name": "Research Parser"
      },
      {
        "parameters": {
          "jsCode": "// Combine research synthesis with raw research data\n// Změna: Opraven název uzlu, smazáno \" - old\"\nconst synthesisOutput = $('Research Synthesis Agent').first().json.output;\nconst aggregatedData = $('Aggregate Research Data').first().json;\n\nconst combinedResearch = {\n  synthesis: synthesisOutput,\n  rawData: {\n    tavily: aggregatedData.tavily,\n    perplexity: aggregatedData.perplexity,\n    wikipedia: aggregatedData.wikipedia\n  },\n  articleId: aggregatedData.articleId,\n  articleTitle: aggregatedData.articleTitle,\n  targetLength: aggregatedData.targetLength\n};\n\nreturn { json: combinedResearch };"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2352,
          -48
        ],
        "id": "adc24d46-9625-49d8-88d1-78536ec1a1c4",
        "name": "Prepare Research for Save"
      },
      {
        "parameters": {
          "operation": "update",
          "base": {
            "__rl": true,
            "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "table": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "id": "={{ $json.articleId }}",
              "Status": "Writing",
              "Research Data": "={{ JSON.stringify($json.synthesis) }}"
            },
            "matchingColumns": [
              "id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "readOnly": true,
                "removed": false
              },
              {
                "id": "Title",
                "displayName": "Title",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Slug",
                "displayName": "Slug",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Status",
                "displayName": "Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "New",
                    "value": "New"
                  },
                  {
                    "name": "Researching",
                    "value": "Researching"
                  },
                  {
                    "name": "Writing",
                    "value": "Writing"
                  },
                  {
                    "name": "Humanizing",
                    "value": "Humanizing"
                  },
                  {
                    "name": "Review",
                    "value": "Review"
                  },
                  {
                    "name": "Approved",
                    "value": "Approved"
                  },
                  {
                    "name": "Publishing",
                    "value": "Publishing"
                  },
                  {
                    "name": "Published",
                    "value": "Published"
                  },
                  {
                    "name": "Failed",
                    "value": "Failed"
                  }
                ],
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Priority",
                "displayName": "Priority",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Target Length",
                "displayName": "Target Length",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Primary Keywords",
                "displayName": "Primary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Secondary Keywords",
                "displayName": "Secondary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Categories",
                "displayName": "Categories",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Tags",
                "displayName": "Tags",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "array",
                "options": [
                  {
                    "name": "AI",
                    "value": "AI"
                  },
                  {
                    "name": "SMB",
                    "value": "SMB"
                  },
                  {
                    "name": "transformace",
                    "value": "transformace"
                  },
                  {
                    "name": "marketing",
                    "value": "marketing"
                  },
                  {
                    "name": "nástroje",
                    "value": "nástroje"
                  },
                  {
                    "name": "automatizace",
                    "value": "automatizace"
                  },
                  {
                    "name": "case study",
                    "value": "case study"
                  },
                  {
                    "name": "výroba",
                    "value": "výroba"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Research Data",
                "displayName": "Research Data",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Content",
                "displayName": "Content",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Excerpt",
                "displayName": "Excerpt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Image Prompt",
                "displayName": "Image Prompt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Featured Image URL",
                "displayName": "Featured Image URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress Post ID",
                "displayName": "WordPress Post ID",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress URL",
                "displayName": "WordPress URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Status",
                "displayName": "Verification Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "Pending",
                    "value": "Pending"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Notes",
                "displayName": "Verification Notes",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Error Log",
                "displayName": "Error Log",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.airtable",
        "typeVersion": 2,
        "position": [
          2560,
          -48
        ],
        "id": "8ca74c5b-2bd8-4afb-bf9e-13dcd5a0a752",
        "name": "Save Research & Set Writing",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "url",
            "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "__regex": "https://airtable.com/([a-zA-Z0-9]{2,})"
          },
          "table": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "id": "={{ $('Airtable Status Change').item.json.id }}",
          "options": {}
        },
        "type": "n8n-nodes-base.airtable",
        "typeVersion": 2,
        "position": [
          400,
          704
        ],
        "id": "42890d6e-1a5e-42e3-973d-1f96ef851a5f",
        "name": "Fetch Article for Writing",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Parse research data and prepare for content generation\nconst article = $input.first().json;\n\n// Oprava: Odstraněno '.fields', protože vstupní data jsou plochá\n// Data v 'Research Data' jsou textový řetězec, takže JSON.parse je správně\nconst researchData = JSON.parse(article['Research Data'] || '{}');\n\n// Oprava: Pokud je 'Categories' text (ve vstupu je \"Nastroje,Automatizace\"), \n// je lepší ho rozdělit na pole, pokud to další uzly očekávají.\nconst categories = typeof article.Categories === 'string' \n  ? article.Categories.split(',') \n  : (article.Categories || []);\n\nreturn {\n  json: {\n    articleId: article.id,\n    // Oprava: Přímý přístup k vlastnostem (bez .fields)\n    title: article.Title, \n    primaryKeywords: article['Primary Keywords'] || '',\n    secondaryKeywords: article['Secondary Keywords'] || '',\n    categories: categories,\n    tags: article.Tags || [], // Ve vstupu už je to pole\n    targetLength: article['Target Length'] || 2000,\n    research: researchData\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          576,
          704
        ],
        "id": "b1006d7a-31ca-442b-862f-b5419ff022a8",
        "name": "Parse Article Data"
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"seoKeywords\", \"categories\", \"tags\"],\n  \"properties\": {\n    \"seoKeywords\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n    \"categories\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n    \"tags\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          928,
          944
        ],
        "id": "f27aad95-63df-4a44-9c17-fa847f550082",
        "name": "Keywords Parser"
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"revisedTitle\", \"reasoning\"],\n  \"properties\": {\n    \"revisedTitle\": { \"type\": \"string\" },\n    \"reasoning\": { \"type\": \"string\" }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          1360,
          944
        ],
        "id": "87ab8ea4-6974-4694-ad81-5ba44795a117",
        "name": "Title Parser"
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"title\", \"content\", \"excerpt\", \"slug\", \"imageQuery\"],\n  \"properties\": {\n    \"title\": { \"type\": \"string\" },\n    \"content\": { \"type\": \"string\" },\n    \"excerpt\": { \"type\": \"string\" },\n    \"slug\": { \"type\": \"string\" },\n    \"imageQuery\": { \"type\": \"string\" }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          2448,
          944
        ],
        "id": "af74975c-14a6-4934-9e55-0de15887c34d",
        "name": "Content Parser"
      },
      {
        "parameters": {
          "jsCode": "// 1. Získání výstupu z AI (Content Writer Agent)\nlet contentData = $json.output || $json;\n\n// Ošetření: Pokud AI vrátí text (string) místo JSONu, zkusíme ho opravit\nif (typeof contentData === 'string') {\n  try {\n    const cleanJson = contentData.replace(/```json|```/g, '').trim();\n    contentData = JSON.parse(cleanJson);\n  } catch (e) {\n    // Pokud selže parsování, vytvoříme objekt ručně\n    contentData = { content: contentData, title: 'Vygenerováno (chyba parsování)' };\n  }\n}\n\n// 2. Bezpečné získání Target Length z Airtable (z uzlu 'Parse Article Data')\n// Používáme $items(), což je spolehlivější způsob, jak sáhnout na dřívější uzel\nlet targetLimit = 2000; // Defaultní hodnota\ntry {\n  // Najdeme data z uzlu Parse Article Data\n  const parseDataNode = $('Parse Article Data').all();\n  if (parseDataNode && parseDataNode.length > 0) {\n    const rawLimit = parseDataNode[0].json.targetLength;\n    targetLimit = parseInt(rawLimit);\n    \n    // Pokud v Airtable nebylo číslo, vrátíme se k defaultu\n    if (isNaN(targetLimit)) targetLimit = 2000;\n  }\n} catch (error) {\n  console.log('Nepodařilo se načíst Target Length z předchozího kroku, používám 2000.');\n}\n\n// 3. Spočítání slov\nconst content = contentData.content || '';\n// Odstraníme HTML tagy pro přesnější počítání slov\nconst textOnly = content.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim();\nconst wordCount = textOnly.split(' ').length;\n\n// 4. Logika limitu (Tolerance 10-20% je běžná, aby se článek hned nekrátil kvůli pár slovům)\n// Pokud chcete být striktní, změňte 1.2 na 1.05 nebo 1.0\nconst isOverLimit = wordCount > (targetLimit * 1.15); \n\nreturn {\n  json: {\n    ...contentData, // Předáme dál titul, slug, excerpt atd.\n    wordCount: wordCount,\n    limit: targetLimit,\n    wordLimitOver: isOverLimit,\n    // Zajistíme ID pro další kroky\n    articleId: $('Parse Article Data').all()[0].json.articleId\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2624,
          704
        ],
        "id": "516973fc-5845-45f1-9262-80cc419334e4",
        "name": "Word Count Check"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "word-limit-check",
                "leftValue": "={{ $json.wordLimitOver }}",
                "rightValue": "=true",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          2800,
          704
        ],
        "id": "8cc5ed23-e90d-4cd0-8df0-118bc62e46fa",
        "name": "Over Word Limit?"
      },
      {
        "parameters": {
          "jsCode": "// Merge compressed content back\nconst originalData = $('Word Count Check').first().json;\nconst compressedContent = $json.output;\n\nreturn {\n  json: {\n    ...originalData,\n    content: compressedContent,\n    wasCompressed: true\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3280,
          848
        ],
        "id": "b10e4256-b874-4676-ab0e-7aef9b00a528",
        "name": "Merge Compressed"
      },
      {
        "parameters": {
          "operation": "update",
          "base": {
            "__rl": true,
            "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "table": {
            "__rl": true,
            "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "id": "={{ $json.articleId }}",
              "Status": "Humanizing",
              "Content": "={{ $json.content }}",
              "Excerpt": "={{ $json.excerpt }}",
              "Slug": "={{ $json.slug }}",
              "Image Prompt": "={{ $json.imageQuery }}"
            },
            "matchingColumns": [
              "id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "readOnly": true,
                "removed": false
              },
              {
                "id": "Title",
                "displayName": "Title",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Slug",
                "displayName": "Slug",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Status",
                "displayName": "Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "New",
                    "value": "New"
                  },
                  {
                    "name": "Researching",
                    "value": "Researching"
                  },
                  {
                    "name": "Writing",
                    "value": "Writing"
                  },
                  {
                    "name": "Humanizing",
                    "value": "Humanizing"
                  },
                  {
                    "name": "Review",
                    "value": "Review"
                  },
                  {
                    "name": "Approved",
                    "value": "Approved"
                  },
                  {
                    "name": "Publishing",
                    "value": "Publishing"
                  },
                  {
                    "name": "Published",
                    "value": "Published"
                  },
                  {
                    "name": "Failed",
                    "value": "Failed"
                  }
                ],
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Priority",
                "displayName": "Priority",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Target Length",
                "displayName": "Target Length",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Primary Keywords",
                "displayName": "Primary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Secondary Keywords",
                "displayName": "Secondary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Categories",
                "displayName": "Categories",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Tags",
                "displayName": "Tags",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "array",
                "options": [
                  {
                    "name": "AI",
                    "value": "AI"
                  },
                  {
                    "name": "SMB",
                    "value": "SMB"
                  },
                  {
                    "name": "transformace",
                    "value": "transformace"
                  },
                  {
                    "name": "marketing",
                    "value": "marketing"
                  },
                  {
                    "name": "nástroje",
                    "value": "nástroje"
                  },
                  {
                    "name": "automatizace",
                    "value": "automatizace"
                  },
                  {
                    "name": "case study",
                    "value": "case study"
                  },
                  {
                    "name": "výroba",
                    "value": "výroba"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Research Data",
                "displayName": "Research Data",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Content",
                "displayName": "Content",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Excerpt",
                "displayName": "Excerpt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Image Prompt",
                "displayName": "Image Prompt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Featured Image URL",
                "displayName": "Featured Image URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress Post ID",
                "displayName": "WordPress Post ID",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress URL",
                "displayName": "WordPress URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Status",
                "displayName": "Verification Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "Pending",
                    "value": "Pending"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Notes",
                "displayName": "Verification Notes",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Error Log",
                "displayName": "Error Log",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.airtable",
        "typeVersion": 2,
        "position": [
          3472,
          720
        ],
        "id": "9fb718bf-1b03-499f-9e27-35b8e039d3cc",
        "name": "Save Draft & Set Humanizing",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Analyze the following research data and provide a synthesis for blog article writing.\n\n## ARTICLE TOPIC\n{{ $json.articleTitle }}\n\n## PRIMARY KEYWORDS\n{{ $json.primaryKeywords }}\n\n\n## TAVILY WEB RESEARCH\n{{ $json.tavily.results.map(r => `### ${r.title}\\n${r.content}\\nSource: ${r.url}`).join('\\n\\n') }}\n\n## PERPLEXITY DEEP RESEARCH\n{{ $json.perplexity }}\n\n## WIKIPEDIA VERIFIED FACTS\n{{ $json.wikipedia.map(w => `### ${w.title}\\n${w.summary}\\nSource: ${w.url}`).join('\\n\\n') }}\n\n# SOURCE PRIORITIZATION RULES\nYou have access to two data sources: \"Wikipedia\" and \"Perplexity\".\n1. **Definitions & History:** Trust Wikipedia primarily for historical facts, scientific definitions, and established concepts.\n2. **Current Events & Statistics:** Trust Perplexity primarily for recent news, pricing, statistics, software versions, and trends.\n3. **Conflict Resolution:** If specific data points (like dates, numbers, names of officials) differ between sources, AUTOMATICALLY prioritize Perplexity as it is the more up-to-date source.\n4. **Outdated Flag:** If Wikipedia data seems clearly outdated (e.g. mentions \"upcoming 2023 release\" when it is now 2026), ignore it completely.\n\n---\n\n# INSTRUCTIONS FOR OUTPUT\nSynthesize the research into the structured format defined by the attached schema.\n\nIMPORTANT FORMATTING RULES:\n1. **Do NOT use markdown code blocks** (like ```json). Return raw JSON only.\n2. Ensure all fields from the schema are filled.\n3. For \"hidden_insights\", look for unique angles not covered by competitors.\n4. \"search_intent\" must be one of: informational, transactional, commercial, navigational.\n5. All text content must be in **Czech language**.",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an expert content strategist analyzing research data for a Czech technology blog about AI and automation. Synthesize the provided research into actionable writing guidelines. Focus on practical insights for Czech small and medium businesses. CRITICAL: Respond with raw JSON only. Do not wrap the output in markdown code blocks (```json)."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          1952,
          -48
        ],
        "id": "e5881b62-3502-4cf7-b25e-cd096abcd6f7",
        "name": "Research Synthesis Agent"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          1968,
          160
        ],
        "id": "5001870e-408d-4cc4-95e4-65ce234fb597",
        "name": "Google Gemini Chat Model",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          2304,
          944
        ],
        "id": "50299783-2ca6-41cb-9036-423eb6a13a7a",
        "name": "Google Gemini Chat Model1",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Write a complete blog article based on the following specifications.\n\n## TITLE\n{{ $('Title Refinement Agent').item.json.output.revisedTitle }}\n\n## OUTLINE\n{{ $json.output }}\n\n## KEY TAKEAWAYS (Include as a box after intro)\n{{ $('Key Takeaways Agent').item.json.output }}\n\n## KEYWORDS STRATEGY\n**Primary Keyword:** {{ $('Parse Article Data').item.json.primaryKeywords }}\n**SEO Keywords (include naturally):** {{ $('Keyword Strategy Agent').item.json.output.seoKeywords }}\n**Secondary/Context Keywords:** {{ $('Parse Article Data').item.json.secondaryKeywords }}\n\n## RESEARCH & CONTEXT\n\n### Strategic Guidelines (Audience, Tone, Goal):\n{{ JSON.stringify($('Parse Article Data').item.json.research.synthesis || {}) }}\n\n### Deep Research (Perplexity - PRIMARY SOURCE):\n{{ $('Parse Article Data').item.json.research.rawData?.perplexity || 'No deep research available.' }}\n\n### Web Sources (Tavily):\n{{ $('Parse Article Data').item.json.research.rawData?.tavily?.results?.map(r => `- ${r.title}: ${r.content}`).join('\\n') || '' }}\n\n### Verified Facts (Wikipedia):\n{{ $('Parse Article Data').item.json.research.rawData?.wikipedia?.map(w => `- ${w.title}: ${w.summary}`).join('\\n') || '' }}\n\n## TARGET LENGTH\n{{ $('Parse Article Data').item.json.targetLength }} words\n\n---\n\n## INSTRUCTIONS\n\n1. **Structure:** Follow the provided OUTLINE strictly.\n2. **Language:** Write the COMPLETE article in excellent **CZECH language**.\n3. **Formatting:** Use HTML tags: <p>, <h2>, <h3>, <ul>, <li>, <strong>, <a>.\n4. **Forbidden:** DO NOT use <h1> tag (title is handled separately).\n5. **SEO:** Include the provided SEO keywords naturally throughout the text.\n6. **Sources:** Use facts mainly from the **Perplexity** and **Wikipedia** sections. Do not invent data.\n7. **Style:** Write in a natural, human journalistic style (avoid robotic transitions like \"V závěru lze říci\").\n8. **Engagement:** Use varied sentence structure and add practical examples relevant to Czech market.",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an expert Czech technology journalist and copywriter specializing in AI, automation, and digital transformation for SMBs.\n\nFORBIDDEN PHRASES (never use these robotic clichés):\n- \"V dnešní době\", \"V rychle se měnícím světě\", \"Je důležité poznamenat\", \"Závěrem lze říci\"\n- \"Není žádným tajemstvím\", \"Pojďme se podívat\", \"Jak jistě víte\", \"V tomto článku\"\n- Avoid robotic transitions. Go straight to the point.\n\nWRITING RULES:\n1. Language: Write in excellent, natural Czech. Avoid unnecessary anglicisms.\n2. Tone: Professional, authoritative, yet accessible. Write like a human journalist, not AI.\n3. Structure: Vary sentence length. Mix short punchy sentences with longer explanations.\n4. Content: Use concrete examples, numbers, and facts from the provided research.\n5. Integrity: NEVER invent statistics or facts. Use only provided sources.\n6. Grammar: Avoid passive voice. Use active verbs.\n\nHTML FORMATTING RULES:\n- Use tags: <p>, <h2>, <h3>, <ul>, <li>, <strong>, <a>.\n- DO NOT use <h1> (title is handled separately).\n- Do not use markdown (no ## or **). Use HTML tags only inside the content string.\n\nCRITICAL OUTPUT INSTRUCTIONS:\n- You must respond with a VALID JSON object matching the required schema.\n- Do not wrap the output in markdown code blocks (like ```json).\n- Ensure all HTML attributes and text inside the JSON are properly escaped to prevent parsing errors.\n- Return RAW JSON ONLY. No preamble, no postscript."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          2256,
          704
        ],
        "id": "5d7143e0-b9d4-405d-bb51-ee25fd1fa221",
        "name": "Content Writer Agent"
      },
      {
        "parameters": {
          "jsCode": "// Prepare article data for humanization\nconst rawData = $input.first().json;\nconst article = rawData.fields ? rawData.fields : rawData;\n\nreturn {\n  json: {\n    articleId: rawData.id,\n    title: article.Title,\n    content: article.Content || '',\n    excerpt: article.Excerpt || '',\n    slug: article.Slug || '',\n    categories: article.Categories || '',\n    tags: article.Tags || []\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          816,
          1552
        ],
        "id": "fab0e406-a6b5-4c25-8523-0d29f5acb1e2",
        "name": "Prepare for Humanizing"
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {
            "temperature": 0.6
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          864,
          1760
        ],
        "id": "9aea0f5f-5a89-4898-802d-e0675379bc61",
        "name": "Claude (Humanizer)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {
            "temperature": 0.2
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          1344,
          1760
        ],
        "id": "93723a8c-93d3-4f4b-a85d-4cc3b7922ef3",
        "name": "Claude (Verification)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "content": "## BRANCH 3: Humanization & Verification\n\nTriggers when Status = 'Humanizing'\n\n1. Fetch article from Airtable\n2. Humanizer Agent (natural Czech style)\n3. Verification Agent (fact-check)\n4. Save content to Airtable\n5. Update status to 'Review'\n6. Send notification email",
          "height": 280,
          "width": 720,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          560,
          1200
        ],
        "id": "4a20c9ca-58b1-4950-98f8-8dc831367071",
        "name": "Humanization Branch Note1"
      },
      {
        "parameters": {
          "jsCode": "// Prepare article data for WordPress\nconst rawData = $('Fetch Article for Publishing').first().json;\nconst article = rawData.fields ? rawData.fields : rawData;\n\nreturn {\n  json: {\n    articleId: rawData.id,\n    title: article.Title,\n    content: article.Content || '',\n    excerpt: article.Excerpt || '',\n    slug: article.Slug || '',\n    categories: article.Categories || '',\n    tags: article.Tags || [],\n    imagePrompt: article['Image Prompt'] || `Professional blog header image for article about: ${article.Title}`\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          928,
          2336
        ],
        "id": "05a35809-8f40-4e55-8576-7bcb690e7325",
        "name": "Prepare WP Data"
      },
      {
        "parameters": {
          "jsCode": "// Prepare image generation prompt\nconst prepData = $('Prepare WP Data').first().json;\nconst wpPost = $input.first().json;\n\nreturn {\n  json: {\n    ...prepData,\n    wpPostId: wpPost.id,\n    wpPostLink: wpPost.link,\n    imagePrompt: prepData.imagePrompt\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2768,
          2304
        ],
        "id": "4a98e815-3a67-4172-b9eb-de196852db41",
        "name": "Prepare Image Generation"
      },
      {
        "parameters": {
          "content": "## BRANCH 4: WordPress Publishing\n\nTriggers when Status = 'Approved'\n\n1. Fetch article from Airtable\n2. Set status to 'Publishing'\n3. Create WordPress draft post\n4. Generate featured image (Gemini Imagen)\n5. Upload image to WordPress Media\n6. Set featured image on post\n7. Get & assign categories and tags\n8. Update Airtable with WP data\n9. Update status to 'Published'\n10. Send success notification",
          "height": 360,
          "width": 736,
          "color": 2
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          544,
          1936
        ],
        "id": "1126c556-5cc8-4d89-a6a1-71ec58b3ada1",
        "name": "Publishing Branch Note1"
      },
      {
        "parameters": {
          "sendTo": "zmidloch@z-agency.cz",
          "subject": "=✅ Article Published: {{ $json.title }}",
          "message": "=<h2>{{ $json.title }}</h2>\n\n<p>The article has been successfully published to WordPress as a draft.</p>\n\n<p><strong>WordPress Post ID:</strong> {{ $json.wpPostId }}</p>\n\n<p><strong>URL:</strong> <a href=\"https://processgate.ai/{{ $json.slug }}\">https://processgate.ai/{{ $json.slug }}</a></p>\n\n{{ $json.wpMediaUrl ? '<p><strong>Featured Image:</strong> <a href=\"' + $json.wpMediaUrl + '\">View Image</a></p>' : '' }}\n\n<hr>\n\n<p>\n  <a href=\"https://processgate.ai/wp-admin/post.php?post={{ $json.wpPostId }}&action=edit\" \n     style=\"background: #0073aa; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;\">\n     Open in WordPress Admin\n  </a>\n</p>\n\n<p style=\"color: #666; font-size: 12px; margin-top: 20px;\">This email was automatically generated by the Blog Article Generator workflow.</p>",
          "options": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.gmail",
        "typeVersion": 2.1,
        "position": [
          4160,
          2288
        ],
        "id": "974734d4-e43e-47ab-8e28-a1a2f7a53e2b",
        "name": "Send Published Notification1",
        "webhookId": "ed04287a-794d-436b-847f-38af158abf0c",
        "credentials": {
          "gmailOAuth2": {
            "id": "qNSaYVEcaWOf5U3k",
            "name": "Gmail zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// No image available - pass through data\nconst prepData = $('Process Image Response').first().json;\n\nreturn {\n  json: {\n    ...prepData,\n    wpMediaId: null,\n    wpMediaUrl: ''\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3920,
          2544
        ],
        "id": "8e2b728a-9200-451e-b81c-b1e43048da65",
        "name": "No Image Passthrough1"
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {
            "temperature": 0.3
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          1808,
          160
        ],
        "id": "ead49473-96f4-4f3d-afb3-c6f1ae11e41c",
        "name": "Claude 4.5 Sonet (Research)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Based on the following research, generate an SEO-optimized keyword strategy for a Czech blog article.\n\n## ARTICLE TITLE\n{{ $json.title }}\n\n## PRIMARY KEYWORDS\n{{ $json.primaryKeywords }}\n\n## SECONDARY KEYWORDS (Context & Specific topics to cover)\n{{ $('Parse Article Data').item.json.secondaryKeywords }}\n\n## RESEARCH SYNTHESIS\n{{ JSON.stringify($json.research.synthesis || {}) }}\n\n---\n\nGenerate:\n1. 5-8 SEO keywords in CZECH relevant to Czech readers\n2. Suggest 1-3 categories from: Umela inteligence, Automatizace, Digitalni transformace, Produktivita, Nastroje a technologie, Pripadove studie, Novinky z oboru\n3. Suggest 3-5 tags in CZECH\n\nReturn JSON:\n{\n  \"seoKeywords\": [\"keyword1\", \"keyword2\"],\n  \"categories\": [\"Category1\"],\n  \"tags\": [\"tag1\", \"tag2\"]\n}",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an SEO specialist for Czech technology blogs. Generate keywords and taxonomies in Czech language that will resonate with Czech small and medium business owners. Respond ONLY with valid JSON."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          720,
          704
        ],
        "id": "3c29c3e5-5937-48df-8d11-d140eeab96d4",
        "name": "Keyword Strategy Agent"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          768,
          944
        ],
        "id": "e5b6d691-3756-4ccf-9a9b-369c8e8eba16",
        "name": "Google Gemini Chat Model2",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {
            "temperature": 0.4
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          608,
          944
        ],
        "id": "014d53e7-5b44-4b31-91b7-21ace576fb1a",
        "name": "Claude 4.5 Sonet (Keywords)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Refine and optimize the following blog post title for maximum CTR and SEO performance.\n\n## WORKING TITLE\n{{ $('Parse Article Data').item.json.title }}\n\n## PRIMARY KEYWORDS\n{{ $('Parse Article Data').item.json.primaryKeywords }}\n\n## SEO KEYWORDS\n{{ $json.output.seoKeywords.join(', ') }}\n\n## SEARCH INTENT\n{{ $('Parse Article Data').item.json.research.synthesis?.search_intent || 'informational' }}\n\n---\n\nCreate an optimized title that:\n- Is 50-60 characters max\n- Includes primary keyword naturally\n- Is compelling and drives clicks\n- Is in CZECH language\n\nReturn JSON:\n{\n  \"revisedTitle\": \"Optimized Czech title here\",\n  \"reasoning\": \"Brief explanation\"\n}",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an expert high-CTR marketing copywriter specializing in Czech headlines. Create titles that drive clicks while being SEO-friendly. Respond ONLY with valid JSON."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          1120,
          704
        ],
        "id": "ad4be71c-f70f-43b4-8e1f-58b4c950e2c1",
        "name": "Title Refinement Agent"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          1216,
          944
        ],
        "id": "a8825e15-598c-4755-88ea-41d5d8b2e022",
        "name": "Google Gemini Chat Model3",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Create key takeaways for the following article.\n\n## OPTIMIZED TITLE\n{{ $json.output.revisedTitle }}\n\n## PRIMARY KEYWORDS\n{{ $('Parse Article Data').item.json.primaryKeywords }}\n\n## SEO KEYWORDS\n{{ $('Keyword Strategy Agent').item.json.output.seoKeywords }}\n\n## RESEARCH SYNTHESIS\n{{ JSON.stringify($('Parse Article Data').item.json.research.synthesis || {}) }}\n\n---\n\nCreate:\n1. An introductory paragraph (2-3 sentences) that hooks the reader\n2. 6-8 key takeaways as bullet points with bold headings\n3. An outro paragraph that leads into the main content\n\nWrite in CZECH language. Use engaging, action-driven headings.\n\nReturn the key takeaways in Markdown format.",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an expert content strategist creating structured, insightful key takeaways for Czech technology articles. Write in excellent Czech, avoid cliches, use concrete examples."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          1536,
          704
        ],
        "id": "41ef7eb0-9402-45b0-8a2e-59b4cc78062f",
        "name": "Key Takeaways Agent"
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          1504,
          944
        ],
        "id": "261b70b3-3ac9-4d44-9ebb-e5b0a748f704",
        "name": "Claude 4.5 Sonet (Takeaways)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {
            "temperature": 0.5
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          1072,
          944
        ],
        "id": "c15f7382-e24a-4c24-90b9-262c53d2a4db",
        "name": "Claude 4.5 Sonet (Title)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          1664,
          944
        ],
        "id": "6f0b62f8-2851-4676-9cd6-8e26f9882b10",
        "name": "Google Gemini Chat Model4",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Create a detailed article outline for the following topic.\n\n## TITLE\n{{ $('Title Refinement Agent').item.json.output.revisedTitle }}\n\n## KEY TAKEAWAYS\n{{ $json.output }}\n\n## SEO KEYWORDS\n{{ $('Keyword Strategy Agent').item.json.output.seoKeywords }}\n\n## SEMANTIC ANALYSIS\n{{ JSON.stringify($('Parse Article Data').item.json.research.synthesis?.semantic_analysis || {}) }}\n\n## TARGET LENGTH\n{{ $('Parse Article Data').item.json.targetLength }} words\n\n---\n\nCreate a detailed outline with:\n- Main sections (## H2 headings)\n- Subsections (### H3 headings)\n- Brief description of what each section covers\n- Incorporate SEO keywords naturally in headings\n\nFormat in Markdown. Write headings in CZECH.",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an expert content strategist creating detailed article outlines. Structure content for clarity, engagement, and SEO effectiveness. Use Czech language for all headings and descriptions."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          1888,
          704
        ],
        "id": "a86de01e-9e30-4713-96b5-3f8e81c0a3a5",
        "name": "Outline Agent"
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          1824,
          944
        ],
        "id": "9c2d8b34-f3c3-488f-8d87-2abf1352e731",
        "name": "Claude 4.5 Sonet (Outline)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          1984,
          944
        ],
        "id": "51d57d7a-b611-491a-8d76-ed0ecfeaaa29",
        "name": "Google Gemini Chat Model5",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {
            "temperature": 0.7
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          2144,
          944
        ],
        "id": "2e844d40-51dc-485c-8434-7078963fc0d0",
        "name": "Calude 4.5 Sonet (Writer)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Compress the following article to fit within {{ $json.limit }} words while preserving meaning and value.\n\nCurrent word count: {{ $json.wordCount }}\nTarget: {{ $json.limit }} words\n\n## CONTENT TO COMPRESS:\n{{ $json.content }}\n\n---\n\nReduce word count by:\n1. Removing redundant sentences\n2. Shortening overly long explanations\n3. Eliminating filler phrases\n4. Combining similar points\n\nPreserve:\n- All key information\n- HTML formatting\n- Natural flow\n- Czech language quality\n\nReturn ONLY the compressed HTML content.",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an expert editor compressing long-form content while preserving meaning, tone, and value. Output only the compressed HTML content in Czech."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          2992,
          848
        ],
        "id": "61298a35-8c84-47e7-ad52-591f1cc5a410",
        "name": "Compression Agent"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          3024,
          1056
        ],
        "id": "40de078a-1d0e-495e-b78a-99390eb75c95",
        "name": "Google Gemini Chat Model6",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          2848,
          1056
        ],
        "id": "1d759de3-0692-4878-a6ad-ce13dc0325da",
        "name": "Claude 4.5 Sonet (Compress)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Humanize the following article content to make it sound more natural and engaging in Czech.\n\n## TITLE\n{{ $json.title }}\n\n## CONTENT\n{{ $json.content }}\n\n---\n\nGuidelines:\n- Make the text flow naturally as if written by a native Czech speaker\n- Avoid robotic or overly formal language\n- Keep the factual accuracy intact\n- Maintain the structure (headings, lists)\n- Add transitional phrases where needed\n- Use varied sentence lengths\n- Keep technical terms accurate\n\nReturn the humanized content in HTML format (same structure as input).",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an expert Czech copywriter who specializes in making AI-generated content sound natural and human. You maintain accuracy while improving readability and engagement."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          992,
          1552
        ],
        "id": "30f28311-88a9-4b4b-81ff-ae3bbad81ab0",
        "name": "Humanizer Agent"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          1040,
          1760
        ],
        "id": "08cd8227-6b79-449a-8cd7-c99edecc250d",
        "name": "Google Gemini Chat Model7",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Verify the following article for factual accuracy and identify any claims that need sources.\n\n## TITLE\n{{ $json.title }}\n\n## CONTENT\n{{ $json.humanizedContent }}\n\n---\n\nCheck for:\n1. Factual claims that need verification\n2. Statistics or numbers that should have sources\n3. Outdated information\n4. Potential inaccuracies\n5. Missing context\n\nReturn JSON:\n{\n  \"verified\": true/false,\n  \"verificationNotes\": \"Summary of verification\",\n  \"verificationIssues\": [\"issue1\", \"issue2\"]\n}",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "You are a fact-checker for Czech technology articles. Identify claims that need verification and flag potential inaccuracies. Be thorough but practical."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          1504,
          1552
        ],
        "id": "e000f87d-142f-477a-8e89-4345c51edef2",
        "name": "Verification Agent"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          1536,
          1760
        ],
        "id": "8853294c-6f6c-441b-ab95-b13ba0872ce0",
        "name": "Google Gemini Chat Model8",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"verified\", \"verificationNotes\"],\n  \"properties\": {\n    \"verified\": { \"type\": \"boolean\" },\n    \"verificationNotes\": { \"type\": \"string\" },\n    \"verificationIssues\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          1712,
          1760
        ],
        "id": "465fcc16-0701-43b7-b31e-80b1d96f6595",
        "name": "Verification Parser"
      },
      {
        "parameters": {
          "jsCode": "// Prepare final data for saving\nconst prepData = $('Prepare for Verification').first().json;\nconst verificationOutput = $input.first().json.output || $input.first().json;\n\nreturn {\n  json: {\n    articleId: prepData.articleId,\n    title: prepData.title,\n    content: prepData.humanizedContent,\n    excerpt: prepData.excerpt,\n    slug: prepData.slug,\n    verified: verificationOutput.verified || false,\n    verificationNotes: verificationOutput.verificationNotes || '',\n    verificationIssues: verificationOutput.verificationIssues || []\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1888,
          1552
        ],
        "id": "649278ba-9769-4949-80d2-729bdfb0675f",
        "name": "Prepare Final Content"
      },
      {
        "parameters": {
          "jsCode": "// Prepare humanized content for verification\nconst prepData = $('Prepare for Humanizing').first().json;\nconst humanizedContent = $input.first().json.output || $input.first().json.text || '';\n\nreturn {\n  json: {\n    ...prepData,\n    humanizedContent: humanizedContent\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1280,
          1552
        ],
        "id": "f5bbe3d6-5c6d-4c51-9790-bf7b72a9a1ec",
        "name": "Prepare for Verification"
      },
      {
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "url",
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z"
          },
          "table": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "id": "={{ $('Airtable Status Change').item.json.id }}",
          "options": {}
        },
        "type": "n8n-nodes-base.airtable",
        "typeVersion": 2,
        "position": [
          608,
          1552
        ],
        "id": "8c319965-bc63-47d4-ab20-c676a2b9c4fb",
        "name": "Fetch Article for Humanizing",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "sendTo": "zmidloch@z-agency.cz",
          "subject": "={{ $json.verified ? '✅' : '⚠️' }} New article for review: {{ $json.fields.Title }}",
          "message": "=<h2 style=\"color: #d32f2f;\">⚠️ Review Required: {{ $json.fields.Title }}</h2>\n\n<p>The automated verification process flagged potential issues with this article.</p>\n\n<div style=\"background-color: #ffebee; border-left: 5px solid #d32f2f; padding: 15px; margin: 15px 0;\">\n    <h3 style=\"margin-top: 0; color: #d32f2f;\">Issues Found:</h3>\n    <p style=\"white-space: pre-wrap;\">{{ $json.fields['Verification Notes'] || 'No specific notes provided.' }}</p>\n</div>\n\n<hr>\n\n<h3>Article Details:</h3>\n<ul>\n    <li><strong>Status:</strong> {{ $json.fields['Verification Status'] }}</li>\n    <li><strong>Excerpt:</strong> {{ $json.fields.Excerpt }}</li>\n    <li><strong>Target Length:</strong> {{ $json.fields['Target Length'] }} words</li>\n</ul>\n\n<p>Please open Airtable to review the full content and address these issues manually.</p>\n\n<p style=\"text-align: center;\">\n    <a href=\"{{ $json.fields['Airtable Record URL'] || 'https://airtable.com' }}\" style=\"background-color: #2962ff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Open in Airtable</a>\n</p>\n\n<p style=\"color: #999; font-size: 12px; margin-top: 30px;\">Generated by Blog Article Generator Workflow</p>",
          "options": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.gmail",
        "typeVersion": 2.1,
        "position": [
          2304,
          1552
        ],
        "id": "bc587896-3530-4f37-878e-25a9eb17bac4",
        "name": "Send Review Notification",
        "webhookId": "1f24e0c9-98ca-4c2f-8815-26dea658036e",
        "credentials": {
          "gmailOAuth2": {
            "id": "qNSaYVEcaWOf5U3k",
            "name": "Gmail zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "base": {
            "__rl": true,
            "mode": "url",
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z"
          },
          "table": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "id": "={{ $json.articleId }}",
              "Status": "Approved",
              "Content": "={{ $json.content }}",
              "Verification Status": "={{ $json.verified ? 'Passed' : 'Issues Found' }}",
              "Verification Notes": "={{ $json.verificationNotes }}"
            },
            "matchingColumns": [
              "id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "readOnly": true
              },
              {
                "id": "Title",
                "displayName": "Title",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Primary Keywords",
                "displayName": "Primary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Secondary Keywords",
                "displayName": "Secondary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Target Length",
                "displayName": "Target Length",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Status",
                "displayName": "Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "New",
                    "value": "New"
                  },
                  {
                    "name": "Researching",
                    "value": "Researching"
                  },
                  {
                    "name": "Writing",
                    "value": "Writing"
                  },
                  {
                    "name": "Humanizing",
                    "value": "Humanizing"
                  },
                  {
                    "name": "Review",
                    "value": "Review"
                  },
                  {
                    "name": "Approved",
                    "value": "Approved"
                  },
                  {
                    "name": "Publishing",
                    "value": "Publishing"
                  },
                  {
                    "name": "Published",
                    "value": "Published"
                  },
                  {
                    "name": "Failed",
                    "value": "Failed"
                  }
                ],
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Last Modified",
                "displayName": "Last Modified",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": true,
                "removed": true
              },
              {
                "id": "Research Data",
                "displayName": "Research Data",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Slug",
                "displayName": "Slug",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Excerpt",
                "displayName": "Excerpt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Content",
                "displayName": "Content",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Image Prompt",
                "displayName": "Image Prompt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Status",
                "displayName": "Verification Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "Pending",
                    "value": "Pending"
                  },
                  {
                    "name": "Passed",
                    "value": "Passed"
                  },
                  {
                    "name": "Issues Found",
                    "value": "Issues Found"
                  }
                ],
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Verification Notes",
                "displayName": "Verification Notes",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Categories",
                "displayName": "Categories",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Tags",
                "displayName": "Tags",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "array",
                "options": [
                  {
                    "name": "AI",
                    "value": "AI"
                  },
                  {
                    "name": "SMB",
                    "value": "SMB"
                  },
                  {
                    "name": "transformace",
                    "value": "transformace"
                  },
                  {
                    "name": "marketing",
                    "value": "marketing"
                  },
                  {
                    "name": "nástroje",
                    "value": "nástroje"
                  },
                  {
                    "name": "automatizace",
                    "value": "automatizace"
                  },
                  {
                    "name": "case study",
                    "value": "case study"
                  },
                  {
                    "name": "výroba",
                    "value": "výroba"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Featured Image URL",
                "displayName": "Featured Image URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress Post ID",
                "displayName": "WordPress Post ID",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress URL",
                "displayName": "WordPress URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Error Log",
                "displayName": "Error Log",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.airtable",
        "typeVersion": 2,
        "position": [
          2096,
          1552
        ],
        "id": "8d977891-3461-4f96-ba96-0c01499ea1e2",
        "name": "Save Final & Set Review",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "base": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "table": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "id": "={{ $('Airtable Status Change').item.json.id }}",
          "options": {}
        },
        "type": "n8n-nodes-base.airtable",
        "typeVersion": 2,
        "position": [
          560,
          2336
        ],
        "id": "c7271c46-10d7-4cee-a83d-3d5e3f1cf27e",
        "name": "Fetch Article for Publishing",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "base": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "table": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "id": "={{ $json.id }}",
              "Status": "Publishing"
            },
            "matchingColumns": [
              "id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "readOnly": true
              },
              {
                "id": "Title",
                "displayName": "Title",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Primary Keywords",
                "displayName": "Primary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Secondary Keywords",
                "displayName": "Secondary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Target Length",
                "displayName": "Target Length",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Status",
                "displayName": "Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "New",
                    "value": "New"
                  },
                  {
                    "name": "Researching",
                    "value": "Researching"
                  },
                  {
                    "name": "Writing",
                    "value": "Writing"
                  },
                  {
                    "name": "Humanizing",
                    "value": "Humanizing"
                  },
                  {
                    "name": "Review",
                    "value": "Review"
                  },
                  {
                    "name": "Approved",
                    "value": "Approved"
                  },
                  {
                    "name": "Publishing",
                    "value": "Publishing"
                  },
                  {
                    "name": "Published",
                    "value": "Published"
                  },
                  {
                    "name": "Failed",
                    "value": "Failed"
                  }
                ],
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Last Modified",
                "displayName": "Last Modified",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": true,
                "removed": true
              },
              {
                "id": "Research Data",
                "displayName": "Research Data",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Slug",
                "displayName": "Slug",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Excerpt",
                "displayName": "Excerpt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Content",
                "displayName": "Content",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Image Prompt",
                "displayName": "Image Prompt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Status",
                "displayName": "Verification Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "Pending",
                    "value": "Pending"
                  },
                  {
                    "name": "Passed",
                    "value": "Passed"
                  },
                  {
                    "name": "Issues Found",
                    "value": "Issues Found"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Notes",
                "displayName": "Verification Notes",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Categories",
                "displayName": "Categories",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Tags",
                "displayName": "Tags",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "array",
                "options": [
                  {
                    "name": "AI",
                    "value": "AI"
                  },
                  {
                    "name": "SMB",
                    "value": "SMB"
                  },
                  {
                    "name": "transformace",
                    "value": "transformace"
                  },
                  {
                    "name": "marketing",
                    "value": "marketing"
                  },
                  {
                    "name": "nástroje",
                    "value": "nástroje"
                  },
                  {
                    "name": "automatizace",
                    "value": "automatizace"
                  },
                  {
                    "name": "case study",
                    "value": "case study"
                  },
                  {
                    "name": "výroba",
                    "value": "výroba"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Featured Image URL",
                "displayName": "Featured Image URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress Post ID",
                "displayName": "WordPress Post ID",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress URL",
                "displayName": "WordPress URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Error Log",
                "displayName": "Error Log",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.airtable",
        "typeVersion": 2,
        "position": [
          736,
          2336
        ],
        "id": "f7a2eb7e-881d-49e2-b32a-033a1a1ec8b0",
        "name": "Set Status: Publishing",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "url": "https://processgate.ai/wp-json/wp/v2/categories",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "per_page",
                "value": "100"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          1392,
          2192
        ],
        "id": "51562bca-67b8-48cb-a04e-7cbc8be0ca76",
        "name": "Get WP Categories",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "url": "https://processgate.ai/wp-json/wp/v2/tags",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "per_page",
                "value": "100"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          1392,
          2448
        ],
        "id": "280bd4ab-f1f2-4398-bf9b-5305abddff59",
        "name": "Get WP Tags",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "base": {
            "__rl": true,
            "mode": "url",
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z"
          },
          "table": {
            "__rl": true,
            "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
            "mode": "url"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "id": "={{ $json.articleId }}",
              "Status": "Published",
              "WordPress Post ID": "={{ parseInt($json.wpPostId) }}",
              "WordPress URL": "={{ $json.wpUrl }}",
              "Categories": "={{ $json.categoryNames }}",
              "Tags": "={{ $json.tagNames }}"
            },
            "matchingColumns": [
              "id"
            ],
            "schema": [
              {
                "id": "id",
                "displayName": "id",
                "required": false,
                "defaultMatch": true,
                "display": true,
                "type": "string",
                "readOnly": true
              },
              {
                "id": "Title",
                "displayName": "Title",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Primary Keywords",
                "displayName": "Primary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Secondary Keywords",
                "displayName": "Secondary Keywords",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Target Length",
                "displayName": "Target Length",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Status",
                "displayName": "Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "New",
                    "value": "New"
                  },
                  {
                    "name": "Researching",
                    "value": "Researching"
                  },
                  {
                    "name": "Writing",
                    "value": "Writing"
                  },
                  {
                    "name": "Humanizing",
                    "value": "Humanizing"
                  },
                  {
                    "name": "Review",
                    "value": "Review"
                  },
                  {
                    "name": "Approved",
                    "value": "Approved"
                  },
                  {
                    "name": "Publishing",
                    "value": "Publishing"
                  },
                  {
                    "name": "Published",
                    "value": "Published"
                  },
                  {
                    "name": "Failed",
                    "value": "Failed"
                  }
                ],
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Last Modified",
                "displayName": "Last Modified",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": true,
                "removed": true
              },
              {
                "id": "Research Data",
                "displayName": "Research Data",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Slug",
                "displayName": "Slug",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Excerpt",
                "displayName": "Excerpt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Content",
                "displayName": "Content",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Image Prompt",
                "displayName": "Image Prompt",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Status",
                "displayName": "Verification Status",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "options",
                "options": [
                  {
                    "name": "Pending",
                    "value": "Pending"
                  },
                  {
                    "name": "Passed",
                    "value": "Passed"
                  },
                  {
                    "name": "Issues Found",
                    "value": "Issues Found"
                  }
                ],
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Verification Notes",
                "displayName": "Verification Notes",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "Categories",
                "displayName": "Categories",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Tags",
                "displayName": "Tags",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Featured Image URL",
                "displayName": "Featured Image URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              },
              {
                "id": "WordPress Post ID",
                "displayName": "WordPress Post ID",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "WordPress URL",
                "displayName": "WordPress URL",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Error Log",
                "displayName": "Error Log",
                "required": false,
                "defaultMatch": false,
                "canBeUsedToMatch": true,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.airtable",
        "typeVersion": 2,
        "position": [
          2560,
          2304
        ],
        "id": "a5b33464-b5f9-4914-aa7d-30cc5b79b942",
        "name": "Update Published Status",
        "credentials": {
          "airtableTokenApi": {
            "id": "112UtIzO07XgrN7A",
            "name": "Airtable - zmidloch@z-agency.cz"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Prepare context for the Taxonomy Agent\n// We need to merge the WP Post ID with the list of available categories and tags\n\n// FIXED: Removed \"- old\" from the node name\nconst wpPost = $('Create WordPress Post').first().json;\nconst article = $('Prepare WP Data').first().json;\n\n// Create readable lists for the AI\nconst categoriesList = $('Get WP Categories').all().map(item => \n  `ID ${item.json.id}: ${item.json.name} (Slug: ${item.json.slug})`\n).join('\\n');\n\nconst tagsList = $('Get WP Tags').all().map(item => \n  `ID ${item.json.id}: ${item.json.name}`\n).join('\\n');\n\nreturn {\n  json: {\n    wpPostId: wpPost.id,\n    wpPostLink: wpPost.link,\n    title: article.title,\n    excerpt: article.excerpt,\n    categoriesList: categoriesList,\n    tagsList: tagsList\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1616,
          2304
        ],
        "id": "ae2bbedc-260f-4bcf-b989-e4a5a409fb2c",
        "name": "Prepare Context for AI"
      },
      {
        "parameters": {
          "model": "anthropic/claude-sonnet-4.5",
          "options": {
            "temperature": 0
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          1696,
          2528
        ],
        "id": "7d5c0b60-3b8e-4d5a-8c5b-5ab5f5a3c3c2",
        "name": "Claude 4.5 (Taxonomy)",
        "credentials": {
          "openRouterApi": {
            "id": "XpZg3NCm0vRTBA75",
            "name": "OpenRouter Z-AGENCY 2026"
          }
        }
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"categoryIds\", \"tagIds\"],\n  \"properties\": {\n    \"categoryIds\": {\n      \"type\": \"array\",\n      \"items\": { \"type\": \"number\" }\n    },\n    \"tagIds\": {\n      \"type\": \"array\",\n      \"items\": { \"type\": \"number\" }\n    }\n  }\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          2064,
          2528
        ],
        "id": "a2ce660a-a793-4bfe-a619-b5c0728beea1",
        "name": "Taxonomy Parser"
      },
      {
        "parameters": {
          "jsCode": "// Prepare final data for Airtable update\nconst classifierData = $('Taxonomy Classifier Agent').first().json.output;\nconst contextData = $('Prepare Context for AI').first().json;\n// Načteme původní data článku (Title, Slug, Excerpt...)\nconst originalArticle = $('Prepare WP Data').first().json;\n\n// Funkce pro získání názvů (bez uvozovek a balastu)\nconst getNames = (ids, sourceNodeName) => {\n  if (!ids || !Array.isArray(ids) || ids.length === 0) return [];\n  \n  const allItems = $(sourceNodeName).all();\n  \n  const names = ids.map(id => {\n    const foundItem = allItems.find(item => item.json.id === id);\n    if (!foundItem || !foundItem.json.name) return null;\n    \n    let name = String(foundItem.json.name);\n    name = name.replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\n    name = name.replace(/['\"]/g, ''); \n    return name.trim();\n  }).filter(name => name !== null && name !== '');\n\n  return names;\n};\n\nconst catArray = getNames(classifierData.categoryIds, 'Get WP Categories');\nconst tagArray = getNames(classifierData.tagIds, 'Get WP Tags');\n\nreturn {\n  json: {\n    // 1. Přenášíme původní metadata (TOHLE CHYBĚLO)\n    title: originalArticle.title,\n    slug: originalArticle.slug,\n    excerpt: originalArticle.excerpt,\n    \n    // 2. Data pro WordPress (IDčka)\n    categoryIds: classifierData.categoryIds,\n    tagIds: classifierData.tagIds,\n    \n    // 3. Data pro Airtable (Texty)\n    categoryNames: catArray.join(', '),\n    tagNames: tagArray.join(', '),\n    \n    // 4. Systémová data\n    wpPostId: contextData.wpPostId,\n    wpUrl: contextData.wpPostLink,\n    articleId: originalArticle.articleId\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2352,
          2304
        ],
        "id": "2d897fa4-a8cf-4165-bf0a-4164505d3077",
        "name": "Prepare Final WP Data"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Classify the following article based on the available taxonomy lists provided below.\n\n## ARTICLE DATA\nTitle: {{ $json.title }}\nExcerpt: {{ $json.excerpt }}\n\n## REFERENCE LIST: CATEGORIES (Format: \"ID: Name\")\n{{ $json.categoriesList }}\n\n## REFERENCE LIST: TAGS (Format: \"ID: Name\")\n{{ $json.tagsList }}\n\n---\n\nTASK:\n1. Identify 1-2 most relevant Category IDs from the list above.\n2. Identify 3-5 most relevant Tag IDs from the list above.\n\nRESPONSE FORMAT:\n{\n  \"categoryIds\": [1, 2],\n  \"tagIds\": [10, 20, 30]\n}",
          "hasOutputParser": true,
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an expert AI classifier for WordPress content. Your job is to analyze article metadata and map it to existing taxonomy IDs.\n\nCRITICAL RULES:\n1. You act as a filter/mapper. You do NOT generate content.\n2. You must Output ONLY valid JSON. No markdown, no conversational text.\n3. You must use ONLY the IDs provided in the lists. NEVER invent new categories or tags.\n4. If no tag fits, return an empty array for tags.\n5. Accuracy is key. Do not hallucinate IDs that are not in the provided list."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          1776,
          2304
        ],
        "id": "a5b661be-8894-4e92-8694-e27938482acc",
        "name": "Taxonomy Classifier Agent"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.5-pro",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          1856,
          2528
        ],
        "id": "789b8938-ea14-4993-812e-2eae7dc07d9c",
        "name": "Google Gemini Chat Model9",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "=https://processgate.ai/wp-json/wp/v2/posts/{{ $('Prepare Context for AI').item.json.wpPostId }}",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"categories\": {{ JSON.stringify($json.output.categoryIds) }},\n  \"tags\": {{ JSON.stringify($json.output.tagIds) }}\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          2144,
          2304
        ],
        "id": "0de96a80-fe83-4907-85bc-167c44ec76a1",
        "name": "Assign Categories & Tags",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://processgate.ai/wp-json/wp/v2/posts",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"title\": \"{{ $json.title }}\",\n  \"content\": {{ JSON.stringify($json.content) }},\n  \"slug\": \"{{ $json.slug }}\",\n  \"status\": \"draft\",\n  \"lang\": \"{{ $json.wpLang }}\" \n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          1152,
          2336
        ],
        "id": "79c791f4-662e-4a29-9dd6-2248dc28385b",
        "name": "Create WordPress Post",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "resource": "image",
          "modelId": {
            "__rl": true,
            "value": "models/gemini-3-pro-image-preview",
            "mode": "list",
            "cachedResultName": "models/gemini-3-pro-image-preview (Nano Banana Pro)"
          },
          "prompt": "={\n  \"instances\": [\n    {\n      \"prompt\": \"{{ $json.imagePrompt.replace(/[\\r\\n]+/g, ' ').replace(/\"/g, '\\\\\"') }}, professional, modern tech style, no text, high quality, 16:9 aspect ratio, clean design, business appropriate\"\n    }\n  ],\n  \"parameters\": {\n    \"sampleCount\": 1,\n    \"aspectRatio\": \"16:9\"\n  }\n}",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.googleGemini",
        "typeVersion": 1.1,
        "position": [
          2960,
          2304
        ],
        "id": "0bb184a6-0da4-4129-a582-a075fdb7b036",
        "name": "Generate an image",
        "credentials": {
          "googlePalmApi": {
            "id": "uLXCpqN3fa4ZXZmj",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Extract image from Gemini Imagen response and prepare for WordPress upload\n\n// 1. DŮLEŽITÁ ZMĚNA:\n// Načítáme data z uzlu \"Prepare Final WP Data\", protože ten obsahuje wpPostId i slug.\nlet prepData = {};\ntry {\n    prepData = $('Prepare Final WP Data').first().json;\n} catch (error) {\n    console.log(\"Uzel Prepare Final WP Data nebyl nalezen, data mohou chybět.\");\n}\n\nconst inputItem = $input.first();\n\nlet hasImage = false;\nlet imageBase64 = '';\nlet binaryOutput = undefined;\n\n// Zpracování binárních dat (obrázku)\nif (inputItem.binary) {\n    const binaryKeys = Object.keys(inputItem.binary);\n    if (binaryKeys.length > 0) {\n        hasImage = true;\n        const key = binaryKeys[0];\n        const binaryObject = inputItem.binary[key];\n        \n        // Připravíme binární výstup\n        binaryOutput = {\n            data: binaryObject\n        };\n    }\n}\n\n// Vytvoříme název souboru\nconst slug = prepData.slug || 'article'; // Slug už máme z Prepare Final WP Data\nconst filename = `${slug}-featured.png`;\n\nif (binaryOutput && binaryOutput.data) {\n    binaryOutput.data.fileName = filename;\n}\n\nreturn {\n  json: {\n    // 2. Tímto předáme dál VŠECHNA data (wpPostId, title, url...)\n    ...prepData,\n    \n    // A přidáme info o obrázku\n    hasImage: hasImage,\n    filename: filename\n  },\n  binary: binaryOutput\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3168,
          2304
        ],
        "id": "a0efbd02-4385-436d-9375-b85261c35405",
        "name": "Process Image Response"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "has-image-check",
                "leftValue": "={{ $json.hasImage }}",
                "rightValue": true,
                "operator": {
                  "type": "boolean",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3376,
          2304
        ],
        "id": "f71710a9-ccc7-4534-b9a2-7d687553379c",
        "name": "Has Image?"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://processgate.ai/wp-json/wp/v2/media",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "wordpressApi",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Disposition",
                "value": "=attachment; filename=\"{{ $json.filename }}\""
              },
              {
                "name": "Content-Type",
                "value": "image/png"
              }
            ]
          },
          "sendBody": true,
          "contentType": "binaryData",
          "inputDataFieldName": "data",
          "options": {
            "timeout": 30000
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3728,
          2288
        ],
        "id": "6dbb5370-7b7b-40fb-bb35-46034badd4a0",
        "name": "Upload Image to WordPress",
        "credentials": {
          "wordpressApi": {
            "id": "flqY5YMCvIpv5fpx",
            "name": "Processgate.ai_propojeni"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Prepare data after image upload\nconst uploadResponse = $input.first().json;\nconst prepData = $('Process Image Response').first().json;\n\nreturn {\n  json: {\n    ...prepData,\n    wpMediaId: uploadResponse.id,\n    wpMediaUrl: uploadResponse.source_url || uploadResponse.guid?.rendered || ''\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3920,
          2288
        ],
        "id": "fae6a6c5-edab-4b09-8276-9d5a5f5ffee5",
        "name": "Set Image Data"
      }
    ],
    "connections": {
      "Airtable Status Change": {
        "main": [
          [
            {
              "node": "Route by Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Route by Status": {
        "main": [
          [
            {
              "node": "Set Status: Researching",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Fetch Article for Writing",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Fetch Article for Humanizing",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Fetch Article for Publishing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Status: Researching": {
        "main": [
          [
            {
              "node": "Tavily Research",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tavily Research": {
        "main": [
          [
            {
              "node": "Perplexity Deep Research",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Perplexity Deep Research": {
        "main": [
          [
            {
              "node": "Prepare Wikipedia Terms",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Wikipedia Terms": {
        "main": [
          [
            {
              "node": "Loop Wiki Terms",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Wiki Terms": {
        "main": [
          [
            {
              "node": "Aggregate Research Data",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wikipedia Lookup",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wikipedia Lookup": {
        "main": [
          [
            {
              "node": "Loop Wiki Terms",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate Research Data": {
        "main": [
          [
            {
              "node": "Research Synthesis Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Research for Save": {
        "main": [
          [
            {
              "node": "Save Research & Set Writing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Article for Writing": {
        "main": [
          [
            {
              "node": "Parse Article Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Article Data": {
        "main": [
          [
            {
              "node": "Keyword Strategy Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Word Count Check": {
        "main": [
          [
            {
              "node": "Over Word Limit?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Over Word Limit?": {
        "main": [
          [
            {
              "node": "Compression Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Save Draft & Set Humanizing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Compressed": {
        "main": [
          [
            {
              "node": "Save Draft & Set Humanizing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Research Synthesis Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Research Synthesis Agent": {
        "main": [
          [
            {
              "node": "Prepare Research for Save",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Research Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Research Synthesis Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Keywords Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Keyword Strategy Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Title Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Title Refinement Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Content Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Content Writer Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Save Draft & Set Humanizing": {
        "main": [
          []
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Content Writer Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Content Writer Agent": {
        "main": [
          [
            {
              "node": "Word Count Check",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare for Humanizing": {
        "main": [
          [
            {
              "node": "Humanizer Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Claude (Humanizer)": {
        "ai_languageModel": [
          [
            {
              "node": "Humanizer Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Claude (Verification)": {
        "ai_languageModel": [
          [
            {
              "node": "Verification Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Prepare WP Data": {
        "main": [
          [
            {
              "node": "Create WordPress Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Image Generation": {
        "main": [
          [
            {
              "node": "Generate an image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "No Image Passthrough1": {
        "main": [
          [
            {
              "node": "Send Published Notification1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Claude 4.5 Sonet (Research)": {
        "ai_languageModel": [
          [
            {
              "node": "Research Synthesis Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Keyword Strategy Agent": {
        "main": [
          [
            {
              "node": "Title Refinement Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Keyword Strategy Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Claude 4.5 Sonet (Keywords)": {
        "ai_languageModel": [
          [
            {
              "node": "Keyword Strategy Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "Title Refinement Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Title Refinement Agent": {
        "main": [
          [
            {
              "node": "Key Takeaways Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Claude 4.5 Sonet (Takeaways)": {
        "ai_languageModel": [
          [
            {
              "node": "Key Takeaways Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Claude 4.5 Sonet (Title)": {
        "ai_languageModel": [
          [
            {
              "node": "Title Refinement Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "Key Takeaways Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Key Takeaways Agent": {
        "main": [
          [
            {
              "node": "Outline Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Claude 4.5 Sonet (Outline)": {
        "ai_languageModel": [
          [
            {
              "node": "Outline Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "Outline Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Outline Agent": {
        "main": [
          [
            {
              "node": "Content Writer Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Calude 4.5 Sonet (Writer)": {
        "ai_languageModel": [
          [
            {
              "node": "Content Writer Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Compression Agent": {
        "main": [
          [
            {
              "node": "Merge Compressed",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model6": {
        "ai_languageModel": [
          [
            {
              "node": "Compression Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Claude 4.5 Sonet (Compress)": {
        "ai_languageModel": [
          [
            {
              "node": "Compression Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Humanizer Agent": {
        "main": [
          [
            {
              "node": "Prepare for Verification",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model7": {
        "ai_languageModel": [
          [
            {
              "node": "Humanizer Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Verification Agent": {
        "main": [
          [
            {
              "node": "Prepare Final Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model8": {
        "ai_languageModel": [
          [
            {
              "node": "Verification Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Verification Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Verification Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Final Content": {
        "main": [
          [
            {
              "node": "Save Final & Set Review",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare for Verification": {
        "main": [
          [
            {
              "node": "Verification Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Article for Humanizing": {
        "main": [
          [
            {
              "node": "Prepare for Humanizing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Final & Set Review": {
        "main": [
          [
            {
              "node": "Send Review Notification",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Article for Publishing": {
        "main": [
          [
            {
              "node": "Set Status: Publishing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Status: Publishing": {
        "main": [
          [
            {
              "node": "Prepare WP Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get WP Categories": {
        "main": [
          [
            {
              "node": "Prepare Context for AI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get WP Tags": {
        "main": [
          [
            {
              "node": "Prepare Context for AI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Published Status": {
        "main": [
          [
            {
              "node": "Prepare Image Generation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Context for AI": {
        "main": [
          [
            {
              "node": "Taxonomy Classifier Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Claude 4.5 (Taxonomy)": {
        "ai_languageModel": [
          [
            {
              "node": "Taxonomy Classifier Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Taxonomy Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Taxonomy Classifier Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Final WP Data": {
        "main": [
          [
            {
              "node": "Update Published Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Taxonomy Classifier Agent": {
        "main": [
          [
            {
              "node": "Assign Categories & Tags",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model9": {
        "ai_languageModel": [
          [
            {
              "node": "Taxonomy Classifier Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Assign Categories & Tags": {
        "main": [
          [
            {
              "node": "Prepare Final WP Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create WordPress Post": {
        "main": [
          [
            {
              "node": "Get WP Categories",
              "type": "main",
              "index": 0
            },
            {
              "node": "Get WP Tags",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate an image": {
        "main": [
          [
            {
              "node": "Process Image Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Process Image Response": {
        "main": [
          [
            {
              "node": "Has Image?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Has Image?": {
        "main": [
          [
            {
              "node": "Upload Image to WordPress",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "No Image Passthrough1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Image to WordPress": {
        "main": [
          [
            {
              "node": "Set Image Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Image Data": {
        "main": [
          [
            {
              "node": "Send Published Notification1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Jiri Zmidloch",
    "name": "Version dd39f393",
    "description": "",
    "autosaved": false
  },
  "activeVersionId": "dd39f393-5cd5-4ac9-89f2-14a8ea1090c9",
  "connections": {
    "Airtable Status Change": {
      "main": [
        [
          {
            "node": "Route by Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Route by Status": {
      "main": [
        [
          {
            "node": "Set Status: Researching",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fetch Article for Writing",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fetch Article for Humanizing",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fetch Article for Publishing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Status: Researching": {
      "main": [
        [
          {
            "node": "Tavily Research",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Tavily Research": {
      "main": [
        [
          {
            "node": "Perplexity Deep Research",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Perplexity Deep Research": {
      "main": [
        [
          {
            "node": "Prepare Wikipedia Terms",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Wikipedia Terms": {
      "main": [
        [
          {
            "node": "Loop Wiki Terms",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Wiki Terms": {
      "main": [
        [
          {
            "node": "Aggregate Research Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wikipedia Lookup",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wikipedia Lookup": {
      "main": [
        [
          {
            "node": "Loop Wiki Terms",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate Research Data": {
      "main": [
        [
          {
            "node": "Research Synthesis Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Research for Save": {
      "main": [
        [
          {
            "node": "Save Research & Set Writing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Article for Writing": {
      "main": [
        [
          {
            "node": "Parse Article Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Article Data": {
      "main": [
        [
          {
            "node": "Keyword Strategy Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Word Count Check": {
      "main": [
        [
          {
            "node": "Over Word Limit?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Over Word Limit?": {
      "main": [
        [
          {
            "node": "Compression Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Save Draft & Set Humanizing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Compressed": {
      "main": [
        [
          {
            "node": "Save Draft & Set Humanizing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Research Synthesis Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Research Synthesis Agent": {
      "main": [
        [
          {
            "node": "Prepare Research for Save",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Research Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Research Synthesis Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Keywords Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Keyword Strategy Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Title Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Title Refinement Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Content Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Content Writer Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Save Draft & Set Humanizing": {
      "main": [
        []
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Content Writer Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Content Writer Agent": {
      "main": [
        [
          {
            "node": "Word Count Check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare for Humanizing": {
      "main": [
        [
          {
            "node": "Humanizer Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude (Humanizer)": {
      "ai_languageModel": [
        [
          {
            "node": "Humanizer Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Claude (Verification)": {
      "ai_languageModel": [
        [
          {
            "node": "Verification Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Prepare WP Data": {
      "main": [
        [
          {
            "node": "Create WordPress Post",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Image Generation": {
      "main": [
        [
          {
            "node": "Generate an image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No Image Passthrough1": {
      "main": [
        [
          {
            "node": "Send Published Notification1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude 4.5 Sonet (Research)": {
      "ai_languageModel": [
        [
          {
            "node": "Research Synthesis Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Keyword Strategy Agent": {
      "main": [
        [
          {
            "node": "Title Refinement Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "Keyword Strategy Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Claude 4.5 Sonet (Keywords)": {
      "ai_languageModel": [
        [
          {
            "node": "Keyword Strategy Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "Title Refinement Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Title Refinement Agent": {
      "main": [
        [
          {
            "node": "Key Takeaways Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude 4.5 Sonet (Takeaways)": {
      "ai_languageModel": [
        [
          {
            "node": "Key Takeaways Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Claude 4.5 Sonet (Title)": {
      "ai_languageModel": [
        [
          {
            "node": "Title Refinement Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "Key Takeaways Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Key Takeaways Agent": {
      "main": [
        [
          {
            "node": "Outline Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude 4.5 Sonet (Outline)": {
      "ai_languageModel": [
        [
          {
            "node": "Outline Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model5": {
      "ai_languageModel": [
        [
          {
            "node": "Outline Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Outline Agent": {
      "main": [
        [
          {
            "node": "Content Writer Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Calude 4.5 Sonet (Writer)": {
      "ai_languageModel": [
        [
          {
            "node": "Content Writer Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Compression Agent": {
      "main": [
        [
          {
            "node": "Merge Compressed",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model6": {
      "ai_languageModel": [
        [
          {
            "node": "Compression Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Claude 4.5 Sonet (Compress)": {
      "ai_languageModel": [
        [
          {
            "node": "Compression Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Humanizer Agent": {
      "main": [
        [
          {
            "node": "Prepare for Verification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model7": {
      "ai_languageModel": [
        [
          {
            "node": "Humanizer Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Verification Agent": {
      "main": [
        [
          {
            "node": "Prepare Final Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model8": {
      "ai_languageModel": [
        [
          {
            "node": "Verification Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Verification Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Verification Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Final Content": {
      "main": [
        [
          {
            "node": "Save Final & Set Review",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare for Verification": {
      "main": [
        [
          {
            "node": "Verification Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Article for Humanizing": {
      "main": [
        [
          {
            "node": "Prepare for Humanizing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save Final & Set Review": {
      "main": [
        [
          {
            "node": "Send Review Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Article for Publishing": {
      "main": [
        [
          {
            "node": "Set Status: Publishing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Status: Publishing": {
      "main": [
        [
          {
            "node": "Prepare WP Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get WP Categories": {
      "main": [
        [
          {
            "node": "Get WP Tags",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get WP Tags": {
      "main": [
        [
          {
            "node": "Prepare Context for AI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Published Status": {
      "main": [
        [
          {
            "node": "Prepare Image Generation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Context for AI": {
      "main": [
        [
          {
            "node": "Taxonomy Classifier Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude 4.5 (Taxonomy)": {
      "ai_languageModel": [
        [
          {
            "node": "Taxonomy Classifier Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Taxonomy Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Taxonomy Classifier Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Final WP Data": {
      "main": [
        [
          {
            "node": "Update Published Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Taxonomy Classifier Agent": {
      "main": [
        [
          {
            "node": "Assign Categories & Tags",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model9": {
      "ai_languageModel": [
        [
          {
            "node": "Taxonomy Classifier Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Assign Categories & Tags": {
      "main": [
        [
          {
            "node": "Prepare Final WP Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create WordPress Post": {
      "main": [
        [
          {
            "node": "Get WP Categories",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate an image": {
      "main": [
        [
          {
            "node": "Process Image Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Image Response": {
      "main": [
        [
          {
            "node": "Has Image?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Image?": {
      "main": [
        [
          {
            "node": "Upload Image to WordPress",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Image Passthrough1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload Image to WordPress": {
      "main": [
        [
          {
            "node": "Set Image Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Image Data": {
      "main": [
        [
          {
            "node": "Send Published Notification1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-20T20:23:08.975Z",
  "id": "B6cxcvx9nWZAO1jmMz-Wb",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Blog Article Generator - Airtable Control - Claude Code",
  "nodes": [
    {
      "parameters": {
        "content": "# Blog Article Generator with Airtable Control\n\n**Workflow Overview:**\n- Airtable webhook triggers on status change\n- Routes to appropriate processing branch based on status\n- Research → Content Generation → Humanization → Publishing\n\n**Statuses:**\n- New → Researching → Writing → Humanizing → Review → Approved → Publishing → Published\n\n**Services Used:**\n- OpenRouter (Claude 4.5 Opus + Gemini 3.0 Flash fallback)\n- Tavily (web research)\n- Perplexity (deep research)\n- Wikipedia (fact verification)\n- Nano Banana Pro / Imagen 3.0 (image generation)\n- WordPress (publishing to processgate.ai)\n- Gmail (notifications)",
        "height": 528,
        "width": 452,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -736,
        -144
      ],
      "id": "2ee82656-9fb7-4022-9561-29780b74d64e",
      "name": "Workflow Info"
    },
    {
      "parameters": {
        "content": "## BRANCH 1: Research Pipeline\n\nTriggers when Status = 'New'\n\n1. Update status to 'Researching'\n2. Tavily search for topic\n3. Perplexity deep research\n4. Wikipedia lookup for key terms\n5. AI synthesis of research data\n6. Save to Airtable\n7. Update status to 'Writing'",
        "height": 296,
        "width": 496,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        272,
        -400
      ],
      "id": "5dc30c60-0106-47fc-a6f7-ac5dd02e5449",
      "name": "Research Branch Note"
    },
    {
      "parameters": {
        "content": "## BRANCH 2: Content Generation\n\nTriggers when Status = 'Writing'\n\n1. Keyword Strategy Agent\n2. Title Refinement Agent\n3. Key Takeaways Agent\n4. Outline Agent\n5. Content Writer Agent (Czech)\n6. Word count check\n7. Save draft to Airtable\n8. Update status to 'Humanizing'",
        "height": 344,
        "width": 736,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        416,
        288
      ],
      "id": "01cde18e-ee06-4378-9d5c-a07738b44cc4",
      "name": "Content Branch Note"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "authentication": "airtableTokenApi",
        "baseId": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "tableId": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "triggerField": "Status",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.airtableTrigger",
      "typeVersion": 1,
      "position": [
        -224,
        144
      ],
      "id": "1e0dc062-13e6-4f3b-be4c-867ceebd12f5",
      "name": "Airtable Status Change",
      "webhookId": "blog-article-status-trigger",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "dataType": "string",
        "value1": "={{ $json.fields.Status }}",
        "rules": {
          "rules": [
            {
              "value2": "New",
              "outputKey": "Researching"
            },
            {
              "value2": "Writing",
              "outputKey": "Writing"
            },
            {
              "value2": "Humanizing",
              "outputKey": "Humanizing"
            },
            {
              "value2": "Approved",
              "outputKey": "Publishing"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 2,
      "position": [
        -16,
        112
      ],
      "id": "d187b84b-94d8-4ec2-8d0c-5b02d40e40bf",
      "name": "Route by Status"
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "table": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $json.id }}",
            "Status": "Researching"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Slug",
              "displayName": "Slug",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "New",
                  "value": "New"
                },
                {
                  "name": "Researching",
                  "value": "Researching"
                },
                {
                  "name": "Writing",
                  "value": "Writing"
                },
                {
                  "name": "Humanizing",
                  "value": "Humanizing"
                },
                {
                  "name": "Review",
                  "value": "Review"
                },
                {
                  "name": "Approved",
                  "value": "Approved"
                },
                {
                  "name": "Publishing",
                  "value": "Publishing"
                },
                {
                  "name": "Published",
                  "value": "Published"
                },
                {
                  "name": "Failed",
                  "value": "Failed"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Priority",
              "displayName": "Priority",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Target Length",
              "displayName": "Target Length",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Primary Keywords",
              "displayName": "Primary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Secondary Keywords",
              "displayName": "Secondary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Categories",
              "displayName": "Categories",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Tags",
              "displayName": "Tags",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "array",
              "options": [
                {
                  "name": "AI",
                  "value": "AI"
                },
                {
                  "name": "SMB",
                  "value": "SMB"
                },
                {
                  "name": "transformace",
                  "value": "transformace"
                },
                {
                  "name": "marketing",
                  "value": "marketing"
                },
                {
                  "name": "nástroje",
                  "value": "nástroje"
                },
                {
                  "name": "automatizace",
                  "value": "automatizace"
                },
                {
                  "name": "case study",
                  "value": "case study"
                },
                {
                  "name": "výroba",
                  "value": "výroba"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Research Data",
              "displayName": "Research Data",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Content",
              "displayName": "Content",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Excerpt",
              "displayName": "Excerpt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Image Prompt",
              "displayName": "Image Prompt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Featured Image URL",
              "displayName": "Featured Image URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress Post ID",
              "displayName": "WordPress Post ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress URL",
              "displayName": "WordPress URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Status",
              "displayName": "Verification Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Pending",
                  "value": "Pending"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Notes",
              "displayName": "Verification Notes",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Log",
              "displayName": "Error Log",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [
        288,
        -32
      ],
      "id": "0c1de2b9-06e2-43cb-8582-55e279c2947f",
      "name": "Set Status: Researching",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "query": "={{ $('Airtable Status Change').item.json.fields.Title }} {{ $('Airtable Status Change').item.json.fields['Primary Keywords'] || '' }} {{ $('Airtable Status Change').item.json.fields['Secondary Keywords'] || '' }}",
        "options": {
          "topic": "general",
          "max_results": 10,
          "include_raw_content": true
        }
      },
      "type": "@tavily/n8n-nodes-tavily.tavily",
      "typeVersion": 1,
      "position": [
        544,
        -32
      ],
      "id": "7bf1d52a-606c-447d-9df0-c8d1985f8d8c",
      "name": "Tavily Research",
      "credentials": {
        "tavilyApi": {
          "id": "KmiWEKpArgJSNmSk",
          "name": "Tavily account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.perplexity.ai/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"sonar-pro\",\n  \"web_search_options\": {\n    \"max_search_results\": 10\n  },\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are a professional blog content strategist and SEO copywriter. Research topics deeply, analyze search intent, identify content gaps, and generate high-performing blog post frameworks.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"Research and analyze the following blog topic for a Czech tech blog: '{{ $('Airtable Status Change').item.json.fields.Title }}'\\n\\nProvide:\\n1. Search Intent Analysis\\n2. Content Gap identification\\n3. Key Subtopics & Questions\\n4. Primary & Secondary Keywords (Czech and English)\\n5. Competitor Analysis\\n6. Data & Statistics to include\\n7. Target Audience Insights\"\n    }\n  ]\n}",
        "options": {
          "timeout": 60000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        784,
        -32
      ],
      "id": "42562a2d-3a01-41f5-8d7f-7cc1289ecd49",
      "name": "Perplexity Deep Research",
      "credentials": {
        "httpBearerAuth": {
          "id": "zBYPTqhJcRJXe4RQ",
          "name": "Perplexity 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Prepare Wikipedia lookup terms from research\nconst tavilyResults = $('Tavily Research').first().json.results || [];\nconst articleJson = $('Airtable Status Change').first().json;\n// Airtable Trigger v1 returns {id, fields: {...}}\nconst articleTitle = articleJson.fields?.Title || articleJson.Title || '';\nconst keywords = articleJson.fields?.['Primary Keywords'] || articleJson['Primary Keywords'] || '';\n\n// Extract key terms for Wikipedia lookup\nconst keyTerms = new Set();\n\n// Add main keywords\nkeywords.split(',').forEach(kw => {\n  const term = kw.trim();\n  if (term.length > 2) keyTerms.add(term);\n});\n\n// Extract important terms from Tavily results\ntavilyResults.slice(0, 5).forEach(result => {\n  if (result.title) {\n    const words = result.title.split(/s+/);\n    words.forEach(word => {\n      if (word.length > 4 && /^[A-Z]/.test(word)) {\n        keyTerms.add(word);\n      }\n    });\n  }\n});\n\n// Limit to 5 terms max\nconst termsArray = Array.from(keyTerms).slice(0, 5);\n\n// Handle empty case\nif (termsArray.length === 0) {\n  return [{ json: { term: articleTitle.split(' ')[0] || 'AI', articleId: articleJson.id, articleTitle: articleTitle } }];\n}\n\nreturn termsArray.map(term => ({\n  json: {\n    term: term,\n    articleId: articleJson.id,\n    articleTitle: articleTitle\n  }\n}));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1024,
        -32
      ],
      "id": "663230fd-ecad-4b38-9677-30d6b920c126",
      "name": "Prepare Wikipedia Terms"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1264,
        -32
      ],
      "id": "0aeaead4-6bdf-44fd-9e81-7886357e2939",
      "name": "Loop Wiki Terms"
    },
    {
      "parameters": {
        "url": "=https://en.wikipedia.org/api/rest_v1/page/summary/{{ encodeURIComponent($json.term) }}",
        "options": {
          "response": {
            "response": {
              "neverError": true
            }
          },
          "timeout": 10000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1504,
        48
      ],
      "id": "c315023b-2ad2-40b0-b7aa-f945c24e1543",
      "name": "Wikipedia Lookup"
    },
    {
      "parameters": {
        "jsCode": "// Aggregate all research data\nconst allWikiItems = $input.all();\nconst tavilyData = $('Tavily Research').first().json;\nconst perplexityData = $('Perplexity Deep Research').first().json;\nconst articleData = $('Airtable Status Change').first().json;\n\n// Collect successful Wikipedia results\nconst wikiData = allWikiItems\n  .filter(item => item.json.extract && !item.json.type?.includes('not_found'))\n  .map(item => ({\n    title: item.json.title || '',\n    summary: item.json.extract || '',\n    url: item.json.content_urls?.desktop?.page || ''\n  }));\n\n// Clean Perplexity content with citations\nlet perplexityContent = '';\nif (perplexityData.choices && perplexityData.choices[0]) {\n  perplexityContent = perplexityData.choices[0].message.content;\n  const citations = perplexityData.citations || [];\n  for (let i = 0; i < 10; i++) {\n    perplexityContent = perplexityContent.replaceAll(\n      `[${i + 1}]`,\n      citations[i] ? ` (source: ${citations[i]})` : ''\n    );\n  }\n}\n\n// Compile research data\nconst researchData = {\n  tavily: {\n    query: tavilyData.query || '',\n    results: (tavilyData.results || []).slice(0, 8).map(r => ({\n      title: r.title,\n      content: r.content,\n      url: r.url,\n      rawContent: r.raw_content?.substring(0, 2000) || ''\n    }))\n  },\n  perplexity: perplexityContent,\n  wikipedia: wikiData,\n  articleId: articleData.id,\n  articleTitle: (articleData.fields?.Title || articleData.Title || ''),\n  primaryKeywords: (articleData.fields?.['Primary Keywords'] || articleData['Primary Keywords']) || '',\n  targetLength: (articleData.fields?.['Target Length'] || articleData['Target Length']) || 2000\n};\n\nreturn { json: researchData };"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1696,
        -48
      ],
      "id": "e400b0c5-ccda-4e16-9bd3-05ca5230005c",
      "name": "Aggregate Research Data"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"search_intent\", \"writing_style\", \"writing_tone\", \"target_audience\", \"article_goal\"],\n  \"properties\": {\n    \"search_intent\": { \"type\": \"string\" },\n    \"writing_style\": { \"type\": \"string\" },\n    \"writing_tone\": { \"type\": \"string\" },\n    \"target_audience\": { \"type\": \"string\" },\n    \"article_goal\": { \"type\": \"string\" },\n    \"hidden_insights\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n    \"semantic_analysis\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"common_subtopics\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n        \"related_questions\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n      }\n    },\n    \"keywords\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"primary\": { \"type\": \"string\" },\n        \"secondary\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n        \"semantic\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n        \"long_tail\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n      }\n    },\n    \"key_facts\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        2160,
        160
      ],
      "id": "252af9e2-5e2b-4e9f-ab59-623bee85cb99",
      "name": "Research Parser"
    },
    {
      "parameters": {
        "jsCode": "// Combine research synthesis with raw research data\n// Změna: Opraven název uzlu, smazáno \" - old\"\nconst synthesisOutput = $('Research Synthesis Agent').first().json.output;\nconst aggregatedData = $('Aggregate Research Data').first().json;\n\nconst combinedResearch = {\n  synthesis: synthesisOutput,\n  rawData: {\n    tavily: aggregatedData.tavily,\n    perplexity: aggregatedData.perplexity,\n    wikipedia: aggregatedData.wikipedia\n  },\n  articleId: aggregatedData.articleId,\n  articleTitle: aggregatedData.articleTitle,\n  targetLength: aggregatedData.targetLength\n};\n\nreturn { json: combinedResearch };"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2352,
        -48
      ],
      "id": "adc24d46-9625-49d8-88d1-78536ec1a1c4",
      "name": "Prepare Research for Save"
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "table": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $json.articleId }}",
            "Status": "Writing",
            "Research Data": "={{ JSON.stringify($json.synthesis) }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Slug",
              "displayName": "Slug",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "New",
                  "value": "New"
                },
                {
                  "name": "Researching",
                  "value": "Researching"
                },
                {
                  "name": "Writing",
                  "value": "Writing"
                },
                {
                  "name": "Humanizing",
                  "value": "Humanizing"
                },
                {
                  "name": "Review",
                  "value": "Review"
                },
                {
                  "name": "Approved",
                  "value": "Approved"
                },
                {
                  "name": "Publishing",
                  "value": "Publishing"
                },
                {
                  "name": "Published",
                  "value": "Published"
                },
                {
                  "name": "Failed",
                  "value": "Failed"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Priority",
              "displayName": "Priority",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Target Length",
              "displayName": "Target Length",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Primary Keywords",
              "displayName": "Primary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Secondary Keywords",
              "displayName": "Secondary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Categories",
              "displayName": "Categories",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Tags",
              "displayName": "Tags",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "array",
              "options": [
                {
                  "name": "AI",
                  "value": "AI"
                },
                {
                  "name": "SMB",
                  "value": "SMB"
                },
                {
                  "name": "transformace",
                  "value": "transformace"
                },
                {
                  "name": "marketing",
                  "value": "marketing"
                },
                {
                  "name": "nástroje",
                  "value": "nástroje"
                },
                {
                  "name": "automatizace",
                  "value": "automatizace"
                },
                {
                  "name": "case study",
                  "value": "case study"
                },
                {
                  "name": "výroba",
                  "value": "výroba"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Research Data",
              "displayName": "Research Data",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Content",
              "displayName": "Content",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Excerpt",
              "displayName": "Excerpt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Image Prompt",
              "displayName": "Image Prompt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Featured Image URL",
              "displayName": "Featured Image URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress Post ID",
              "displayName": "WordPress Post ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress URL",
              "displayName": "WordPress URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Status",
              "displayName": "Verification Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Pending",
                  "value": "Pending"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Notes",
              "displayName": "Verification Notes",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Log",
              "displayName": "Error Log",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [
        2560,
        -48
      ],
      "id": "8ca74c5b-2bd8-4afb-bf9e-13dcd5a0a752",
      "name": "Save Research & Set Writing",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "url",
          "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "__regex": "https://airtable.com/([a-zA-Z0-9]{2,})"
        },
        "table": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "id": "={{ $('Airtable Status Change').item.json.id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [
        400,
        704
      ],
      "id": "42890d6e-1a5e-42e3-973d-1f96ef851a5f",
      "name": "Fetch Article for Writing",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Parse research data and prepare for content generation\nconst article = $input.first().json;\n\n// Oprava: Odstraněno '.fields', protože vstupní data jsou plochá\n// Data v 'Research Data' jsou textový řetězec, takže JSON.parse je správně\nconst researchData = JSON.parse(article['Research Data'] || '{}');\n\n// Oprava: Pokud je 'Categories' text (ve vstupu je \"Nastroje,Automatizace\"), \n// je lepší ho rozdělit na pole, pokud to další uzly očekávají.\nconst categories = typeof article.Categories === 'string' \n  ? article.Categories.split(',') \n  : (article.Categories || []);\n\nreturn {\n  json: {\n    articleId: article.id,\n    // Oprava: Přímý přístup k vlastnostem (bez .fields)\n    title: article.Title, \n    primaryKeywords: article['Primary Keywords'] || '',\n    secondaryKeywords: article['Secondary Keywords'] || '',\n    categories: categories,\n    tags: article.Tags || [], // Ve vstupu už je to pole\n    targetLength: article['Target Length'] || 2000,\n    research: researchData\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        576,
        704
      ],
      "id": "b1006d7a-31ca-442b-862f-b5419ff022a8",
      "name": "Parse Article Data"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"seoKeywords\", \"categories\", \"tags\"],\n  \"properties\": {\n    \"seoKeywords\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n    \"categories\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n    \"tags\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        928,
        944
      ],
      "id": "f27aad95-63df-4a44-9c17-fa847f550082",
      "name": "Keywords Parser"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"revisedTitle\", \"reasoning\"],\n  \"properties\": {\n    \"revisedTitle\": { \"type\": \"string\" },\n    \"reasoning\": { \"type\": \"string\" }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        1360,
        944
      ],
      "id": "87ab8ea4-6974-4694-ad81-5ba44795a117",
      "name": "Title Parser"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"title\", \"content\", \"excerpt\", \"slug\", \"imageQuery\"],\n  \"properties\": {\n    \"title\": { \"type\": \"string\" },\n    \"content\": { \"type\": \"string\" },\n    \"excerpt\": { \"type\": \"string\" },\n    \"slug\": { \"type\": \"string\" },\n    \"imageQuery\": { \"type\": \"string\" }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        2448,
        944
      ],
      "id": "af74975c-14a6-4934-9e55-0de15887c34d",
      "name": "Content Parser"
    },
    {
      "parameters": {
        "jsCode": "// 1. Získání výstupu z AI (Content Writer Agent)\nlet contentData = $json.output || $json;\n\n// Ošetření: Pokud AI vrátí text (string) místo JSONu, zkusíme ho opravit\nif (typeof contentData === 'string') {\n  try {\n    const cleanJson = contentData.replace(/```json|```/g, '').trim();\n    contentData = JSON.parse(cleanJson);\n  } catch (e) {\n    // Pokud selže parsování, vytvoříme objekt ručně\n    contentData = { content: contentData, title: 'Vygenerováno (chyba parsování)' };\n  }\n}\n\n// 2. Bezpečné získání Target Length z Airtable (z uzlu 'Parse Article Data')\n// Používáme $items(), což je spolehlivější způsob, jak sáhnout na dřívější uzel\nlet targetLimit = 2000; // Defaultní hodnota\ntry {\n  // Najdeme data z uzlu Parse Article Data\n  const parseDataNode = $('Parse Article Data').all();\n  if (parseDataNode && parseDataNode.length > 0) {\n    const rawLimit = parseDataNode[0].json.targetLength;\n    targetLimit = parseInt(rawLimit);\n    \n    // Pokud v Airtable nebylo číslo, vrátíme se k defaultu\n    if (isNaN(targetLimit)) targetLimit = 2000;\n  }\n} catch (error) {\n  console.log('Nepodařilo se načíst Target Length z předchozího kroku, používám 2000.');\n}\n\n// 3. Spočítání slov\nconst content = contentData.content || '';\n// Odstraníme HTML tagy pro přesnější počítání slov\nconst textOnly = content.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim();\nconst wordCount = textOnly.split(' ').length;\n\n// 4. Logika limitu (Tolerance 10-20% je běžná, aby se článek hned nekrátil kvůli pár slovům)\n// Pokud chcete být striktní, změňte 1.2 na 1.05 nebo 1.0\nconst isOverLimit = wordCount > (targetLimit * 1.15); \n\nreturn {\n  json: {\n    ...contentData, // Předáme dál titul, slug, excerpt atd.\n    wordCount: wordCount,\n    limit: targetLimit,\n    wordLimitOver: isOverLimit,\n    // Zajistíme ID pro další kroky\n    articleId: $('Parse Article Data').all()[0].json.articleId\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2624,
        704
      ],
      "id": "516973fc-5845-45f1-9262-80cc419334e4",
      "name": "Word Count Check"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "word-limit-check",
              "leftValue": "={{ $json.wordLimitOver }}",
              "rightValue": "=true",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2800,
        704
      ],
      "id": "8cc5ed23-e90d-4cd0-8df0-118bc62e46fa",
      "name": "Over Word Limit?"
    },
    {
      "parameters": {
        "jsCode": "// Merge compressed content back\nconst originalData = $('Word Count Check').first().json;\nconst compressedContent = $json.output;\n\nreturn {\n  json: {\n    ...originalData,\n    content: compressedContent,\n    wasCompressed: true\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3280,
        848
      ],
      "id": "b10e4256-b874-4676-ab0e-7aef9b00a528",
      "name": "Merge Compressed"
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "table": {
          "__rl": true,
          "value": "=https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $json.articleId }}",
            "Status": "Humanizing",
            "Content": "={{ $json.content }}",
            "Excerpt": "={{ $json.excerpt }}",
            "Slug": "={{ $json.slug }}",
            "Image Prompt": "={{ $json.imageQuery }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Slug",
              "displayName": "Slug",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "New",
                  "value": "New"
                },
                {
                  "name": "Researching",
                  "value": "Researching"
                },
                {
                  "name": "Writing",
                  "value": "Writing"
                },
                {
                  "name": "Humanizing",
                  "value": "Humanizing"
                },
                {
                  "name": "Review",
                  "value": "Review"
                },
                {
                  "name": "Approved",
                  "value": "Approved"
                },
                {
                  "name": "Publishing",
                  "value": "Publishing"
                },
                {
                  "name": "Published",
                  "value": "Published"
                },
                {
                  "name": "Failed",
                  "value": "Failed"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Priority",
              "displayName": "Priority",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Target Length",
              "displayName": "Target Length",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Primary Keywords",
              "displayName": "Primary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Secondary Keywords",
              "displayName": "Secondary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Categories",
              "displayName": "Categories",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Tags",
              "displayName": "Tags",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "array",
              "options": [
                {
                  "name": "AI",
                  "value": "AI"
                },
                {
                  "name": "SMB",
                  "value": "SMB"
                },
                {
                  "name": "transformace",
                  "value": "transformace"
                },
                {
                  "name": "marketing",
                  "value": "marketing"
                },
                {
                  "name": "nástroje",
                  "value": "nástroje"
                },
                {
                  "name": "automatizace",
                  "value": "automatizace"
                },
                {
                  "name": "case study",
                  "value": "case study"
                },
                {
                  "name": "výroba",
                  "value": "výroba"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Research Data",
              "displayName": "Research Data",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Content",
              "displayName": "Content",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Excerpt",
              "displayName": "Excerpt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Image Prompt",
              "displayName": "Image Prompt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Featured Image URL",
              "displayName": "Featured Image URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress Post ID",
              "displayName": "WordPress Post ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress URL",
              "displayName": "WordPress URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Status",
              "displayName": "Verification Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Pending",
                  "value": "Pending"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Notes",
              "displayName": "Verification Notes",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Log",
              "displayName": "Error Log",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [
        3472,
        720
      ],
      "id": "9fb718bf-1b03-499f-9e27-35b8e039d3cc",
      "name": "Save Draft & Set Humanizing",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Analyze the following research data and provide a synthesis for blog article writing.\n\n## ARTICLE TOPIC\n{{ $json.articleTitle }}\n\n## PRIMARY KEYWORDS\n{{ $json.primaryKeywords }}\n\n\n## TAVILY WEB RESEARCH\n{{ $json.tavily.results.map(r => `### ${r.title}\\n${r.content}\\nSource: ${r.url}`).join('\\n\\n') }}\n\n## PERPLEXITY DEEP RESEARCH\n{{ $json.perplexity }}\n\n## WIKIPEDIA VERIFIED FACTS\n{{ $json.wikipedia.map(w => `### ${w.title}\\n${w.summary}\\nSource: ${w.url}`).join('\\n\\n') }}\n\n# SOURCE PRIORITIZATION RULES\nYou have access to two data sources: \"Wikipedia\" and \"Perplexity\".\n1. **Definitions & History:** Trust Wikipedia primarily for historical facts, scientific definitions, and established concepts.\n2. **Current Events & Statistics:** Trust Perplexity primarily for recent news, pricing, statistics, software versions, and trends.\n3. **Conflict Resolution:** If specific data points (like dates, numbers, names of officials) differ between sources, AUTOMATICALLY prioritize Perplexity as it is the more up-to-date source.\n4. **Outdated Flag:** If Wikipedia data seems clearly outdated (e.g. mentions \"upcoming 2023 release\" when it is now 2026), ignore it completely.\n\n---\n\n# INSTRUCTIONS FOR OUTPUT\nSynthesize the research into the structured format defined by the attached schema.\n\nIMPORTANT FORMATTING RULES:\n1. **Do NOT use markdown code blocks** (like ```json). Return raw JSON only.\n2. Ensure all fields from the schema are filled.\n3. For \"hidden_insights\", look for unique angles not covered by competitors.\n4. \"search_intent\" must be one of: informational, transactional, commercial, navigational.\n5. All text content must be in **Czech language**.",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an expert content strategist analyzing research data for a Czech technology blog about AI and automation. Synthesize the provided research into actionable writing guidelines. Focus on practical insights for Czech small and medium businesses. CRITICAL: Respond with raw JSON only. Do not wrap the output in markdown code blocks (```json)."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        1952,
        -48
      ],
      "id": "e5881b62-3502-4cf7-b25e-cd096abcd6f7",
      "name": "Research Synthesis Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1968,
        160
      ],
      "id": "5001870e-408d-4cc4-95e4-65ce234fb597",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        2304,
        944
      ],
      "id": "50299783-2ca6-41cb-9036-423eb6a13a7a",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Write a complete blog article based on the following specifications.\n\n## TITLE\n{{ $('Title Refinement Agent').item.json.output.revisedTitle }}\n\n## OUTLINE\n{{ $json.output }}\n\n## KEY TAKEAWAYS (Include as a box after intro)\n{{ $('Key Takeaways Agent').item.json.output }}\n\n## KEYWORDS STRATEGY\n**Primary Keyword:** {{ $('Parse Article Data').item.json.primaryKeywords }}\n**SEO Keywords (include naturally):** {{ $('Keyword Strategy Agent').item.json.output.seoKeywords }}\n**Secondary/Context Keywords:** {{ $('Parse Article Data').item.json.secondaryKeywords }}\n\n## RESEARCH & CONTEXT\n\n### Strategic Guidelines (Audience, Tone, Goal):\n{{ JSON.stringify($('Parse Article Data').item.json.research.synthesis || {}) }}\n\n### Deep Research (Perplexity - PRIMARY SOURCE):\n{{ $('Parse Article Data').item.json.research.rawData?.perplexity || 'No deep research available.' }}\n\n### Web Sources (Tavily):\n{{ $('Parse Article Data').item.json.research.rawData?.tavily?.results?.map(r => `- ${r.title}: ${r.content}`).join('\\n') || '' }}\n\n### Verified Facts (Wikipedia):\n{{ $('Parse Article Data').item.json.research.rawData?.wikipedia?.map(w => `- ${w.title}: ${w.summary}`).join('\\n') || '' }}\n\n## TARGET LENGTH\n{{ $('Parse Article Data').item.json.targetLength }} words\n\n---\n\n## INSTRUCTIONS\n\n1. **Structure:** Follow the provided OUTLINE strictly.\n2. **Language:** Write the COMPLETE article in excellent **CZECH language**.\n3. **Formatting:** Use HTML tags: <p>, <h2>, <h3>, <ul>, <li>, <strong>, <a>.\n4. **Forbidden:** DO NOT use <h1> tag (title is handled separately).\n5. **SEO:** Include the provided SEO keywords naturally throughout the text.\n6. **Sources:** Use facts mainly from the **Perplexity** and **Wikipedia** sections. Do not invent data.\n7. **Style:** Write in a natural, human journalistic style (avoid robotic transitions like \"V závěru lze říci\").\n8. **Engagement:** Use varied sentence structure and add practical examples relevant to Czech market.",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an expert Czech technology journalist and copywriter specializing in AI, automation, and digital transformation for SMBs.\n\nFORBIDDEN PHRASES (never use these robotic clichés):\n- \"V dnešní době\", \"V rychle se měnícím světě\", \"Je důležité poznamenat\", \"Závěrem lze říci\"\n- \"Není žádným tajemstvím\", \"Pojďme se podívat\", \"Jak jistě víte\", \"V tomto článku\"\n- Avoid robotic transitions. Go straight to the point.\n\nWRITING RULES:\n1. Language: Write in excellent, natural Czech. Avoid unnecessary anglicisms.\n2. Tone: Professional, authoritative, yet accessible. Write like a human journalist, not AI.\n3. Structure: Vary sentence length. Mix short punchy sentences with longer explanations.\n4. Content: Use concrete examples, numbers, and facts from the provided research.\n5. Integrity: NEVER invent statistics or facts. Use only provided sources.\n6. Grammar: Avoid passive voice. Use active verbs.\n\nHTML FORMATTING RULES:\n- Use tags: <p>, <h2>, <h3>, <ul>, <li>, <strong>, <a>.\n- DO NOT use <h1> (title is handled separately).\n- Do not use markdown (no ## or **). Use HTML tags only inside the content string.\n\nCRITICAL OUTPUT INSTRUCTIONS:\n- You must respond with a VALID JSON object matching the required schema.\n- Do not wrap the output in markdown code blocks (like ```json).\n- Ensure all HTML attributes and text inside the JSON are properly escaped to prevent parsing errors.\n- Return RAW JSON ONLY. No preamble, no postscript."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        2256,
        704
      ],
      "id": "5d7143e0-b9d4-405d-bb51-ee25fd1fa221",
      "name": "Content Writer Agent"
    },
    {
      "parameters": {
        "jsCode": "// Prepare article data for humanization\nconst rawData = $input.first().json;\nconst article = rawData.fields ? rawData.fields : rawData;\n\nreturn {\n  json: {\n    articleId: rawData.id,\n    title: article.Title,\n    content: article.Content || '',\n    excerpt: article.Excerpt || '',\n    slug: article.Slug || '',\n    categories: article.Categories || '',\n    tags: article.Tags || []\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        816,
        1552
      ],
      "id": "fab0e406-a6b5-4c25-8523-0d29f5acb1e2",
      "name": "Prepare for Humanizing"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {
          "temperature": 0.6
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        864,
        1760
      ],
      "id": "9aea0f5f-5a89-4898-802d-e0675379bc61",
      "name": "Claude (Humanizer)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {
          "temperature": 0.2
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        1344,
        1760
      ],
      "id": "93723a8c-93d3-4f4b-a85d-4cc3b7922ef3",
      "name": "Claude (Verification)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "content": "## BRANCH 3: Humanization & Verification\n\nTriggers when Status = 'Humanizing'\n\n1. Fetch article from Airtable\n2. Humanizer Agent (natural Czech style)\n3. Verification Agent (fact-check)\n4. Save content to Airtable\n5. Update status to 'Review'\n6. Send notification email",
        "height": 280,
        "width": 720,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        560,
        1200
      ],
      "id": "4a20c9ca-58b1-4950-98f8-8dc831367071",
      "name": "Humanization Branch Note1"
    },
    {
      "parameters": {
        "jsCode": "// Prepare article data for WordPress\nconst rawData = $('Fetch Article for Publishing').first().json;\nconst article = rawData.fields ? rawData.fields : rawData;\n\nreturn {\n  json: {\n    articleId: rawData.id,\n    title: article.Title,\n    content: article.Content || '',\n    excerpt: article.Excerpt || '',\n    slug: article.Slug || '',\n    categories: article.Categories || '',\n    tags: article.Tags || [],\n    imagePrompt: article['Image Prompt'] || `Professional blog header image for article about: ${article.Title}`\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        928,
        2336
      ],
      "id": "05a35809-8f40-4e55-8576-7bcb690e7325",
      "name": "Prepare WP Data"
    },
    {
      "parameters": {
        "jsCode": "// Prepare image generation prompt\nconst prepData = $('Prepare WP Data').first().json;\nconst wpPost = $input.first().json;\n\nreturn {\n  json: {\n    ...prepData,\n    wpPostId: wpPost.id,\n    wpPostLink: wpPost.link,\n    imagePrompt: prepData.imagePrompt\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2768,
        2304
      ],
      "id": "4a98e815-3a67-4172-b9eb-de196852db41",
      "name": "Prepare Image Generation"
    },
    {
      "parameters": {
        "content": "## BRANCH 4: WordPress Publishing\n\nTriggers when Status = 'Approved'\n\n1. Fetch article from Airtable\n2. Set status to 'Publishing'\n3. Create WordPress draft post\n4. Generate featured image (Gemini Imagen)\n5. Upload image to WordPress Media\n6. Set featured image on post\n7. Get & assign categories and tags\n8. Update Airtable with WP data\n9. Update status to 'Published'\n10. Send success notification",
        "height": 360,
        "width": 736,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        544,
        1936
      ],
      "id": "1126c556-5cc8-4d89-a6a1-71ec58b3ada1",
      "name": "Publishing Branch Note1"
    },
    {
      "parameters": {
        "sendTo": "zmidloch@z-agency.cz",
        "subject": "=✅ Article Published: {{ $json.title }}",
        "message": "=<h2>{{ $json.title }}</h2>\n\n<p>The article has been successfully published to WordPress as a draft.</p>\n\n<p><strong>WordPress Post ID:</strong> {{ $json.wpPostId }}</p>\n\n<p><strong>URL:</strong> <a href=\"https://processgate.ai/{{ $json.slug }}\">https://processgate.ai/{{ $json.slug }}</a></p>\n\n{{ $json.wpMediaUrl ? '<p><strong>Featured Image:</strong> <a href=\"' + $json.wpMediaUrl + '\">View Image</a></p>' : '' }}\n\n<hr>\n\n<p>\n  <a href=\"https://processgate.ai/wp-admin/post.php?post={{ $json.wpPostId }}&action=edit\" \n     style=\"background: #0073aa; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;\">\n     Open in WordPress Admin\n  </a>\n</p>\n\n<p style=\"color: #666; font-size: 12px; margin-top: 20px;\">This email was automatically generated by the Blog Article Generator workflow.</p>",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        4160,
        2288
      ],
      "id": "974734d4-e43e-47ab-8e28-a1a2f7a53e2b",
      "name": "Send Published Notification1",
      "webhookId": "ed04287a-794d-436b-847f-38af158abf0c",
      "credentials": {
        "gmailOAuth2": {
          "id": "qNSaYVEcaWOf5U3k",
          "name": "Gmail zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// No image available - pass through data\nconst prepData = $('Process Image Response').first().json;\n\nreturn {\n  json: {\n    ...prepData,\n    wpMediaId: null,\n    wpMediaUrl: ''\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3920,
        2544
      ],
      "id": "8e2b728a-9200-451e-b81c-b1e43048da65",
      "name": "No Image Passthrough1"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {
          "temperature": 0.3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        1808,
        160
      ],
      "id": "ead49473-96f4-4f3d-afb3-c6f1ae11e41c",
      "name": "Claude 4.5 Sonet (Research)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Based on the following research, generate an SEO-optimized keyword strategy for a Czech blog article.\n\n## ARTICLE TITLE\n{{ $json.title }}\n\n## PRIMARY KEYWORDS\n{{ $json.primaryKeywords }}\n\n## SECONDARY KEYWORDS (Context & Specific topics to cover)\n{{ $('Parse Article Data').item.json.secondaryKeywords }}\n\n## RESEARCH SYNTHESIS\n{{ JSON.stringify($json.research.synthesis || {}) }}\n\n---\n\nGenerate:\n1. 5-8 SEO keywords in CZECH relevant to Czech readers\n2. Suggest 1-3 categories from: Umela inteligence, Automatizace, Digitalni transformace, Produktivita, Nastroje a technologie, Pripadove studie, Novinky z oboru\n3. Suggest 3-5 tags in CZECH\n\nReturn JSON:\n{\n  \"seoKeywords\": [\"keyword1\", \"keyword2\"],\n  \"categories\": [\"Category1\"],\n  \"tags\": [\"tag1\", \"tag2\"]\n}",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an SEO specialist for Czech technology blogs. Generate keywords and taxonomies in Czech language that will resonate with Czech small and medium business owners. Respond ONLY with valid JSON."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        720,
        704
      ],
      "id": "3c29c3e5-5937-48df-8d11-d140eeab96d4",
      "name": "Keyword Strategy Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        768,
        944
      ],
      "id": "e5b6d691-3756-4ccf-9a9b-369c8e8eba16",
      "name": "Google Gemini Chat Model2",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {
          "temperature": 0.4
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        608,
        944
      ],
      "id": "014d53e7-5b44-4b31-91b7-21ace576fb1a",
      "name": "Claude 4.5 Sonet (Keywords)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Refine and optimize the following blog post title for maximum CTR and SEO performance.\n\n## WORKING TITLE\n{{ $('Parse Article Data').item.json.title }}\n\n## PRIMARY KEYWORDS\n{{ $('Parse Article Data').item.json.primaryKeywords }}\n\n## SEO KEYWORDS\n{{ $json.output.seoKeywords.join(', ') }}\n\n## SEARCH INTENT\n{{ $('Parse Article Data').item.json.research.synthesis?.search_intent || 'informational' }}\n\n---\n\nCreate an optimized title that:\n- Is 50-60 characters max\n- Includes primary keyword naturally\n- Is compelling and drives clicks\n- Is in CZECH language\n\nReturn JSON:\n{\n  \"revisedTitle\": \"Optimized Czech title here\",\n  \"reasoning\": \"Brief explanation\"\n}",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an expert high-CTR marketing copywriter specializing in Czech headlines. Create titles that drive clicks while being SEO-friendly. Respond ONLY with valid JSON."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        1120,
        704
      ],
      "id": "ad4be71c-f70f-43b4-8e1f-58b4c950e2c1",
      "name": "Title Refinement Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1216,
        944
      ],
      "id": "a8825e15-598c-4755-88ea-41d5d8b2e022",
      "name": "Google Gemini Chat Model3",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Create key takeaways for the following article.\n\n## OPTIMIZED TITLE\n{{ $json.output.revisedTitle }}\n\n## PRIMARY KEYWORDS\n{{ $('Parse Article Data').item.json.primaryKeywords }}\n\n## SEO KEYWORDS\n{{ $('Keyword Strategy Agent').item.json.output.seoKeywords }}\n\n## RESEARCH SYNTHESIS\n{{ JSON.stringify($('Parse Article Data').item.json.research.synthesis || {}) }}\n\n---\n\nCreate:\n1. An introductory paragraph (2-3 sentences) that hooks the reader\n2. 6-8 key takeaways as bullet points with bold headings\n3. An outro paragraph that leads into the main content\n\nWrite in CZECH language. Use engaging, action-driven headings.\n\nReturn the key takeaways in Markdown format.",
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an expert content strategist creating structured, insightful key takeaways for Czech technology articles. Write in excellent Czech, avoid cliches, use concrete examples."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        1536,
        704
      ],
      "id": "41ef7eb0-9402-45b0-8a2e-59b4cc78062f",
      "name": "Key Takeaways Agent"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        1504,
        944
      ],
      "id": "261b70b3-3ac9-4d44-9ebb-e5b0a748f704",
      "name": "Claude 4.5 Sonet (Takeaways)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        1072,
        944
      ],
      "id": "c15f7382-e24a-4c24-90b9-262c53d2a4db",
      "name": "Claude 4.5 Sonet (Title)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1664,
        944
      ],
      "id": "6f0b62f8-2851-4676-9cd6-8e26f9882b10",
      "name": "Google Gemini Chat Model4",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Create a detailed article outline for the following topic.\n\n## TITLE\n{{ $('Title Refinement Agent').item.json.output.revisedTitle }}\n\n## KEY TAKEAWAYS\n{{ $json.output }}\n\n## SEO KEYWORDS\n{{ $('Keyword Strategy Agent').item.json.output.seoKeywords }}\n\n## SEMANTIC ANALYSIS\n{{ JSON.stringify($('Parse Article Data').item.json.research.synthesis?.semantic_analysis || {}) }}\n\n## TARGET LENGTH\n{{ $('Parse Article Data').item.json.targetLength }} words\n\n---\n\nCreate a detailed outline with:\n- Main sections (## H2 headings)\n- Subsections (### H3 headings)\n- Brief description of what each section covers\n- Incorporate SEO keywords naturally in headings\n\nFormat in Markdown. Write headings in CZECH.",
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an expert content strategist creating detailed article outlines. Structure content for clarity, engagement, and SEO effectiveness. Use Czech language for all headings and descriptions."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        1888,
        704
      ],
      "id": "a86de01e-9e30-4713-96b5-3f8e81c0a3a5",
      "name": "Outline Agent"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        1824,
        944
      ],
      "id": "9c2d8b34-f3c3-488f-8d87-2abf1352e731",
      "name": "Claude 4.5 Sonet (Outline)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1984,
        944
      ],
      "id": "51d57d7a-b611-491a-8d76-ed0ecfeaaa29",
      "name": "Google Gemini Chat Model5",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {
          "temperature": 0.7
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        2144,
        944
      ],
      "id": "2e844d40-51dc-485c-8434-7078963fc0d0",
      "name": "Calude 4.5 Sonet (Writer)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Compress the following article to fit within {{ $json.limit }} words while preserving meaning and value.\n\nCurrent word count: {{ $json.wordCount }}\nTarget: {{ $json.limit }} words\n\n## CONTENT TO COMPRESS:\n{{ $json.content }}\n\n---\n\nReduce word count by:\n1. Removing redundant sentences\n2. Shortening overly long explanations\n3. Eliminating filler phrases\n4. Combining similar points\n\nPreserve:\n- All key information\n- HTML formatting\n- Natural flow\n- Czech language quality\n\nReturn ONLY the compressed HTML content.",
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an expert editor compressing long-form content while preserving meaning, tone, and value. Output only the compressed HTML content in Czech."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        2992,
        848
      ],
      "id": "61298a35-8c84-47e7-ad52-591f1cc5a410",
      "name": "Compression Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        3024,
        1056
      ],
      "id": "40de078a-1d0e-495e-b78a-99390eb75c95",
      "name": "Google Gemini Chat Model6",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        2848,
        1056
      ],
      "id": "1d759de3-0692-4878-a6ad-ce13dc0325da",
      "name": "Claude 4.5 Sonet (Compress)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Humanize the following article content to make it sound more natural and engaging in Czech.\n\n## TITLE\n{{ $json.title }}\n\n## CONTENT\n{{ $json.content }}\n\n---\n\nGuidelines:\n- Make the text flow naturally as if written by a native Czech speaker\n- Avoid robotic or overly formal language\n- Keep the factual accuracy intact\n- Maintain the structure (headings, lists)\n- Add transitional phrases where needed\n- Use varied sentence lengths\n- Keep technical terms accurate\n\nReturn the humanized content in HTML format (same structure as input).",
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an expert Czech copywriter who specializes in making AI-generated content sound natural and human. You maintain accuracy while improving readability and engagement."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        992,
        1552
      ],
      "id": "30f28311-88a9-4b4b-81ff-ae3bbad81ab0",
      "name": "Humanizer Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1040,
        1760
      ],
      "id": "08cd8227-6b79-449a-8cd7-c99edecc250d",
      "name": "Google Gemini Chat Model7",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Verify the following article for factual accuracy and identify any claims that need sources.\n\n## TITLE\n{{ $json.title }}\n\n## CONTENT\n{{ $json.humanizedContent }}\n\n---\n\nCheck for:\n1. Factual claims that need verification\n2. Statistics or numbers that should have sources\n3. Outdated information\n4. Potential inaccuracies\n5. Missing context\n\nReturn JSON:\n{\n  \"verified\": true/false,\n  \"verificationNotes\": \"Summary of verification\",\n  \"verificationIssues\": [\"issue1\", \"issue2\"]\n}",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "You are a fact-checker for Czech technology articles. Identify claims that need verification and flag potential inaccuracies. Be thorough but practical."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        1504,
        1552
      ],
      "id": "e000f87d-142f-477a-8e89-4345c51edef2",
      "name": "Verification Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1536,
        1760
      ],
      "id": "8853294c-6f6c-441b-ab95-b13ba0872ce0",
      "name": "Google Gemini Chat Model8",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"verified\", \"verificationNotes\"],\n  \"properties\": {\n    \"verified\": { \"type\": \"boolean\" },\n    \"verificationNotes\": { \"type\": \"string\" },\n    \"verificationIssues\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        1712,
        1760
      ],
      "id": "465fcc16-0701-43b7-b31e-80b1d96f6595",
      "name": "Verification Parser"
    },
    {
      "parameters": {
        "jsCode": "// Prepare final data for saving\nconst prepData = $('Prepare for Verification').first().json;\nconst verificationOutput = $input.first().json.output || $input.first().json;\n\nreturn {\n  json: {\n    articleId: prepData.articleId,\n    title: prepData.title,\n    content: prepData.humanizedContent,\n    excerpt: prepData.excerpt,\n    slug: prepData.slug,\n    verified: verificationOutput.verified || false,\n    verificationNotes: verificationOutput.verificationNotes || '',\n    verificationIssues: verificationOutput.verificationIssues || []\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1888,
        1552
      ],
      "id": "649278ba-9769-4949-80d2-729bdfb0675f",
      "name": "Prepare Final Content"
    },
    {
      "parameters": {
        "jsCode": "// Prepare humanized content for verification\nconst prepData = $('Prepare for Humanizing').first().json;\nconst humanizedContent = $input.first().json.output || $input.first().json.text || '';\n\nreturn {\n  json: {\n    ...prepData,\n    humanizedContent: humanizedContent\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1280,
        1552
      ],
      "id": "f5bbe3d6-5c6d-4c51-9790-bf7b72a9a1ec",
      "name": "Prepare for Verification"
    },
    {
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "url",
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z"
        },
        "table": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "id": "={{ $('Airtable Status Change').item.json.id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [
        608,
        1552
      ],
      "id": "8c319965-bc63-47d4-ab20-c676a2b9c4fb",
      "name": "Fetch Article for Humanizing",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "zmidloch@z-agency.cz",
        "subject": "={{ $json.verified ? '✅' : '⚠️' }} New article for review: {{ $json.fields.Title }}",
        "message": "=<h2 style=\"color: #d32f2f;\">⚠️ Review Required: {{ $json.fields.Title }}</h2>\n\n<p>The automated verification process flagged potential issues with this article.</p>\n\n<div style=\"background-color: #ffebee; border-left: 5px solid #d32f2f; padding: 15px; margin: 15px 0;\">\n    <h3 style=\"margin-top: 0; color: #d32f2f;\">Issues Found:</h3>\n    <p style=\"white-space: pre-wrap;\">{{ $json.fields['Verification Notes'] || 'No specific notes provided.' }}</p>\n</div>\n\n<hr>\n\n<h3>Article Details:</h3>\n<ul>\n    <li><strong>Status:</strong> {{ $json.fields['Verification Status'] }}</li>\n    <li><strong>Excerpt:</strong> {{ $json.fields.Excerpt }}</li>\n    <li><strong>Target Length:</strong> {{ $json.fields['Target Length'] }} words</li>\n</ul>\n\n<p>Please open Airtable to review the full content and address these issues manually.</p>\n\n<p style=\"text-align: center;\">\n    <a href=\"{{ $json.fields['Airtable Record URL'] || 'https://airtable.com' }}\" style=\"background-color: #2962ff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Open in Airtable</a>\n</p>\n\n<p style=\"color: #999; font-size: 12px; margin-top: 30px;\">Generated by Blog Article Generator Workflow</p>",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2304,
        1552
      ],
      "id": "bc587896-3530-4f37-878e-25a9eb17bac4",
      "name": "Send Review Notification",
      "webhookId": "1f24e0c9-98ca-4c2f-8815-26dea658036e",
      "credentials": {
        "gmailOAuth2": {
          "id": "qNSaYVEcaWOf5U3k",
          "name": "Gmail zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "mode": "url",
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z"
        },
        "table": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $json.articleId }}",
            "Status": "Approved",
            "Content": "={{ $json.content }}",
            "Verification Status": "={{ $json.verified ? 'Passed' : 'Issues Found' }}",
            "Verification Notes": "={{ $json.verificationNotes }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Primary Keywords",
              "displayName": "Primary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Secondary Keywords",
              "displayName": "Secondary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Target Length",
              "displayName": "Target Length",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "New",
                  "value": "New"
                },
                {
                  "name": "Researching",
                  "value": "Researching"
                },
                {
                  "name": "Writing",
                  "value": "Writing"
                },
                {
                  "name": "Humanizing",
                  "value": "Humanizing"
                },
                {
                  "name": "Review",
                  "value": "Review"
                },
                {
                  "name": "Approved",
                  "value": "Approved"
                },
                {
                  "name": "Publishing",
                  "value": "Publishing"
                },
                {
                  "name": "Published",
                  "value": "Published"
                },
                {
                  "name": "Failed",
                  "value": "Failed"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Last Modified",
              "displayName": "Last Modified",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Research Data",
              "displayName": "Research Data",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Slug",
              "displayName": "Slug",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Excerpt",
              "displayName": "Excerpt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Content",
              "displayName": "Content",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Image Prompt",
              "displayName": "Image Prompt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Status",
              "displayName": "Verification Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Pending",
                  "value": "Pending"
                },
                {
                  "name": "Passed",
                  "value": "Passed"
                },
                {
                  "name": "Issues Found",
                  "value": "Issues Found"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Verification Notes",
              "displayName": "Verification Notes",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Categories",
              "displayName": "Categories",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Tags",
              "displayName": "Tags",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "array",
              "options": [
                {
                  "name": "AI",
                  "value": "AI"
                },
                {
                  "name": "SMB",
                  "value": "SMB"
                },
                {
                  "name": "transformace",
                  "value": "transformace"
                },
                {
                  "name": "marketing",
                  "value": "marketing"
                },
                {
                  "name": "nástroje",
                  "value": "nástroje"
                },
                {
                  "name": "automatizace",
                  "value": "automatizace"
                },
                {
                  "name": "case study",
                  "value": "case study"
                },
                {
                  "name": "výroba",
                  "value": "výroba"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Featured Image URL",
              "displayName": "Featured Image URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress Post ID",
              "displayName": "WordPress Post ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress URL",
              "displayName": "WordPress URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Log",
              "displayName": "Error Log",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [
        2096,
        1552
      ],
      "id": "8d977891-3461-4f96-ba96-0c01499ea1e2",
      "name": "Save Final & Set Review",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "base": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "table": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "id": "={{ $('Airtable Status Change').item.json.id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [
        560,
        2336
      ],
      "id": "c7271c46-10d7-4cee-a83d-3d5e3f1cf27e",
      "name": "Fetch Article for Publishing",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "table": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $json.id }}",
            "Status": "Publishing"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Primary Keywords",
              "displayName": "Primary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Secondary Keywords",
              "displayName": "Secondary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Target Length",
              "displayName": "Target Length",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "New",
                  "value": "New"
                },
                {
                  "name": "Researching",
                  "value": "Researching"
                },
                {
                  "name": "Writing",
                  "value": "Writing"
                },
                {
                  "name": "Humanizing",
                  "value": "Humanizing"
                },
                {
                  "name": "Review",
                  "value": "Review"
                },
                {
                  "name": "Approved",
                  "value": "Approved"
                },
                {
                  "name": "Publishing",
                  "value": "Publishing"
                },
                {
                  "name": "Published",
                  "value": "Published"
                },
                {
                  "name": "Failed",
                  "value": "Failed"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Last Modified",
              "displayName": "Last Modified",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Research Data",
              "displayName": "Research Data",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Slug",
              "displayName": "Slug",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Excerpt",
              "displayName": "Excerpt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Content",
              "displayName": "Content",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Image Prompt",
              "displayName": "Image Prompt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Status",
              "displayName": "Verification Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Pending",
                  "value": "Pending"
                },
                {
                  "name": "Passed",
                  "value": "Passed"
                },
                {
                  "name": "Issues Found",
                  "value": "Issues Found"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Notes",
              "displayName": "Verification Notes",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Categories",
              "displayName": "Categories",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Tags",
              "displayName": "Tags",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "array",
              "options": [
                {
                  "name": "AI",
                  "value": "AI"
                },
                {
                  "name": "SMB",
                  "value": "SMB"
                },
                {
                  "name": "transformace",
                  "value": "transformace"
                },
                {
                  "name": "marketing",
                  "value": "marketing"
                },
                {
                  "name": "nástroje",
                  "value": "nástroje"
                },
                {
                  "name": "automatizace",
                  "value": "automatizace"
                },
                {
                  "name": "case study",
                  "value": "case study"
                },
                {
                  "name": "výroba",
                  "value": "výroba"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Featured Image URL",
              "displayName": "Featured Image URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress Post ID",
              "displayName": "WordPress Post ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress URL",
              "displayName": "WordPress URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Log",
              "displayName": "Error Log",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [
        736,
        2336
      ],
      "id": "f7a2eb7e-881d-49e2-b32a-033a1a1ec8b0",
      "name": "Set Status: Publishing",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "url": "https://processgate.ai/wp-json/wp/v2/categories",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "per_page",
              "value": "100"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1264,
        2640
      ],
      "id": "51562bca-67b8-48cb-a04e-7cbc8be0ca76",
      "name": "Get WP Categories",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "url": "https://processgate.ai/wp-json/wp/v2/tags",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "per_page",
              "value": "100"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1456,
        2640
      ],
      "id": "280bd4ab-f1f2-4398-bf9b-5305abddff59",
      "name": "Get WP Tags",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "mode": "url",
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z"
        },
        "table": {
          "__rl": true,
          "value": "https://airtable.com/appNKJUeljGoHYjQf/tbljRtFFKlUXYAO6M/viwCXaxhEJzyyFE8z",
          "mode": "url"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $json.articleId }}",
            "Status": "Published",
            "WordPress Post ID": "={{ parseInt($json.wpPostId) }}",
            "WordPress URL": "={{ $json.wpUrl }}",
            "Categories": "={{ $json.categoryNames }}",
            "Tags": "={{ $json.tagNames }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Primary Keywords",
              "displayName": "Primary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Secondary Keywords",
              "displayName": "Secondary Keywords",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Target Length",
              "displayName": "Target Length",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "New",
                  "value": "New"
                },
                {
                  "name": "Researching",
                  "value": "Researching"
                },
                {
                  "name": "Writing",
                  "value": "Writing"
                },
                {
                  "name": "Humanizing",
                  "value": "Humanizing"
                },
                {
                  "name": "Review",
                  "value": "Review"
                },
                {
                  "name": "Approved",
                  "value": "Approved"
                },
                {
                  "name": "Publishing",
                  "value": "Publishing"
                },
                {
                  "name": "Published",
                  "value": "Published"
                },
                {
                  "name": "Failed",
                  "value": "Failed"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Last Modified",
              "displayName": "Last Modified",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Research Data",
              "displayName": "Research Data",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Slug",
              "displayName": "Slug",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Excerpt",
              "displayName": "Excerpt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Content",
              "displayName": "Content",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Image Prompt",
              "displayName": "Image Prompt",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Status",
              "displayName": "Verification Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Pending",
                  "value": "Pending"
                },
                {
                  "name": "Passed",
                  "value": "Passed"
                },
                {
                  "name": "Issues Found",
                  "value": "Issues Found"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Verification Notes",
              "displayName": "Verification Notes",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Categories",
              "displayName": "Categories",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Tags",
              "displayName": "Tags",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Featured Image URL",
              "displayName": "Featured Image URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "WordPress Post ID",
              "displayName": "WordPress Post ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "WordPress URL",
              "displayName": "WordPress URL",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Error Log",
              "displayName": "Error Log",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [
        2560,
        2304
      ],
      "id": "a5b33464-b5f9-4914-aa7d-30cc5b79b942",
      "name": "Update Published Status",
      "credentials": {
        "airtableTokenApi": {
          "id": "112UtIzO07XgrN7A",
          "name": "Airtable - zmidloch@z-agency.cz"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Prepare context for the Taxonomy Agent\n// We need to merge the WP Post ID with the list of available categories and tags\n\n// FIXED: Removed \"- old\" from the node name\nconst wpPost = $('Create WordPress Post').first().json;\nconst article = $('Prepare WP Data').first().json;\n\n// Create readable lists for the AI\nconst categoriesList = $('Get WP Categories').all().map(item => \n  `ID ${item.json.id}: ${item.json.name} (Slug: ${item.json.slug})`\n).join('\\n');\n\nconst tagsList = $('Get WP Tags').all().map(item => \n  `ID ${item.json.id}: ${item.json.name}`\n).join('\\n');\n\nreturn {\n  json: {\n    wpPostId: wpPost.id,\n    wpPostLink: wpPost.link,\n    title: article.title,\n    excerpt: article.excerpt,\n    categoriesList: categoriesList,\n    tagsList: tagsList\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1616,
        2304
      ],
      "id": "ae2bbedc-260f-4bcf-b989-e4a5a409fb2c",
      "name": "Prepare Context for AI"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.5",
        "options": {
          "temperature": 0
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        1696,
        2528
      ],
      "id": "7d5c0b60-3b8e-4d5a-8c5b-5ab5f5a3c3c2",
      "name": "Claude 4.5 (Taxonomy)",
      "credentials": {
        "openRouterApi": {
          "id": "XpZg3NCm0vRTBA75",
          "name": "OpenRouter Z-AGENCY 2026"
        }
      }
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"required\": [\"categoryIds\", \"tagIds\"],\n  \"properties\": {\n    \"categoryIds\": {\n      \"type\": \"array\",\n      \"items\": { \"type\": \"number\" }\n    },\n    \"tagIds\": {\n      \"type\": \"array\",\n      \"items\": { \"type\": \"number\" }\n    }\n  }\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        2064,
        2528
      ],
      "id": "a2ce660a-a793-4bfe-a619-b5c0728beea1",
      "name": "Taxonomy Parser"
    },
    {
      "parameters": {
        "jsCode": "// Prepare final data for Airtable update\nconst classifierData = $('Taxonomy Classifier Agent').first().json.output;\nconst contextData = $('Prepare Context for AI').first().json;\n// Načteme původní data článku (Title, Slug, Excerpt...)\nconst originalArticle = $('Prepare WP Data').first().json;\n\n// Funkce pro získání názvů (bez uvozovek a balastu)\nconst getNames = (ids, sourceNodeName) => {\n  if (!ids || !Array.isArray(ids) || ids.length === 0) return [];\n  \n  const allItems = $(sourceNodeName).all();\n  \n  const names = ids.map(id => {\n    const foundItem = allItems.find(item => item.json.id === id);\n    if (!foundItem || !foundItem.json.name) return null;\n    \n    let name = String(foundItem.json.name);\n    name = name.replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\n    name = name.replace(/['\"]/g, ''); \n    return name.trim();\n  }).filter(name => name !== null && name !== '');\n\n  return names;\n};\n\nconst catArray = getNames(classifierData.categoryIds, 'Get WP Categories');\nconst tagArray = getNames(classifierData.tagIds, 'Get WP Tags');\n\nreturn {\n  json: {\n    // 1. Přenášíme původní metadata (TOHLE CHYBĚLO)\n    title: originalArticle.title,\n    slug: originalArticle.slug,\n    excerpt: originalArticle.excerpt,\n    \n    // 2. Data pro WordPress (IDčka)\n    categoryIds: classifierData.categoryIds,\n    tagIds: classifierData.tagIds,\n    \n    // 3. Data pro Airtable (Texty)\n    categoryNames: catArray.join(', '),\n    tagNames: tagArray.join(', '),\n    \n    // 4. Systémová data\n    wpPostId: contextData.wpPostId,\n    wpUrl: contextData.wpPostLink,\n    articleId: originalArticle.articleId\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2352,
        2304
      ],
      "id": "2d897fa4-a8cf-4165-bf0a-4164505d3077",
      "name": "Prepare Final WP Data"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Classify the following article based on the available taxonomy lists provided below.\n\n## ARTICLE DATA\nTitle: {{ $json.title }}\nExcerpt: {{ $json.excerpt }}\n\n## REFERENCE LIST: CATEGORIES (Format: \"ID: Name\")\n{{ $json.categoriesList }}\n\n## REFERENCE LIST: TAGS (Format: \"ID: Name\")\n{{ $json.tagsList }}\n\n---\n\nTASK:\n1. Identify 1-2 most relevant Category IDs from the list above.\n2. Identify 3-5 most relevant Tag IDs from the list above.\n\nRESPONSE FORMAT:\n{\n  \"categoryIds\": [1, 2],\n  \"tagIds\": [10, 20, 30]\n}",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an expert AI classifier for WordPress content. Your job is to analyze article metadata and map it to existing taxonomy IDs.\n\nCRITICAL RULES:\n1. You act as a filter/mapper. You do NOT generate content.\n2. You must Output ONLY valid JSON. No markdown, no conversational text.\n3. You must use ONLY the IDs provided in the lists. NEVER invent new categories or tags.\n4. If no tag fits, return an empty array for tags.\n5. Accuracy is key. Do not hallucinate IDs that are not in the provided list."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        1776,
        2304
      ],
      "id": "a5b661be-8894-4e92-8694-e27938482acc",
      "name": "Taxonomy Classifier Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1856,
        2528
      ],
      "id": "789b8938-ea14-4993-812e-2eae7dc07d9c",
      "name": "Google Gemini Chat Model9",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://processgate.ai/wp-json/wp/v2/posts/{{ $('Prepare Context for AI').item.json.wpPostId }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"categories\": {{ JSON.stringify($json.output.categoryIds) }},\n  \"tags\": {{ JSON.stringify($json.output.tagIds) }}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2144,
        2304
      ],
      "id": "0de96a80-fe83-4907-85bc-167c44ec76a1",
      "name": "Assign Categories & Tags",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://processgate.ai/wp-json/wp/v2/posts",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"title\": \"{{ $json.title }}\",\n  \"content\": {{ JSON.stringify($json.content) }},\n  \"slug\": \"{{ $json.slug }}\",\n  \"status\": \"draft\",\n  \"lang\": \"{{ $json.wpLang }}\" \n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1152,
        2336
      ],
      "id": "79c791f4-662e-4a29-9dd6-2248dc28385b",
      "name": "Create WordPress Post",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-3-pro-image-preview",
          "mode": "list",
          "cachedResultName": "models/gemini-3-pro-image-preview (Nano Banana Pro)"
        },
        "prompt": "={\n  \"instances\": [\n    {\n      \"prompt\": \"{{ $json.imagePrompt.replace(/[\\r\\n]+/g, ' ').replace(/\"/g, '\\\\\"') }}, professional, modern tech style, no text, high quality, 16:9 aspect ratio, clean design, business appropriate\"\n    }\n  ],\n  \"parameters\": {\n    \"sampleCount\": 1,\n    \"aspectRatio\": \"16:9\"\n  }\n}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        2960,
        2304
      ],
      "id": "0bb184a6-0da4-4129-a582-a075fdb7b036",
      "name": "Generate an image",
      "credentials": {
        "googlePalmApi": {
          "id": "uLXCpqN3fa4ZXZmj",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Extract image from Gemini Imagen response and prepare for WordPress upload\n\n// 1. DŮLEŽITÁ ZMĚNA:\n// Načítáme data z uzlu \"Prepare Final WP Data\", protože ten obsahuje wpPostId i slug.\nlet prepData = {};\ntry {\n    prepData = $('Prepare Final WP Data').first().json;\n} catch (error) {\n    console.log(\"Uzel Prepare Final WP Data nebyl nalezen, data mohou chybět.\");\n}\n\nconst inputItem = $input.first();\n\nlet hasImage = false;\nlet imageBase64 = '';\nlet binaryOutput = undefined;\n\n// Zpracování binárních dat (obrázku)\nif (inputItem.binary) {\n    const binaryKeys = Object.keys(inputItem.binary);\n    if (binaryKeys.length > 0) {\n        hasImage = true;\n        const key = binaryKeys[0];\n        const binaryObject = inputItem.binary[key];\n        \n        // Připravíme binární výstup\n        binaryOutput = {\n            data: binaryObject\n        };\n    }\n}\n\n// Vytvoříme název souboru\nconst slug = prepData.slug || 'article'; // Slug už máme z Prepare Final WP Data\nconst filename = `${slug}-featured.png`;\n\nif (binaryOutput && binaryOutput.data) {\n    binaryOutput.data.fileName = filename;\n}\n\nreturn {\n  json: {\n    // 2. Tímto předáme dál VŠECHNA data (wpPostId, title, url...)\n    ...prepData,\n    \n    // A přidáme info o obrázku\n    hasImage: hasImage,\n    filename: filename\n  },\n  binary: binaryOutput\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3168,
        2304
      ],
      "id": "a0efbd02-4385-436d-9375-b85261c35405",
      "name": "Process Image Response"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "has-image-check",
              "leftValue": "={{ $json.hasImage }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3376,
        2304
      ],
      "id": "f71710a9-ccc7-4534-b9a2-7d687553379c",
      "name": "Has Image?"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://processgate.ai/wp-json/wp/v2/media",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "wordpressApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Disposition",
              "value": "=attachment; filename=\"{{ $json.filename }}\""
            },
            {
              "name": "Content-Type",
              "value": "image/png"
            }
          ]
        },
        "sendBody": true,
        "contentType": "binaryData",
        "inputDataFieldName": "data",
        "options": {
          "timeout": 30000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        3728,
        2288
      ],
      "id": "6dbb5370-7b7b-40fb-bb35-46034badd4a0",
      "name": "Upload Image to WordPress",
      "credentials": {
        "wordpressApi": {
          "id": "flqY5YMCvIpv5fpx",
          "name": "Processgate.ai_propojeni"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Prepare data after image upload\nconst uploadResponse = $input.first().json;\nconst prepData = $('Process Image Response').first().json;\n\nreturn {\n  json: {\n    ...prepData,\n    wpMediaId: uploadResponse.id,\n    wpMediaUrl: uploadResponse.source_url || uploadResponse.guid?.rendered || ''\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3920,
        2288
      ],
      "id": "fae6a6c5-edab-4b09-8276-9d5a5f5ffee5",
      "name": "Set Image Data"
    }
  ],
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false,
    "callerPolicy": "workflowsFromSameOwner",
    "timeSavedMode": "fixed",
    "errorWorkflow": "zVAjJgKV17IWzFP7"
  },
  "shared": [
    {
      "updatedAt": "2026-01-20T20:23:08.975Z",
      "createdAt": "2026-01-20T20:23:08.975Z",
      "role": "workflow:owner",
      "workflowId": "B6cxcvx9nWZAO1jmMz-Wb",
      "projectId": "XqkS7oX8lMj4YbIK"
    }
  ],
  "staticData": null,
  "tags": [
    {
      "updatedAt": "2025-11-25T10:02:49.590Z",
      "createdAt": "2025-11-25T10:02:49.590Z",
      "id": "iu8EkneS24SJyD0c",
      "name": "AI"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2026-01-22T00:28:19.042Z",
  "versionId": "a5b49448-9d07-43fe-b124-afac6668777e"
}